<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.GraphQL.Schema.RemoteRelationship</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipField"><span class="hs-identifier">remoteRelationshipField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Has</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.HashMap.Strict.Extended.html"><span class="hs-identifier">Data.HashMap.Strict.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Types.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ET</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.html"><span class="hs-identifier">Hasura.GraphQL.Parser</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.html"><span class="hs-identifier">Hasura.GraphQL.Parser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Internal.Parser.html"><span class="hs-identifier">Hasura.GraphQL.Parser.Internal.Parser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Backend.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Backend</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Common</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Instances.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Instances</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Remote.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Remote</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Select.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Select</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Table.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Table</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.RemoteRelationship.Validate.html"><span class="hs-identifier">Hasura.RQL.DDL.RemoteRelationship.Validate</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.html"><span class="hs-identifier">Hasura.RQL.IR</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelType"><span class="hs-identifier">RelType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier">relNameToTxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Remote</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.ToSchema</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.ToSchema</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Remote</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.RemoteSchema.html"><span class="hs-identifier">Hasura.RQL.Types.RemoteSchema</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ResultCustomization.html"><span class="hs-identifier">Hasura.RQL.Types.ResultCustomization</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SourceCustomization.html"><span class="hs-identifier">Hasura.RQL.Types.SourceCustomization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.SourceCustomization.html#mkCustomizedTypename"><span class="hs-identifier">mkCustomizedTypename</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.AnyBackend.html"><span class="hs-identifier">Hasura.SQL.AnyBackend</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Remote relationship field parsers</span><span>
</span><span id="line-38"></span><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipField"><span class="hs-identifier hs-type">remoteRelationshipField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688042623"><span class="annot"><a href="#local-6989586621688042623"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621688042622"><span class="annot"><a href="#local-6989586621688042622"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621688042621"><span class="annot"><a href="#local-6989586621688042621"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621688042620"><span class="annot"><a href="#local-6989586621688042620"><span class="hs-identifier hs-type">lhsJoinField</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042623"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042622"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042621"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RemoteFieldInfo"><span class="hs-identifier hs-type">RemoteFieldInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042620"><span class="hs-identifier hs-type">lhsJoinField</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="#local-6989586621688042622"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Parser.Internal.Parser.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042621"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span id="remoteRelationshipField"><span class="annot"><span class="annottext">remoteRelationshipField :: RemoteFieldInfo lhsJoinField
-&gt; m (Maybe
        [FieldParser n (RemoteRelationshipField UnpreparedValue)])
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipField"><span class="hs-identifier hs-var hs-var">remoteRelationshipField</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RemoteFieldInfo"><span class="hs-identifier hs-type">RemoteFieldInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688042617"><span id="local-6989586621688042618"><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
RemoteFieldInfoRHS
_rfiRHS :: forall lhsJoinField.
RemoteFieldInfo lhsJoinField -&gt; RemoteFieldInfoRHS
_rfiLHS :: forall lhsJoinField.
RemoteFieldInfo lhsJoinField -&gt; HashMap FieldName lhsJoinField
_rfiRHS :: RemoteFieldInfoRHS
_rfiLHS :: HashMap FieldName lhsJoinField
</span><a href="Hasura.RQL.Types.Relationships.Remote.html#_rfiRHS"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621688042614"><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="#local-6989586621688042614"><span class="hs-identifier hs-var">queryType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(r -&gt; GraphQLQueryType) -&gt; m GraphQLQueryType
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; GraphQLQueryType) -&gt; m GraphQLQueryType)
-&gt; (r -&gt; GraphQLQueryType) -&gt; m GraphQLQueryType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QueryContext -&gt; GraphQLQueryType
</span><a href="Hasura.GraphQL.Schema.Common.html#qcQueryType"><span class="hs-identifier hs-var hs-var">qcQueryType</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryContext -&gt; GraphQLQueryType)
-&gt; (r -&gt; QueryContext) -&gt; r -&gt; GraphQLQueryType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; QueryContext
forall a t. Has a t =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">getter</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">-- https://github.com/hasura/graphql-engine/issues/5144</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-comment">-- The above issue is easily fixable by removing the following guard and 'MaybeT' monad transformation</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe ()) -&gt; m ()) -&gt; m (Maybe ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MaybeT m () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT m () -&gt; m (Maybe ())) -&gt; MaybeT m () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; MaybeT m ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; MaybeT m ()) -&gt; Bool -&gt; MaybeT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="#local-6989586621688042614"><span class="hs-identifier hs-var">queryType</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType -&gt; GraphQLQueryType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GraphQLQueryType
</span><a href="Hasura.GraphQL.Execute.Types.html#QueryHasura"><span class="hs-identifier hs-var">ET.QueryHasura</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RemoteFieldInfoRHS
</span><a href="#local-6989586621688042617"><span class="hs-identifier hs-var">_rfiRHS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RFISource"><span class="hs-identifier hs-type">RFISource</span></a></span><span> </span><span id="local-6989586621688042605"><span class="annot"><span class="annottext">AnyBackend RemoteSourceFieldInfo
</span><a href="#local-6989586621688042605"><span class="hs-identifier hs-var">anyRemoteSourceFieldInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><span class="annottext">AnyBackend RemoteSourceFieldInfo
-&gt; (forall (b :: BackendType).
    BackendSchema b =&gt;
    RemoteSourceFieldInfo b
    -&gt; m (Maybe
            [FieldParser n (RemoteRelationshipField UnpreparedValue)]))
-&gt; m (Maybe
        [FieldParser n (RemoteRelationshipField UnpreparedValue)])
forall (c :: BackendType -&gt; Constraint) (i :: BackendType -&gt; *) r.
AllBackendsSatisfy c =&gt;
AnyBackend i -&gt; (forall (b :: BackendType). c b =&gt; i b -&gt; r) -&gt; r
</span><a href="Hasura.SQL.AnyBackend.html#dispatchAnyBackend"><span class="hs-identifier hs-var">dispatchAnyBackend</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.GraphQL.Schema.Backend.html#BackendSchema"><span class="hs-identifier hs-type">BackendSchema</span></a></span><span> </span><span class="annot"><span class="annottext">AnyBackend RemoteSourceFieldInfo
</span><a href="#local-6989586621688042605"><span class="hs-identifier hs-var">anyRemoteSourceFieldInfo</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688042603"><span class="annot"><span class="annottext">RemoteSourceFieldInfo b
</span><a href="#local-6989586621688042603"><span class="hs-identifier hs-var">remoteSourceFieldInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-51"></span><span>        </span><span class="hs-comment">-- the fmap soup here is to go over all the IR.RemoteSourceSelect and</span><span>
</span><span id="line-52"></span><span>        </span><span class="hs-comment">-- wrap them as 'IR.RemoteRelationshipField's</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="annottext">[FieldParser n (RemoteRelationshipField UnpreparedValue)]
-&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([FieldParser n (RemoteRelationshipField UnpreparedValue)]
 -&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; ([FieldParser
       n
       (RemoteSourceSelect
          (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
    -&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; [FieldParser
      n
      (RemoteSourceSelect
         (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
-&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldParser
   n
   (RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)
 -&gt; FieldParser n (RemoteRelationshipField UnpreparedValue))
-&gt; [FieldParser
      n
      (RemoteSourceSelect
         (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
-&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RemoteSourceSelect
   (RemoteRelationshipField UnpreparedValue) UnpreparedValue b
 -&gt; RemoteRelationshipField UnpreparedValue)
-&gt; FieldParser
     n
     (RemoteSourceSelect
        (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)
-&gt; FieldParser n (RemoteRelationshipField UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnyBackend
  (RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; RemoteRelationshipField UnpreparedValue
forall (vf :: BackendType -&gt; *).
AnyBackend (RemoteSourceSelect (RemoteRelationshipField vf) vf)
-&gt; RemoteRelationshipField vf
</span><a href="Hasura.RQL.IR.Root.html#RemoteSourceField"><span class="hs-identifier hs-var">IR.RemoteSourceField</span></a></span><span> </span><span class="annot"><span class="annottext">(AnyBackend
   (RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
 -&gt; RemoteRelationshipField UnpreparedValue)
-&gt; (RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue b
    -&gt; AnyBackend
         (RemoteSourceSelect
            (RemoteRelationshipField UnpreparedValue) UnpreparedValue))
-&gt; RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue b
-&gt; RemoteRelationshipField UnpreparedValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RemoteSourceSelect
  (RemoteRelationshipField UnpreparedValue) UnpreparedValue b
-&gt; AnyBackend
     (RemoteSourceSelect
        (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
forall (b :: BackendType) (i :: BackendType -&gt; *).
HasTag b =&gt;
i b -&gt; AnyBackend i
</span><a href="Hasura.SQL.AnyBackend.html#mkAnyBackend"><span class="hs-identifier hs-var">mkAnyBackend</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>          </span><span class="annot"><span class="annottext">([FieldParser
    n
    (RemoteSourceSelect
       (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
 -&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
-&gt; m (Maybe
        [FieldParser n (RemoteRelationshipField UnpreparedValue)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RemoteSourceFieldInfo b
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue b)]
forall r (m :: * -&gt; *) (n :: * -&gt; *) (tgt :: BackendType).
(MonadBuildSchemaBase r m n, BackendSchema tgt) =&gt;
RemoteSourceFieldInfo tgt
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSourceField"><span class="hs-identifier hs-var">remoteRelationshipToSourceField</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSourceFieldInfo b
</span><a href="#local-6989586621688042603"><span class="hs-identifier hs-var">remoteSourceFieldInfo</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#RFISchema"><span class="hs-identifier hs-type">RFISchema</span></a></span><span> </span><span id="local-6989586621688042597"><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
</span><a href="#local-6989586621688042597"><span class="hs-identifier hs-var">remoteSchema</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">(FieldParser n RemoteSchemaSelect
 -&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; Maybe (FieldParser n RemoteSchemaSelect)
-&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldParser n (RemoteRelationshipField UnpreparedValue)
-&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(FieldParser n (RemoteRelationshipField UnpreparedValue)
 -&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; (FieldParser n RemoteSchemaSelect
    -&gt; FieldParser n (RemoteRelationshipField UnpreparedValue))
-&gt; FieldParser n RemoteSchemaSelect
-&gt; [FieldParser n (RemoteRelationshipField UnpreparedValue)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RemoteSchemaSelect -&gt; RemoteRelationshipField UnpreparedValue)
-&gt; FieldParser n RemoteSchemaSelect
-&gt; FieldParser n (RemoteRelationshipField UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaSelect -&gt; RemoteRelationshipField UnpreparedValue
forall (vf :: BackendType -&gt; *).
RemoteSchemaSelect -&gt; RemoteRelationshipField vf
</span><a href="Hasura.RQL.IR.Root.html#RemoteSchemaField"><span class="hs-identifier hs-var">IR.RemoteSchemaField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><span class="annottext">(Maybe (FieldParser n RemoteSchemaSelect)
 -&gt; Maybe [FieldParser n (RemoteRelationshipField UnpreparedValue)])
-&gt; m (Maybe (FieldParser n RemoteSchemaSelect))
-&gt; m (Maybe
        [FieldParser n (RemoteRelationshipField UnpreparedValue)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
-&gt; RemoteSchemaFieldInfo
-&gt; m (Maybe (FieldParser n RemoteSchemaSelect))
forall r (m :: * -&gt; *) (n :: * -&gt; *) lhsJoinField.
MonadBuildSchemaBase r m n =&gt;
HashMap FieldName lhsJoinField
-&gt; RemoteSchemaFieldInfo
-&gt; m (Maybe (FieldParser n RemoteSchemaSelect))
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSchemaField"><span class="hs-identifier hs-var">remoteRelationshipToSchemaField</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
</span><a href="#local-6989586621688042618"><span class="hs-identifier hs-var">_rfiLHS</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
</span><a href="#local-6989586621688042597"><span class="hs-identifier hs-var">remoteSchema</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Parser(s) for remote relationship fields to a remote schema</span><span>
</span><span id="line-60"></span><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSchemaField"><span class="hs-identifier hs-type">remoteRelationshipToSchemaField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688042830"><span class="annot"><a href="#local-6989586621688042830"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621688042829"><span class="annot"><a href="#local-6989586621688042829"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621688042828"><span class="annot"><a href="#local-6989586621688042828"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621688042827"><span class="annot"><a href="#local-6989586621688042827"><span class="hs-identifier hs-type">lhsJoinField</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042830"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042829"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042828"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map.HashMap</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042827"><span class="hs-identifier hs-type">lhsJoinField</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#RemoteSchemaFieldInfo"><span class="hs-identifier hs-type">RemoteSchemaFieldInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="#local-6989586621688042829"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Internal.Parser.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042828"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaSelect"><span class="hs-identifier hs-type">IR.RemoteSchemaSelect</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span id="remoteRelationshipToSchemaField"><span class="annot"><span class="annottext">remoteRelationshipToSchemaField :: HashMap FieldName lhsJoinField
-&gt; RemoteSchemaFieldInfo
-&gt; m (Maybe (FieldParser n RemoteSchemaSelect))
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSchemaField"><span class="hs-identifier hs-var hs-var">remoteRelationshipToSchemaField</span></a></span></span><span> </span><span id="local-6989586621688042594"><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
</span><a href="#local-6989586621688042594"><span class="hs-identifier hs-var">lhsFields</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#RemoteSchemaFieldInfo"><span class="hs-identifier hs-type">RemoteSchemaFieldInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688042586"><span id="local-6989586621688042587"><span id="local-6989586621688042588"><span id="local-6989586621688042589"><span id="local-6989586621688042590"><span id="local-6989586621688042591"><span id="local-6989586621688042592"><span class="annot"><span class="annottext">[TypeDefinition [Name] RemoteSchemaInputValueDefinition]
HashMap Name RemoteSchemaInputValueDefinition
RelName
RemoteSchemaName
RemoteSchemaInfo
LHSIdentifier
RemoteFields
_rrfiLHSIdentifier :: RemoteSchemaFieldInfo -&gt; LHSIdentifier
_rrfiRemoteSchemaName :: RemoteSchemaFieldInfo -&gt; RemoteSchemaName
_rrfiInputValueDefinitions :: RemoteSchemaFieldInfo
-&gt; [TypeDefinition [Name] RemoteSchemaInputValueDefinition]
_rrfiRemoteSchema :: RemoteSchemaFieldInfo -&gt; RemoteSchemaInfo
_rrfiRemoteFields :: RemoteSchemaFieldInfo -&gt; RemoteFields
_rrfiParamMap :: RemoteSchemaFieldInfo
-&gt; HashMap Name RemoteSchemaInputValueDefinition
_rrfiName :: RemoteSchemaFieldInfo -&gt; RelName
_rrfiLHSIdentifier :: LHSIdentifier
_rrfiRemoteSchemaName :: RemoteSchemaName
_rrfiInputValueDefinitions :: [TypeDefinition [Name] RemoteSchemaInputValueDefinition]
_rrfiRemoteSchema :: RemoteSchemaInfo
_rrfiRemoteFields :: RemoteFields
_rrfiParamMap :: HashMap Name RemoteSchemaInputValueDefinition
_rrfiName :: RelName
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#_rrfiLHSIdentifier"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT m (FieldParser n RemoteSchemaSelect)
-&gt; m (Maybe (FieldParser n RemoteSchemaSelect))
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var hs-var">runMaybeT</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621688042578"><span class="annot"><span class="annottext">HashMap RemoteSchemaName RemoteRelationshipQueryContext
</span><a href="#local-6989586621688042578"><span class="hs-identifier hs-var">remoteRelationshipQueryCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(r -&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext)
-&gt; MaybeT
     m (HashMap RemoteSchemaName RemoteRelationshipQueryContext)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext)
 -&gt; MaybeT
      m (HashMap RemoteSchemaName RemoteRelationshipQueryContext))
-&gt; (r -&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext)
-&gt; MaybeT
     m (HashMap RemoteSchemaName RemoteRelationshipQueryContext)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QueryContext
-&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext
</span><a href="Hasura.GraphQL.Schema.Common.html#qcRemoteRelationshipContext"><span class="hs-identifier hs-var hs-var">qcRemoteRelationshipContext</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryContext
 -&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext)
-&gt; (r -&gt; QueryContext)
-&gt; r
-&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; QueryContext
forall a t. Has a t =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">getter</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#RemoteRelationshipQueryContext"><span class="hs-identifier hs-type">RemoteRelationshipQueryContext</span></a></span><span> </span><span id="local-6989586621688042575"><span class="annot"><span class="annottext">IntrospectionResult
</span><a href="#local-6989586621688042575"><span class="hs-identifier hs-var">roleIntrospectionResultOriginal</span></a></span></span><span> </span><span class="annot"><span class="annottext">ParsedIntrospection
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688042574"><span class="annot"><span class="annottext">RemoteSchemaCustomizer
</span><a href="#local-6989586621688042574"><span class="hs-identifier hs-var">remoteSchemaCustomizer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- The remote relationship field should not be accessible</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- if the remote schema is not accessible to the said role</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">Maybe RemoteRelationshipQueryContext
-&gt; MaybeT m RemoteRelationshipQueryContext
forall (m :: * -&gt; *) b. Applicative m =&gt; Maybe b -&gt; MaybeT m b
</span><a href="Hasura.Prelude.html#hoistMaybe"><span class="hs-identifier hs-var">hoistMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe RemoteRelationshipQueryContext
 -&gt; MaybeT m RemoteRelationshipQueryContext)
-&gt; Maybe RemoteRelationshipQueryContext
-&gt; MaybeT m RemoteRelationshipQueryContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaName
-&gt; HashMap RemoteSchemaName RemoteRelationshipQueryContext
-&gt; Maybe RemoteRelationshipQueryContext
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621688042587"><span class="hs-identifier hs-var">_rrfiRemoteSchemaName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap RemoteSchemaName RemoteRelationshipQueryContext
</span><a href="#local-6989586621688042578"><span class="hs-identifier hs-var">remoteRelationshipQueryCtx</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621688042571"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688042571"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MaybeT m RoleName
forall r (m :: * -&gt; *). MonadRole r m =&gt; m RoleName
</span><a href="Hasura.GraphQL.Parser.Class.html#askRoleName"><span class="hs-identifier hs-var">askRoleName</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042569"><span class="annot"><span class="annottext">hasuraFieldNames :: HashSet FieldName
</span><a href="#local-6989586621688042569"><span class="hs-identifier hs-var hs-var">hasuraFieldNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField -&gt; HashSet FieldName
forall k a. HashMap k a -&gt; HashSet k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
</span><a href="#local-6989586621688042594"><span class="hs-identifier hs-var">lhsFields</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span id="local-6989586621688042567"><span class="annot"><span class="annottext">relationshipDef :: ToSchemaRelationshipDef
</span><a href="#local-6989586621688042567"><span class="hs-identifier hs-var hs-var">relationshipDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaName
-&gt; HashSet FieldName -&gt; RemoteFields -&gt; ToSchemaRelationshipDef
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#ToSchemaRelationshipDef"><span class="hs-identifier hs-var">ToSchemaRelationshipDef</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaName
</span><a href="#local-6989586621688042587"><span class="hs-identifier hs-var">_rrfiRemoteSchemaName</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet FieldName
</span><a href="#local-6989586621688042569"><span class="hs-identifier hs-var">hasuraFieldNames</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteFields
</span><a href="#local-6989586621688042590"><span class="hs-identifier hs-var">_rrfiRemoteFields</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621688042565"><span class="annot"><span class="annottext">[TypeDefinition [Name] RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042565"><span class="hs-identifier hs-var">newInpValDefns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinition</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.RemoteSchema.html#RemoteSchemaInputValueDefinition"><span class="hs-identifier hs-type">RemoteSchemaInputValueDefinition</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621688042564"><span class="annot"><span class="annottext">HashMap Name RemoteSchemaInputValueDefinition
</span><a href="#local-6989586621688042564"><span class="hs-identifier hs-var">remoteFieldParamMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688042571"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName -&gt; RoleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="Hasura.Session.html#adminRoleName"><span class="hs-identifier hs-var">adminRoleName</span></a></span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-comment">-- we don't validate the remote relationship when the role is admin</span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-comment">-- because it's already been validated, when the remote relationship</span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-comment">-- was created</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">([TypeDefinition [Name] RemoteSchemaInputValueDefinition],
 HashMap Name RemoteSchemaInputValueDefinition)
-&gt; MaybeT
     m
     ([TypeDefinition [Name] RemoteSchemaInputValueDefinition],
      HashMap Name RemoteSchemaInputValueDefinition)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypeDefinition [Name] RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042588"><span class="hs-identifier hs-var">_rrfiInputValueDefinitions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HashMap Name RemoteSchemaInputValueDefinition
</span><a href="#local-6989586621688042591"><span class="hs-identifier hs-var">_rrfiParamMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688042562"><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
</span><a href="#local-6989586621688042562"><span class="hs-identifier hs-var">roleRemoteField</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-84"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a.
(Foldable (Either ValidationError), Alternative f) =&gt;
Either ValidationError a -&gt; f a
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable t, Alternative f) =&gt;
t a -&gt; f a
</span><a href="Hasura.Prelude.html#afold"><span class="hs-identifier hs-var">afold</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either
   ValidationError
   (HashMap FieldName lhsJoinField, RemoteSchemaFieldInfo)
 -&gt; MaybeT
      m (HashMap FieldName lhsJoinField, RemoteSchemaFieldInfo))
-&gt; Either
     ValidationError
     (HashMap FieldName lhsJoinField, RemoteSchemaFieldInfo)
-&gt; MaybeT m (HashMap FieldName lhsJoinField, RemoteSchemaFieldInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-comment">-- TODO: this really needs to go way, we shouldn't be doing</span><span>
</span><span id="line-86"></span><span>            </span><span class="hs-comment">-- validation when building parsers</span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">ToSchemaRelationshipDef
-&gt; LHSIdentifier
-&gt; RelName
-&gt; (RemoteSchemaInfo, IntrospectionResult)
-&gt; HashMap FieldName lhsJoinField
-&gt; Either
     ValidationError
     (HashMap FieldName lhsJoinField, RemoteSchemaFieldInfo)
forall (m :: * -&gt; *) joinField.
MonadError ValidationError m =&gt;
ToSchemaRelationshipDef
-&gt; LHSIdentifier
-&gt; RelName
-&gt; (RemoteSchemaInfo, IntrospectionResult)
-&gt; HashMap FieldName joinField
-&gt; m (HashMap FieldName joinField, RemoteSchemaFieldInfo)
</span><a href="Hasura.RQL.DDL.RemoteRelationship.Validate.html#validateToSchemaRelationship"><span class="hs-identifier hs-var">validateToSchemaRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">ToSchemaRelationshipDef
</span><a href="#local-6989586621688042567"><span class="hs-identifier hs-var">relationshipDef</span></a></span><span> </span><span class="annot"><span class="annottext">LHSIdentifier
</span><a href="#local-6989586621688042586"><span class="hs-identifier hs-var">_rrfiLHSIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621688042592"><span class="hs-identifier hs-var">_rrfiName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteSchemaInfo
</span><a href="#local-6989586621688042589"><span class="hs-identifier hs-var">_rrfiRemoteSchema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntrospectionResult
</span><a href="#local-6989586621688042575"><span class="hs-identifier hs-var">roleIntrospectionResultOriginal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap FieldName lhsJoinField
</span><a href="#local-6989586621688042594"><span class="hs-identifier hs-var">lhsFields</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">([TypeDefinition [Name] RemoteSchemaInputValueDefinition],
 HashMap Name RemoteSchemaInputValueDefinition)
-&gt; MaybeT
     m
     ([TypeDefinition [Name] RemoteSchemaInputValueDefinition],
      HashMap Name RemoteSchemaInputValueDefinition)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
-&gt; [TypeDefinition [Name] RemoteSchemaInputValueDefinition]
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#_rrfiInputValueDefinitions"><span class="hs-identifier hs-var hs-var">Remote._rrfiInputValueDefinitions</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
</span><a href="#local-6989586621688042562"><span class="hs-identifier hs-var">roleRemoteField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
-&gt; HashMap Name RemoteSchemaInputValueDefinition
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#_rrfiParamMap"><span class="hs-identifier hs-var hs-var">Remote._rrfiParamMap</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaFieldInfo
</span><a href="#local-6989586621688042562"><span class="hs-identifier hs-var">roleRemoteField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042559"><span class="annot"><span class="annottext">roleIntrospection :: RemoteSchemaIntrospection
</span><a href="#local-6989586621688042559"><span class="hs-identifier hs-var">roleIntrospection</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.RemoteSchema.html#RemoteSchemaIntrospection"><span class="hs-identifier hs-type">RemoteSchemaIntrospection</span></a></span><span> </span><span id="local-6989586621688042557"><span class="annot"><span class="annottext">HashMap
  Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
</span><a href="#local-6989586621688042557"><span class="hs-identifier hs-var">typeDefns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntrospectionResult -&gt; RemoteSchemaIntrospection
</span><a href="Hasura.RQL.Types.SchemaCache.html#irDoc"><span class="hs-identifier hs-var hs-var">irDoc</span></a></span><span> </span><span class="annot"><span class="annottext">IntrospectionResult
</span><a href="#local-6989586621688042575"><span class="hs-identifier hs-var">roleIntrospectionResultOriginal</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- add the new input value definitions created by the remote relationship</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-comment">-- to the existing schema introspection of the role</span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621688042555"><span class="annot"><span class="annottext">remoteRelationshipIntrospection :: RemoteSchemaIntrospection
</span><a href="#local-6989586621688042555"><span class="hs-identifier hs-var hs-var">remoteRelationshipIntrospection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap
  Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; RemoteSchemaIntrospection
</span><a href="Hasura.RQL.Types.RemoteSchema.html#RemoteSchemaIntrospection"><span class="hs-identifier hs-var">RemoteSchemaIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap
   Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
 -&gt; RemoteSchemaIntrospection)
-&gt; HashMap
     Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; RemoteSchemaIntrospection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap
  Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
</span><a href="#local-6989586621688042557"><span class="hs-identifier hs-var">typeDefns</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap
  Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; HashMap
     Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; HashMap
     Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TypeDefinition [Name] RemoteSchemaInputValueDefinition -&gt; Name)
-&gt; [TypeDefinition [Name] RemoteSchemaInputValueDefinition]
-&gt; HashMap
     Name (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall k v. (Eq k, Hashable k) =&gt; (v -&gt; k) -&gt; [v] -&gt; HashMap k v
</span><a href="Data.HashMap.Strict.Extended.html#fromListOn"><span class="hs-identifier hs-var">Map.fromListOn</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] RemoteSchemaInputValueDefinition -&gt; Name
forall possibleTypes inputType.
TypeDefinition possibleTypes inputType -&gt; Name
</span><a href="Hasura.RQL.Types.RemoteSchema.html#getTypeName"><span class="hs-identifier hs-var">getTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeDefinition [Name] RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042565"><span class="hs-identifier hs-var">newInpValDefns</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621688042552"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042552"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MaybeT m Name
forall (m :: * -&gt; *). MonadError QErr m =&gt; Text -&gt; m Name
</span><a href="Hasura.GraphQL.Schema.Common.html#textToName"><span class="hs-identifier hs-var">textToName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; MaybeT m Name) -&gt; Text -&gt; MaybeT m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier hs-var">relNameToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621688042592"><span class="hs-identifier hs-var">_rrfiName</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">-- This selection set parser, should be of the remote node's selection set parser, which comes</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- from the fieldCall</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042550"><span class="annot"><span class="annottext">fieldCalls :: NonEmpty FieldCall
</span><a href="#local-6989586621688042550"><span class="hs-identifier hs-var hs-var">fieldCalls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RemoteFields -&gt; NonEmpty FieldCall
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#unRemoteFields"><span class="hs-identifier hs-var hs-var">unRemoteFields</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteFields
</span><a href="#local-6989586621688042590"><span class="hs-identifier hs-var">_rrfiRemoteFields</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621688042548"><span class="annot"><span class="annottext">parentTypeName :: Name
</span><a href="#local-6989586621688042548"><span class="hs-identifier hs-var hs-var">parentTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntrospectionResult -&gt; Name
</span><a href="Hasura.RQL.Types.SchemaCache.html#irQueryRoot"><span class="hs-identifier hs-var hs-var">irQueryRoot</span></a></span><span> </span><span class="annot"><span class="annottext">IntrospectionResult
</span><a href="#local-6989586621688042575"><span class="hs-identifier hs-var">roleIntrospectionResultOriginal</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621688042546"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042546"><span class="hs-identifier hs-var">nestedFieldType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m GType -&gt; MaybeT m GType
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m GType -&gt; MaybeT m GType) -&gt; m GType -&gt; MaybeT m GType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; RemoteSchemaIntrospection -&gt; NonEmpty FieldCall -&gt; m GType
forall (n :: * -&gt; *) (m :: * -&gt; *).
(MonadSchema n m, MonadError QErr m) =&gt;
Name -&gt; RemoteSchemaIntrospection -&gt; NonEmpty FieldCall -&gt; m GType
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType"><span class="hs-identifier hs-var">lookupNestedFieldType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042548"><span class="hs-identifier hs-var">parentTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042559"><span class="hs-identifier hs-var">roleIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042550"><span class="hs-identifier hs-var">fieldCalls</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042543"><span class="annot"><span class="annottext">typeName :: Name
</span><a href="#local-6989586621688042543"><span class="hs-identifier hs-var hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Name
</span><span class="hs-identifier hs-var">G.getBaseType</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042546"><span class="hs-identifier hs-var">nestedFieldType</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621688042541"><span class="annot"><span class="annottext">TypeDefinition [Name] RemoteSchemaInputValueDefinition
</span><a href="#local-6989586621688042541"><span class="hs-identifier hs-var">fieldTypeDefinition</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
-&gt; Name
-&gt; Maybe (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
</span><a href="Hasura.RQL.Types.RemoteSchema.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042559"><span class="hs-identifier hs-var">roleIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042543"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- the below case will never happen because we get the type name</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">-- from the schema document itself i.e. if a field exists for the</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- given role, then it's return type also must exist</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">(MaybeT m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
 -&gt; MaybeT
      m (TypeDefinition [Name] RemoteSchemaInputValueDefinition))
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">Text
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span> </span><span class="annot"><span class="annottext">(Text
 -&gt; MaybeT
      m (TypeDefinition [Name] RemoteSchemaInputValueDefinition))
-&gt; Text
-&gt; MaybeT
     m (TypeDefinition [Name] RemoteSchemaInputValueDefinition)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;unexpected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042543"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found &quot;</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- These are the arguments that are given by the user while executing a query</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042536"><span class="annot"><span class="annottext">remoteFieldUserArguments :: [RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042536"><span class="hs-identifier hs-var hs-var">remoteFieldUserArguments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, RemoteSchemaInputValueDefinition)
 -&gt; RemoteSchemaInputValueDefinition)
-&gt; [(Name, RemoteSchemaInputValueDefinition)]
-&gt; [RemoteSchemaInputValueDefinition]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Name, RemoteSchemaInputValueDefinition)
-&gt; RemoteSchemaInputValueDefinition
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(Name, RemoteSchemaInputValueDefinition)]
 -&gt; [RemoteSchemaInputValueDefinition])
-&gt; [(Name, RemoteSchemaInputValueDefinition)]
-&gt; [RemoteSchemaInputValueDefinition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name RemoteSchemaInputValueDefinition
-&gt; [(Name, RemoteSchemaInputValueDefinition)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name RemoteSchemaInputValueDefinition
</span><a href="#local-6989586621688042564"><span class="hs-identifier hs-var">remoteFieldParamMap</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621688042534"><span class="annot"><span class="annottext">FieldParser n (Field NoFragments RemoteSchemaVariable)
</span><a href="#local-6989586621688042534"><span class="hs-identifier hs-var">remoteFld</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">RemoteSchemaCustomizer
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall (m :: * -&gt; *) r a.
(MonadReader r m, Has MkTypename r,
 Has CustomizeRemoteFieldName r) =&gt;
RemoteSchemaCustomizer -&gt; m a -&gt; m a
</span><a href="Hasura.GraphQL.Schema.Remote.html#withRemoteSchemaCustomization"><span class="hs-identifier hs-var">withRemoteSchemaCustomization</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaCustomizer
</span><a href="#local-6989586621688042574"><span class="hs-identifier hs-var">remoteSchemaCustomizer</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeT m (FieldParser n (Field NoFragments RemoteSchemaVariable))
 -&gt; MaybeT
      m (FieldParser n (Field NoFragments RemoteSchemaVariable)))
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="annottext">m (FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (FieldParser n (Field NoFragments RemoteSchemaVariable))
 -&gt; MaybeT
      m (FieldParser n (Field NoFragments RemoteSchemaVariable)))
-&gt; m (FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; MaybeT
     m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">GType
-&gt; FieldParser n (Field NoFragments RemoteSchemaVariable)
-&gt; FieldParser n (Field NoFragments RemoteSchemaVariable)
forall (m :: * -&gt; *) a. GType -&gt; FieldParser m a -&gt; FieldParser m a
</span><a href="Hasura.GraphQL.Parser.Internal.Parser.html#wrapFieldParser"><span class="hs-identifier hs-var">P.wrapFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042546"><span class="hs-identifier hs-var">nestedFieldType</span></a></span><span>
</span><span id="line-114"></span><span>          </span><span class="annot"><span class="annottext">(FieldParser n (Field NoFragments RemoteSchemaVariable)
 -&gt; FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; m (FieldParser n (Field NoFragments RemoteSchemaVariable))
-&gt; m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
-&gt; Name
-&gt; Name
-&gt; Maybe Description
-&gt; [RemoteSchemaInputValueDefinition]
-&gt; TypeDefinition [Name] RemoteSchemaInputValueDefinition
-&gt; m (FieldParser n (Field NoFragments RemoteSchemaVariable))
forall r (m :: * -&gt; *) (n :: * -&gt; *).
MonadBuildRemoteSchema r m n =&gt;
RemoteSchemaIntrospection
-&gt; Name
-&gt; Name
-&gt; Maybe Description
-&gt; [RemoteSchemaInputValueDefinition]
-&gt; TypeDefinition [Name] RemoteSchemaInputValueDefinition
-&gt; m (FieldParser n (Field NoFragments RemoteSchemaVariable))
</span><a href="Hasura.GraphQL.Schema.Remote.html#remoteField"><span class="hs-identifier hs-var">remoteField</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042555"><span class="hs-identifier hs-var">remoteRelationshipIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042548"><span class="hs-identifier hs-var">parentTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042552"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Description
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042536"><span class="hs-identifier hs-var">remoteFieldUserArguments</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] RemoteSchemaInputValueDefinition
</span><a href="#local-6989586621688042541"><span class="hs-identifier hs-var">fieldTypeDefinition</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="annottext">FieldParser n RemoteSchemaSelect
-&gt; MaybeT m (FieldParser n RemoteSchemaSelect)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(FieldParser n RemoteSchemaSelect
 -&gt; MaybeT m (FieldParser n RemoteSchemaSelect))
-&gt; FieldParser n RemoteSchemaSelect
-&gt; MaybeT m (FieldParser n RemoteSchemaSelect)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">FieldParser n (Field NoFragments RemoteSchemaVariable)
</span><a href="#local-6989586621688042534"><span class="hs-identifier hs-var">remoteFld</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><span class="annottext">FieldParser n (Field NoFragments RemoteSchemaVariable)
-&gt; (Field NoFragments RemoteSchemaVariable -&gt; n RemoteSchemaSelect)
-&gt; FieldParser n RemoteSchemaSelect
forall (m :: * -&gt; *) a b.
Monad m =&gt;
FieldParser m a -&gt; (a -&gt; m b) -&gt; FieldParser m b
</span><a href="Hasura.GraphQL.Parser.Internal.Parser.html#bindField"><span class="hs-operator hs-var">`P.bindField`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688042529"><span class="annot"><span class="annottext">fld :: Field NoFragments RemoteSchemaVariable
</span><a href="#local-6989586621688042529"><span class="hs-identifier hs-var">fld</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">G.Field</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_fArguments :: forall (frag :: * -&gt; *) var.
Field frag var -&gt; HashMap Name (Value var)
</span><span class="hs-identifier hs-var">G._fArguments</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621688042526"><span class="annot"><span class="annottext">HashMap Name (Value RemoteSchemaVariable)
</span><a href="#local-6989586621688042526"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_fSelectionSet :: forall (frag :: * -&gt; *) var.
Field frag var -&gt; SelectionSet frag var
</span><span class="hs-identifier hs-var">G._fSelectionSet</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621688042524"><span class="annot"><span class="annottext">SelectionSet NoFragments RemoteSchemaVariable
</span><a href="#local-6989586621688042524"><span class="hs-identifier hs-var">selSet</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_fName :: forall (frag :: * -&gt; *) var. Field frag var -&gt; Name
</span><span class="hs-identifier hs-var">G._fName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621688042522"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042522"><span class="hs-identifier hs-var">fname</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042521"><span class="annot"><span class="annottext">remoteArgs :: [RemoteFieldArgument]
</span><a href="#local-6989586621688042521"><span class="hs-identifier hs-var hs-var">remoteArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>              </span><span class="annot"><span class="annottext">HashMap Name (Value RemoteSchemaVariable)
-&gt; [(Name, Value RemoteSchemaVariable)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value RemoteSchemaVariable)
</span><a href="#local-6989586621688042526"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Value RemoteSchemaVariable)]
-&gt; ((Name, Value RemoteSchemaVariable) -&gt; RemoteFieldArgument)
-&gt; [RemoteFieldArgument]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688042519"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042519"><span class="hs-identifier hs-var">argName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688042518"><span class="annot"><span class="annottext">Value RemoteSchemaVariable
</span><a href="#local-6989586621688042518"><span class="hs-identifier hs-var">argVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; InputValue RemoteSchemaVariable -&gt; RemoteFieldArgument
</span><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteFieldArgument"><span class="hs-identifier hs-var">IR.RemoteFieldArgument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042519"><span class="hs-identifier hs-var">argName</span></a></span><span> </span><span class="annot"><span class="annottext">(InputValue RemoteSchemaVariable -&gt; RemoteFieldArgument)
-&gt; InputValue RemoteSchemaVariable -&gt; RemoteFieldArgument
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value RemoteSchemaVariable -&gt; InputValue RemoteSchemaVariable
forall v. Value v -&gt; InputValue v
</span><a href="Hasura.GraphQL.Parser.Schema.html#GraphQLValue"><span class="hs-identifier hs-var">P.GraphQLValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value RemoteSchemaVariable
</span><a href="#local-6989586621688042518"><span class="hs-identifier hs-var">argVal</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042515"><span class="annot"><span class="annottext">resultCustomizer :: ResultCustomizer
</span><a href="#local-6989586621688042515"><span class="hs-identifier hs-var hs-var">resultCustomizer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>              </span><span class="annot"><span class="annottext">NonEmpty FieldCall -&gt; ResultCustomizer -&gt; ResultCustomizer
</span><a href="#local-6989586621688042514"><span class="hs-identifier hs-var">applyFieldCalls</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042550"><span class="hs-identifier hs-var">fieldCalls</span></a></span><span> </span><span class="annot"><span class="annottext">(ResultCustomizer -&gt; ResultCustomizer)
-&gt; ResultCustomizer -&gt; ResultCustomizer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-123"></span><span>                </span><span class="annot"><span class="annottext">AliasMapping -&gt; ResultCustomizer -&gt; ResultCustomizer
</span><a href="Hasura.RQL.Types.ResultCustomization.html#applyAliasMapping"><span class="hs-identifier hs-var">applyAliasMapping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; AliasMapping
</span><a href="Hasura.RQL.Types.ResultCustomization.html#singletonAliasMapping"><span class="hs-identifier hs-var">singletonAliasMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042522"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldCall -&gt; Name
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#fcName"><span class="hs-identifier hs-var hs-var">fcName</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldCall -&gt; Name) -&gt; FieldCall -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall -&gt; FieldCall
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042550"><span class="hs-identifier hs-var">fieldCalls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ResultCustomizer -&gt; ResultCustomizer)
-&gt; ResultCustomizer -&gt; ResultCustomizer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-124"></span><span>                  </span><span class="annot"><span class="annottext">RemoteSchemaCustomizer
-&gt; Field NoFragments RemoteSchemaVariable -&gt; ResultCustomizer
forall a.
RemoteSchemaCustomizer -&gt; Field NoFragments a -&gt; ResultCustomizer
</span><a href="Hasura.GraphQL.Schema.Remote.html#makeResultCustomizer"><span class="hs-identifier hs-var">makeResultCustomizer</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaCustomizer
</span><a href="#local-6989586621688042574"><span class="hs-identifier hs-var">remoteSchemaCustomizer</span></a></span><span> </span><span class="annot"><span class="annottext">Field NoFragments RemoteSchemaVariable
</span><a href="#local-6989586621688042529"><span class="hs-identifier hs-var">fld</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">RemoteSchemaSelect -&gt; n RemoteSchemaSelect
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(RemoteSchemaSelect -&gt; n RemoteSchemaSelect)
-&gt; RemoteSchemaSelect -&gt; n RemoteSchemaSelect
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-126"></span><span>          </span><span class="annot"><span class="annottext">RemoteSchemaSelect :: [RemoteFieldArgument]
-&gt; ResultCustomizer
-&gt; SelectionSet NoFragments RemoteSchemaVariable
-&gt; NonEmpty FieldCall
-&gt; RemoteSchemaInfo
-&gt; RemoteSchemaSelect
</span><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaSelect"><span class="hs-identifier hs-type">IR.RemoteSchemaSelect</span></a></span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_rselArgs :: [RemoteFieldArgument]
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselArgs"><span class="hs-identifier hs-var">IR._rselArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RemoteFieldArgument]
</span><a href="#local-6989586621688042521"><span class="hs-identifier hs-var">remoteArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>              </span><span class="annot"><span class="annottext">_rselResultCustomizer :: ResultCustomizer
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselResultCustomizer"><span class="hs-identifier hs-var">IR._rselResultCustomizer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResultCustomizer
</span><a href="#local-6989586621688042515"><span class="hs-identifier hs-var">resultCustomizer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>              </span><span class="annot"><span class="annottext">_rselSelection :: SelectionSet NoFragments RemoteSchemaVariable
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselSelection"><span class="hs-identifier hs-var">IR._rselSelection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionSet NoFragments RemoteSchemaVariable
</span><a href="#local-6989586621688042524"><span class="hs-identifier hs-var">selSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>              </span><span class="annot"><span class="annottext">_rselFieldCall :: NonEmpty FieldCall
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselFieldCall"><span class="hs-identifier hs-var">IR._rselFieldCall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042550"><span class="hs-identifier hs-var">fieldCalls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>              </span><span class="annot"><span class="annottext">_rselRemoteSchema :: RemoteSchemaInfo
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselRemoteSchema"><span class="hs-identifier hs-var">IR._rselRemoteSchema</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaInfo
</span><a href="#local-6989586621688042589"><span class="hs-identifier hs-var">_rrfiRemoteSchema</span></a></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- Apply parent field calls so that the result customizer modifies the nested field</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="#local-6989586621688042514"><span class="hs-identifier hs-type">applyFieldCalls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#FieldCall"><span class="hs-identifier hs-type">FieldCall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ResultCustomization.html#ResultCustomizer"><span class="hs-identifier hs-type">ResultCustomizer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ResultCustomization.html#ResultCustomizer"><span class="hs-identifier hs-type">ResultCustomizer</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621688042514"><span class="annot"><span class="annottext">applyFieldCalls :: NonEmpty FieldCall -&gt; ResultCustomizer -&gt; ResultCustomizer
</span><a href="#local-6989586621688042514"><span class="hs-identifier hs-var hs-var">applyFieldCalls</span></a></span></span><span> </span><span id="local-6989586621688042502"><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042502"><span class="hs-identifier hs-var">fieldCalls</span></a></span></span><span> </span><span id="local-6989586621688042501"><span class="annot"><span class="annottext">ResultCustomizer
</span><a href="#local-6989586621688042501"><span class="hs-identifier hs-var">resultCustomizer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">(FieldCall -&gt; ResultCustomizer -&gt; ResultCustomizer)
-&gt; ResultCustomizer -&gt; [FieldCall] -&gt; ResultCustomizer
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ResultCustomizer -&gt; ResultCustomizer
</span><a href="Hasura.RQL.Types.ResultCustomization.html#modifyFieldByName"><span class="hs-identifier hs-var">modifyFieldByName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ResultCustomizer -&gt; ResultCustomizer)
-&gt; (FieldCall -&gt; Name)
-&gt; FieldCall
-&gt; ResultCustomizer
-&gt; ResultCustomizer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldCall -&gt; Name
</span><a href="Hasura.RQL.Types.Relationships.ToSchema.html#fcName"><span class="hs-identifier hs-var hs-var">fcName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ResultCustomizer
</span><a href="#local-6989586621688042501"><span class="hs-identifier hs-var">resultCustomizer</span></a></span><span> </span><span class="annot"><span class="annottext">([FieldCall] -&gt; ResultCustomizer)
-&gt; [FieldCall] -&gt; ResultCustomizer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall -&gt; [FieldCall]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.init</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042502"><span class="hs-identifier hs-var">fieldCalls</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621688042696"><span id="local-6989586621688042697"><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType%27"><span class="hs-identifier hs-type">lookupNestedFieldType'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Class.html#MonadSchema"><span class="hs-identifier hs-type">MonadSchema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042697"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042696"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042696"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.RemoteSchema.html#RemoteSchemaIntrospection"><span class="hs-identifier hs-type">RemoteSchemaIntrospection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#FieldCall"><span class="hs-identifier hs-type">FieldCall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="#local-6989586621688042696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span></span></span><span>
</span><span id="line-145"></span><span id="lookupNestedFieldType%27"><span class="annot"><span class="annottext">lookupNestedFieldType' :: Name -&gt; RemoteSchemaIntrospection -&gt; FieldCall -&gt; m GType
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType%27"><span class="hs-identifier hs-var hs-var">lookupNestedFieldType'</span></a></span></span><span> </span><span id="local-6989586621688042496"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042496"><span class="hs-identifier hs-var">parentTypeName</span></a></span></span><span> </span><span id="local-6989586621688042495"><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042495"><span class="hs-identifier hs-var">remoteSchemaIntrospection</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#FieldCall"><span class="hs-identifier hs-type">FieldCall</span></a></span><span> </span><span id="local-6989586621688042493"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042493"><span class="hs-identifier hs-var">fcName</span></a></span></span><span> </span><span class="annot"><span class="annottext">RemoteArguments
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
-&gt; Name
-&gt; Maybe (ObjectTypeDefinition RemoteSchemaInputValueDefinition)
</span><a href="Hasura.RQL.Types.RemoteSchema.html#lookupObject"><span class="hs-identifier hs-var">lookupObject</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042495"><span class="hs-identifier hs-var">remoteSchemaIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042496"><span class="hs-identifier hs-var">parentTypeName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">Maybe (ObjectTypeDefinition RemoteSchemaInputValueDefinition)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m GType
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#RemoteSchemaError"><span class="hs-identifier hs-var">RemoteSchemaError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m GType) -&gt; Text -&gt; m GType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;object with name &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042496"><span class="hs-identifier hs-var">parentTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found&quot;</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.ObjectTypeDefinition</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688042484"><span id="local-6989586621688042485"><span id="local-6989586621688042486"><span id="local-6989586621688042487"><span id="local-6989586621688042488"><span class="annot"><span class="annottext">[Name]
[Directive Void]
[FieldDefinition RemoteSchemaInputValueDefinition]
Maybe Description
Name
_otdName :: forall inputType. ObjectTypeDefinition inputType -&gt; Name
_otdImplementsInterfaces :: forall inputType. ObjectTypeDefinition inputType -&gt; [Name]
_otdFieldsDefinition :: forall inputType.
ObjectTypeDefinition inputType -&gt; [FieldDefinition inputType]
_otdDirectives :: forall inputType.
ObjectTypeDefinition inputType -&gt; [Directive Void]
_otdDescription :: forall inputType.
ObjectTypeDefinition inputType -&gt; Maybe Description
_otdFieldsDefinition :: [FieldDefinition RemoteSchemaInputValueDefinition]
_otdDirectives :: [Directive Void]
_otdImplementsInterfaces :: [Name]
_otdName :: Name
_otdDescription :: Maybe Description
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(FieldDefinition RemoteSchemaInputValueDefinition -&gt; Bool)
-&gt; [FieldDefinition RemoteSchemaInputValueDefinition]
-&gt; Maybe (FieldDefinition RemoteSchemaInputValueDefinition)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042493"><span class="hs-identifier hs-var">fcName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool)
-&gt; (FieldDefinition RemoteSchemaInputValueDefinition -&gt; Name)
-&gt; FieldDefinition RemoteSchemaInputValueDefinition
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldDefinition RemoteSchemaInputValueDefinition -&gt; Name
forall inputType. FieldDefinition inputType -&gt; Name
</span><span class="hs-identifier hs-var hs-var">G._fldName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldDefinition RemoteSchemaInputValueDefinition]
</span><a href="#local-6989586621688042484"><span class="hs-identifier hs-var">_otdFieldsDefinition</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">Maybe (FieldDefinition RemoteSchemaInputValueDefinition)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m GType
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#RemoteSchemaError"><span class="hs-identifier hs-var">RemoteSchemaError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m GType) -&gt; Text -&gt; m GType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;field with name &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042493"><span class="hs-identifier hs-var">fcName</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found&quot;</span></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.FieldDefinition</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688042471"><span id="local-6989586621688042472"><span id="local-6989586621688042473"><span id="local-6989586621688042474"><span id="local-6989586621688042475"><span class="annot"><span class="annottext">[Directive Void]
[RemoteSchemaInputValueDefinition]
Maybe Description
Name
GType
_fldType :: forall inputType. FieldDefinition inputType -&gt; GType
_fldDirectives :: forall inputType. FieldDefinition inputType -&gt; [Directive Void]
_fldDescription :: forall inputType. FieldDefinition inputType -&gt; Maybe Description
_fldArgumentsDefinition :: forall inputType.
FieldDefinition inputType -&gt; ArgumentsDefinition inputType
_fldDirectives :: [Directive Void]
_fldType :: GType
_fldArgumentsDefinition :: [RemoteSchemaInputValueDefinition]
_fldName :: Name
_fldDescription :: Maybe Description
_fldName :: forall inputType. FieldDefinition inputType -&gt; Name
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType -&gt; m GType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042472"><span class="hs-identifier hs-var">_fldType</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621688042773"><span id="local-6989586621688042774"><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType"><span class="hs-identifier hs-type">lookupNestedFieldType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Class.html#MonadSchema"><span class="hs-identifier hs-type">MonadSchema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042774"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042773"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.RemoteSchema.html#RemoteSchemaIntrospection"><span class="hs-identifier hs-type">RemoteSchemaIntrospection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSchema.html#FieldCall"><span class="hs-identifier hs-type">FieldCall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="#local-6989586621688042773"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span></span></span><span>
</span><span id="line-159"></span><span id="lookupNestedFieldType"><span class="annot"><span class="annottext">lookupNestedFieldType :: Name -&gt; RemoteSchemaIntrospection -&gt; NonEmpty FieldCall -&gt; m GType
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType"><span class="hs-identifier hs-var hs-var">lookupNestedFieldType</span></a></span></span><span> </span><span id="local-6989586621688042466"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042466"><span class="hs-identifier hs-var">parentTypeName</span></a></span></span><span> </span><span id="local-6989586621688042465"><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042465"><span class="hs-identifier hs-var">remoteSchemaIntrospection</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621688042464"><span class="annot"><span class="annottext">FieldCall
</span><a href="#local-6989586621688042464"><span class="hs-identifier hs-var">fieldCall</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621688042462"><span class="annot"><span class="annottext">[FieldCall]
</span><a href="#local-6989586621688042462"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621688042461"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042461"><span class="hs-identifier hs-var">fieldType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RemoteSchemaIntrospection -&gt; FieldCall -&gt; m GType
forall (n :: * -&gt; *) (m :: * -&gt; *).
(MonadSchema n m, MonadError QErr m) =&gt;
Name -&gt; RemoteSchemaIntrospection -&gt; FieldCall -&gt; m GType
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType%27"><span class="hs-identifier hs-var">lookupNestedFieldType'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042466"><span class="hs-identifier hs-var">parentTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042465"><span class="hs-identifier hs-var">remoteSchemaIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">FieldCall
</span><a href="#local-6989586621688042464"><span class="hs-identifier hs-var">fieldCall</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FieldCall] -&gt; Maybe (NonEmpty FieldCall)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[FieldCall]
</span><a href="#local-6989586621688042462"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NonEmpty FieldCall)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType -&gt; m GType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042461"><span class="hs-identifier hs-var">fieldType</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688042459"><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042459"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; RemoteSchemaIntrospection -&gt; NonEmpty FieldCall -&gt; m GType
forall (n :: * -&gt; *) (m :: * -&gt; *).
(MonadSchema n m, MonadError QErr m) =&gt;
Name -&gt; RemoteSchemaIntrospection -&gt; NonEmpty FieldCall -&gt; m GType
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#lookupNestedFieldType"><span class="hs-identifier hs-var">lookupNestedFieldType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GType -&gt; Name
</span><span class="hs-identifier hs-var">G.getBaseType</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688042461"><span class="hs-identifier hs-var">fieldType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaIntrospection
</span><a href="#local-6989586621688042465"><span class="hs-identifier hs-var">remoteSchemaIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688042459"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Parser(s) for remote relationship fields to a database table.</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Note that when the target is a database table, an array relationship</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- declaration would have the '_aggregate' field in addition to the array</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- relationship field, hence [FieldParser ...] instead of 'FieldParser'</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSourceField"><span class="hs-identifier hs-type">remoteRelationshipToSourceField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688042839"><span class="annot"><a href="#local-6989586621688042839"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621688042838"><span class="annot"><a href="#local-6989586621688042838"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621688042837"><span class="annot"><a href="#local-6989586621688042837"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621688042835"><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#MonadBuildSchemaBase"><span class="hs-identifier hs-type">MonadBuildSchemaBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042839"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042838"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042837"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Backend.html#BackendSchema"><span class="hs-identifier hs-type">BackendSchema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSource.html#RemoteSourceFieldInfo"><span class="hs-identifier hs-type">RemoteSourceFieldInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="#local-6989586621688042838"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.GraphQL.Parser.Internal.Parser.html#FieldParser"><span class="hs-identifier hs-type">FieldParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042837"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#RemoteSourceSelect"><span class="hs-identifier hs-type">IR.RemoteSourceSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">IR.RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span id="remoteRelationshipToSourceField"><span class="annot"><span class="annottext">remoteRelationshipToSourceField :: RemoteSourceFieldInfo tgt
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
</span><a href="Hasura.GraphQL.Schema.RemoteRelationship.html#remoteRelationshipToSourceField"><span class="hs-identifier hs-var hs-var">remoteRelationshipToSourceField</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.ToSource.html#RemoteSourceFieldInfo"><span class="hs-identifier hs-type">RemoteSourceFieldInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688042451"><span id="local-6989586621688042452"><span id="local-6989586621688042453"><span id="local-6989586621688042454"><span id="local-6989586621688042455"><span id="local-6989586621688042456"><span id="local-6989586621688042457"><span class="annot"><span class="annottext">HashMap FieldName (ScalarType tgt, Column tgt)
SourceConfig tgt
TableName tgt
SourceName
RelType
RelName
SourceTypeCustomization
_rsfiMapping :: forall (tgt :: BackendType).
RemoteSourceFieldInfo tgt
-&gt; HashMap FieldName (ScalarType tgt, Column tgt)
_rsfiTable :: forall (tgt :: BackendType).
RemoteSourceFieldInfo tgt -&gt; TableName tgt
_rsfiSourceCustomization :: forall (tgt :: BackendType).
RemoteSourceFieldInfo tgt -&gt; SourceTypeCustomization
_rsfiSourceConfig :: forall (tgt :: BackendType).
RemoteSourceFieldInfo tgt -&gt; SourceConfig tgt
_rsfiSource :: forall (tgt :: BackendType).
RemoteSourceFieldInfo tgt -&gt; SourceName
_rsfiType :: forall (tgt :: BackendType). RemoteSourceFieldInfo tgt -&gt; RelType
_rsfiName :: forall (tgt :: BackendType). RemoteSourceFieldInfo tgt -&gt; RelName
_rsfiMapping :: HashMap FieldName (ScalarType tgt, Column tgt)
_rsfiTable :: TableName tgt
_rsfiSourceCustomization :: SourceTypeCustomization
_rsfiSourceConfig :: SourceConfig tgt
_rsfiSource :: SourceName
_rsfiType :: RelType
_rsfiName :: RelName
</span><a href="Hasura.RQL.Types.Relationships.ToSource.html#_rsfiMapping"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">MkTypename
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
forall (m :: * -&gt; *) r a.
(MonadReader r m, Has MkTypename r) =&gt;
MkTypename -&gt; m a -&gt; m a
</span><a href="Hasura.GraphQL.Parser.Schema.html#withTypenameCustomization"><span class="hs-identifier hs-var">withTypenameCustomization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SourceTypeCustomization -&gt; MkTypename
</span><a href="Hasura.RQL.Types.SourceCustomization.html#mkCustomizedTypename"><span class="hs-identifier hs-var">mkCustomizedTypename</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe SourceTypeCustomization -&gt; MkTypename)
-&gt; Maybe SourceTypeCustomization -&gt; MkTypename
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceTypeCustomization -&gt; Maybe SourceTypeCustomization
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SourceTypeCustomization
</span><a href="#local-6989586621688042453"><span class="hs-identifier hs-var">_rsfiSourceCustomization</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621688042442"><span class="annot"><span class="annottext">TableInfo tgt
</span><a href="#local-6989586621688042442"><span class="hs-identifier hs-var">tableInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SourceName -&gt; TableName tgt -&gt; m (TableInfo tgt)
forall (b :: BackendType) r (m :: * -&gt; *).
(Backend b, MonadTableInfo r m) =&gt;
SourceName -&gt; TableName b -&gt; m (TableInfo b)
</span><a href="Hasura.GraphQL.Parser.Class.html#askTableInfo"><span class="hs-identifier hs-var">askTableInfo</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688042455"><span class="hs-identifier hs-var">_rsfiSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableName tgt
</span><a href="#local-6989586621688042452"><span class="hs-identifier hs-var">_rsfiTable</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621688042440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042440"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Name
forall (m :: * -&gt; *). MonadError QErr m =&gt; Text -&gt; m Name
</span><a href="Hasura.GraphQL.Schema.Common.html#textToName"><span class="hs-identifier hs-var">textToName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Name) -&gt; Text -&gt; m Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier hs-var">relNameToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621688042457"><span class="hs-identifier hs-var">_rsfiName</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621688042439"><span class="annot"><span class="annottext">Maybe (SelPermInfo tgt)
</span><a href="#local-6989586621688042439"><span class="hs-identifier hs-var">maybePerms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TableInfo tgt -&gt; m (Maybe (SelPermInfo tgt))
forall (b :: BackendType) r (m :: * -&gt; *) (n :: * -&gt; *).
(Backend b, MonadSchema n m, MonadRole r m) =&gt;
TableInfo b -&gt; m (Maybe (SelPermInfo b))
</span><a href="Hasura.GraphQL.Schema.Table.html#tableSelectPermissions"><span class="hs-identifier hs-var">tableSelectPermissions</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688042835"><span class="hs-identifier hs-type">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo tgt
</span><a href="#local-6989586621688042442"><span class="hs-identifier hs-var">tableInfo</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (SelPermInfo tgt)
</span><a href="#local-6989586621688042439"><span class="hs-identifier hs-var">maybePerms</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">Maybe (SelPermInfo tgt)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FieldParser
   n
   (RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688042437"><span class="annot"><span class="annottext">SelPermInfo tgt
</span><a href="#local-6989586621688042437"><span class="hs-identifier hs-var">tablePerms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>        </span><span id="local-6989586621688042436"><span class="annot"><span class="annottext">[FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
</span><a href="#local-6989586621688042436"><span class="hs-identifier hs-var">parsers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="#local-6989586621688042456"><span class="hs-identifier hs-var">_rsfiType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>          </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>            </span><span id="local-6989586621688042434"><span class="annot"><span class="annottext">Parser 'Output n (AnnotatedFields tgt)
</span><a href="#local-6989586621688042434"><span class="hs-identifier hs-var">selectionSetParser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SourceName
-&gt; TableInfo tgt
-&gt; SelPermInfo tgt
-&gt; m (Parser 'Output n (AnnotatedFields tgt))
forall (b :: BackendType) r (m :: * -&gt; *) (n :: * -&gt; *).
MonadBuildSchema b r m n =&gt;
SourceName
-&gt; TableInfo b
-&gt; SelPermInfo b
-&gt; m (Parser 'Output n (AnnotatedFields b))
</span><a href="Hasura.GraphQL.Schema.Select.html#tableSelectionSet"><span class="hs-identifier hs-var">tableSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688042455"><span class="hs-identifier hs-var">_rsfiSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo tgt
</span><a href="#local-6989586621688042442"><span class="hs-identifier hs-var">tableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo tgt
</span><a href="#local-6989586621688042437"><span class="hs-identifier hs-var">tablePerms</span></a></span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><span class="annottext">[FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
-&gt; m [FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([FieldParser
    n
    (SourceRelationshipSelection
       tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
 -&gt; m [FieldParser
         n
         (SourceRelationshipSelection
            tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)])
-&gt; (FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
    -&gt; [FieldParser
          n
          (SourceRelationshipSelection
             tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)])
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; m [FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldParser
  n
  (SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; [FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
 -&gt; m [FieldParser
         n
         (SourceRelationshipSelection
            tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)])
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; m [FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-187"></span><span>              </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Description
-&gt; Parser 'Output n (AnnotatedFields tgt)
-&gt; FieldParser n (AnnotatedFields tgt)
forall (m :: * -&gt; *) a.
MonadParse m =&gt;
Name -&gt; Maybe Description -&gt; Parser 'Output m a -&gt; FieldParser m a
</span><a href="Hasura.GraphQL.Parser.Internal.Parser.html#subselection_"><span class="hs-identifier hs-var">subselection_</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042440"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Description
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Parser 'Output n (AnnotatedFields tgt)
</span><a href="#local-6989586621688042434"><span class="hs-identifier hs-var">selectionSetParser</span></a></span><span> </span><span class="annot"><span class="annottext">FieldParser n (AnnotatedFields tgt)
-&gt; (AnnotatedFields tgt
    -&gt; SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688042431"><span class="annot"><span class="annottext">AnnotatedFields tgt
</span><a href="#local-6989586621688042431"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>                </span><span class="annot"><span class="annottext">AnnObjectSelectG
  tgt (RemoteRelationshipField UnpreparedValue) (UnpreparedValue tgt)
-&gt; SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnObjectSelectG b r (vf b) -&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipObject"><span class="hs-identifier hs-var">IR.SourceRelationshipObject</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnObjectSelectG
   tgt (RemoteRelationshipField UnpreparedValue) (UnpreparedValue tgt)
 -&gt; SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; AnnObjectSelectG
     tgt (RemoteRelationshipField UnpreparedValue) (UnpreparedValue tgt)
-&gt; SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-189"></span><span>                  </span><span class="annot"><span class="annottext">AnnotatedFields tgt
-&gt; TableName tgt
-&gt; AnnBoolExp tgt (UnpreparedValue tgt)
-&gt; AnnObjectSelectG
     tgt (RemoteRelationshipField UnpreparedValue) (UnpreparedValue tgt)
forall (b :: BackendType) r v.
AnnFieldsG b r v
-&gt; TableName b -&gt; AnnBoolExp b v -&gt; AnnObjectSelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-var">IR.AnnObjectSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedFields tgt
</span><a href="#local-6989586621688042431"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">TableName tgt
</span><a href="#local-6989586621688042452"><span class="hs-identifier hs-var">_rsfiTable</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnBoolExp tgt (UnpreparedValue tgt)
 -&gt; AnnObjectSelectG
      tgt
      (RemoteRelationshipField UnpreparedValue)
      (UnpreparedValue tgt))
-&gt; AnnBoolExp tgt (UnpreparedValue tgt)
-&gt; AnnObjectSelectG
     tgt (RemoteRelationshipField UnpreparedValue) (UnpreparedValue tgt)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TablePermG tgt (UnpreparedValue tgt)
-&gt; AnnBoolExp tgt (UnpreparedValue tgt)
forall (b :: BackendType) v. TablePermG b v -&gt; AnnBoolExp b v
</span><a href="Hasura.RQL.IR.Select.html#_tpFilter"><span class="hs-identifier hs-var hs-var">IR._tpFilter</span></a></span><span> </span><span class="annot"><span class="annottext">(TablePermG tgt (UnpreparedValue tgt)
 -&gt; AnnBoolExp tgt (UnpreparedValue tgt))
-&gt; TablePermG tgt (UnpreparedValue tgt)
-&gt; AnnBoolExp tgt (UnpreparedValue tgt)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo tgt -&gt; TablePermG tgt (UnpreparedValue tgt)
forall (b :: BackendType).
Backend b =&gt;
SelPermInfo b -&gt; TablePerms b
</span><a href="Hasura.GraphQL.Schema.Select.html#tablePermissionsInfo"><span class="hs-identifier hs-var">tablePermissionsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo tgt
</span><a href="#local-6989586621688042437"><span class="hs-identifier hs-var">tablePerms</span></a></span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688042425"><span class="annot"><span class="annottext">aggFieldName :: Name
</span><a href="#local-6989586621688042425"><span class="hs-identifier hs-var hs-var">aggFieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042440"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">$$(</span><span class="annot"><span class="hs-identifier hs-type">G.litName</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_aggregate&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>            </span><span id="local-6989586621688042421"><span class="annot"><span class="annottext">FieldParser n (SelectExp tgt)
</span><a href="#local-6989586621688042421"><span class="hs-identifier hs-var">selectionSetParser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SourceName
-&gt; TableInfo tgt
-&gt; Name
-&gt; Maybe Description
-&gt; SelPermInfo tgt
-&gt; m (FieldParser n (SelectExp tgt))
forall (b :: BackendType) r (m :: * -&gt; *) (n :: * -&gt; *).
MonadBuildSchema b r m n =&gt;
SourceName
-&gt; TableInfo b
-&gt; Name
-&gt; Maybe Description
-&gt; SelPermInfo b
-&gt; m (FieldParser n (SelectExp b))
</span><a href="Hasura.GraphQL.Schema.Select.html#selectTable"><span class="hs-identifier hs-var">selectTable</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688042455"><span class="hs-identifier hs-var">_rsfiSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo tgt
</span><a href="#local-6989586621688042442"><span class="hs-identifier hs-var">tableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042440"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Description
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo tgt
</span><a href="#local-6989586621688042437"><span class="hs-identifier hs-var">tablePerms</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span id="local-6989586621688042419"><span class="annot"><span class="annottext">Maybe (FieldParser n (AggSelectExp tgt))
</span><a href="#local-6989586621688042419"><span class="hs-identifier hs-var">aggSelectionSetParser</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SourceName
-&gt; TableInfo tgt
-&gt; Name
-&gt; Maybe Description
-&gt; SelPermInfo tgt
-&gt; m (Maybe (FieldParser n (AggSelectExp tgt)))
forall (b :: BackendType) r (m :: * -&gt; *) (n :: * -&gt; *).
MonadBuildSchema b r m n =&gt;
SourceName
-&gt; TableInfo b
-&gt; Name
-&gt; Maybe Description
-&gt; SelPermInfo b
-&gt; m (Maybe (FieldParser n (AggSelectExp b)))
</span><a href="Hasura.GraphQL.Schema.Select.html#selectTableAggregate"><span class="hs-identifier hs-var">selectTableAggregate</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688042455"><span class="hs-identifier hs-var">_rsfiSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo tgt
</span><a href="#local-6989586621688042442"><span class="hs-identifier hs-var">tableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688042425"><span class="hs-identifier hs-var">aggFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Description
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo tgt
</span><a href="#local-6989586621688042437"><span class="hs-identifier hs-var">tablePerms</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">[FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
-&gt; m [FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([FieldParser
    n
    (SourceRelationshipSelection
       tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
 -&gt; m [FieldParser
         n
         (SourceRelationshipSelection
            tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)])
-&gt; [FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
-&gt; m [FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-195"></span><span>              </span><span class="annot"><span class="annottext">[Maybe
   (FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue))]
-&gt; [FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-196"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FieldParser
  n
  (SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; Maybe
     (FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
 -&gt; Maybe
      (FieldParser
         n
         (SourceRelationshipSelection
            tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)))
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; Maybe
     (FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldParser n (SelectExp tgt)
</span><a href="#local-6989586621688042421"><span class="hs-identifier hs-var">selectionSetParser</span></a></span><span> </span><span class="annot"><span class="annottext">FieldParser n (SelectExp tgt)
-&gt; (SelectExp tgt
    -&gt; SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SelectExp tgt
-&gt; SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnSimpleSelectG b r (vf b) -&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArray"><span class="hs-identifier hs-var">IR.SourceRelationshipArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (FieldParser n (AggSelectExp tgt))
</span><a href="#local-6989586621688042419"><span class="hs-identifier hs-var">aggSelectionSetParser</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FieldParser n (AggSelectExp tgt))
-&gt; (FieldParser n (AggSelectExp tgt)
    -&gt; FieldParser
         n
         (SourceRelationshipSelection
            tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue))
-&gt; Maybe
     (FieldParser
        n
        (SourceRelationshipSelection
           tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(AggSelectExp tgt
 -&gt; SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; FieldParser n (AggSelectExp tgt)
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">AggSelectExp tgt
-&gt; SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnAggregateSelectG b r (vf b)
-&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArrayAggregate"><span class="hs-identifier hs-var">IR.SourceRelationshipArrayAggregate</span></a></span><span>
</span><span id="line-198"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">[FieldParser
   n
   (RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([FieldParser
    n
    (RemoteSourceSelect
       (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
 -&gt; m [FieldParser
         n
         (RemoteSourceSelect
            (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)])
-&gt; [FieldParser
      n
      (RemoteSourceSelect
         (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
-&gt; m [FieldParser
        n
        (RemoteSourceSelect
           (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-200"></span><span>          </span><span class="annot"><span class="annottext">[FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
</span><a href="#local-6989586621688042436"><span class="hs-identifier hs-var">parsers</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldParser
   n
   (SourceRelationshipSelection
      tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)]
-&gt; (FieldParser
      n
      (SourceRelationshipSelection
         tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
    -&gt; FieldParser
         n
         (RemoteSourceSelect
            (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt))
-&gt; [FieldParser
      n
      (RemoteSourceSelect
         (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(SourceRelationshipSelection
   tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
 -&gt; RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)
-&gt; FieldParser
     n
     (SourceRelationshipSelection
        tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; FieldParser
     n
     (RemoteSourceSelect
        (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688042414"><span class="annot"><span class="annottext">SourceRelationshipSelection
  tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
</span><a href="#local-6989586621688042414"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>            </span><span class="annot"><span class="annottext">SourceName
-&gt; SourceConfig tgt
-&gt; SourceRelationshipSelection
     tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
-&gt; HashMap FieldName (ScalarType tgt, Column tgt)
-&gt; RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue tgt
forall r (vf :: BackendType -&gt; *) (tgt :: BackendType).
SourceName
-&gt; SourceConfig tgt
-&gt; SourceRelationshipSelection tgt r vf
-&gt; HashMap FieldName (ScalarType tgt, Column tgt)
-&gt; RemoteSourceSelect r vf tgt
</span><a href="Hasura.RQL.IR.Select.html#RemoteSourceSelect"><span class="hs-identifier hs-var">IR.RemoteSourceSelect</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688042455"><span class="hs-identifier hs-var">_rsfiSource</span></a></span><span> </span><span class="annot"><span class="annottext">SourceConfig tgt
</span><a href="#local-6989586621688042454"><span class="hs-identifier hs-var">_rsfiSourceConfig</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRelationshipSelection
  tgt (RemoteRelationshipField UnpreparedValue) UnpreparedValue
</span><a href="#local-6989586621688042414"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (ScalarType tgt, Column tgt)
</span><a href="#local-6989586621688042451"><span class="hs-identifier hs-var">_rsfiMapping</span></a></span><span>
</span><span id="line-202"></span></pre></body></html>