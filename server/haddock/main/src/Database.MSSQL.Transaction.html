<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.MSSQL.Transaction</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#runTx"><span class="hs-identifier">runTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#runTxE"><span class="hs-identifier">runTxE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier">unitQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#unitQueryE"><span class="hs-identifier">unitQueryE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#singleRowQuery"><span class="hs-identifier">singleRowQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#singleRowQueryE"><span class="hs-identifier">singleRowQueryE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#multiRowQuery"><span class="hs-identifier">multiRowQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#multiRowQueryE"><span class="hs-identifier">multiRowQueryE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#rawQuery"><span class="hs-identifier">rawQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier">rawQueryE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#buildGenericTxE"><span class="hs-identifier">buildGenericTxE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier">TxT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier">TxET</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier">MSSQLTxError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">try</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">MonadError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">catchError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">withExceptT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/mmorph-1.1.4-148be31b22abef1681b63320aaca23223828545ea87fb44e3a354db5218dc23a/share/doc/html/src"><span class="hs-identifier">Control.Monad.Morph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/mmorph-1.1.4-148be31b22abef1681b63320aaca23223828545ea87fb44e3a354db5218dc23a/share/doc/html/src"><span class="hs-identifier">MFunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/mmorph-1.1.4-148be31b22abef1681b63320aaca23223828545ea87fb44e3a354db5218dc23a/share/doc/html/src"><span class="hs-identifier">hoist</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">MonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadFix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">MonadReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier">Database.ODBC.SQLServer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier">FromRow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier">Database.ODBC.SQLServer</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ODBC</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/text-1.2.3.2-4200bf40e86b2107f4b06242de65d549c52e58e8833e72545e35f7712661e715/share/doc/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Prelude.html#hoistEither"><span class="hs-identifier">hoistEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">liftEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Prelude.html#mapLeft"><span class="hs-identifier">mapLeft</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="MSSQLTxError"><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-var">MSSQLTxError</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MSSQLQueryError"><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLQueryError"><span class="hs-identifier hs-var">MSSQLQueryError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.ODBCException</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MSSQLInternal"><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLInternal"><span class="hs-identifier hs-var">MSSQLInternal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/text-1.2.3.2-4200bf40e86b2107f4b06242de65d549c52e58e8833e72545e35f7712661e715/share/doc/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690050861"><span id="local-6989586621690050863"><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError -&gt; Bool
(MSSQLTxError -&gt; MSSQLTxError -&gt; Bool)
-&gt; (MSSQLTxError -&gt; MSSQLTxError -&gt; Bool) -&gt; Eq MSSQLTxError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MSSQLTxError -&gt; MSSQLTxError -&gt; Bool
$c/= :: MSSQLTxError -&gt; MSSQLTxError -&gt; Bool
== :: MSSQLTxError -&gt; MSSQLTxError -&gt; Bool
$c== :: MSSQLTxError -&gt; MSSQLTxError -&gt; Bool
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050854"><span id="local-6989586621690050856"><span id="local-6989586621690050858"><span class="annot"><span class="annottext">Int -&gt; MSSQLTxError -&gt; ShowS
[MSSQLTxError] -&gt; ShowS
MSSQLTxError -&gt; String
(Int -&gt; MSSQLTxError -&gt; ShowS)
-&gt; (MSSQLTxError -&gt; String)
-&gt; ([MSSQLTxError] -&gt; ShowS)
-&gt; Show MSSQLTxError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MSSQLTxError] -&gt; ShowS
$cshowList :: [MSSQLTxError] -&gt; ShowS
show :: MSSQLTxError -&gt; String
$cshow :: MSSQLTxError -&gt; String
showsPrec :: Int -&gt; MSSQLTxError -&gt; ShowS
$cshowsPrec :: Int -&gt; MSSQLTxError -&gt; ShowS
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | A successful result from a query is a list of rows where each row contains list of column values</span><span>
</span><span id="line-41"></span><span class="hs-keyword">newtype</span><span> </span><span id="MSSQLResult"><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-var">MSSQLResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MSSQLResult"><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-var">MSSQLResult</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Value</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690050848"><span id="local-6989586621690050850"><span class="annot"><span class="annottext">MSSQLResult -&gt; MSSQLResult -&gt; Bool
(MSSQLResult -&gt; MSSQLResult -&gt; Bool)
-&gt; (MSSQLResult -&gt; MSSQLResult -&gt; Bool) -&gt; Eq MSSQLResult
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MSSQLResult -&gt; MSSQLResult -&gt; Bool
$c/= :: MSSQLResult -&gt; MSSQLResult -&gt; Bool
== :: MSSQLResult -&gt; MSSQLResult -&gt; Bool
$c== :: MSSQLResult -&gt; MSSQLResult -&gt; Bool
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050842"><span id="local-6989586621690050844"><span id="local-6989586621690050846"><span class="annot"><span class="annottext">Int -&gt; MSSQLResult -&gt; ShowS
[MSSQLResult] -&gt; ShowS
MSSQLResult -&gt; String
(Int -&gt; MSSQLResult -&gt; ShowS)
-&gt; (MSSQLResult -&gt; String)
-&gt; ([MSSQLResult] -&gt; ShowS)
-&gt; Show MSSQLResult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MSSQLResult] -&gt; ShowS
$cshowList :: [MSSQLResult] -&gt; ShowS
show :: MSSQLResult -&gt; String
$cshow :: MSSQLResult -&gt; String
showsPrec :: Int -&gt; MSSQLResult -&gt; ShowS
$cshowsPrec :: Int -&gt; MSSQLResult -&gt; ShowS
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | The transaction command to run, parameterised over:</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- e - the exception type</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- m - some Monad</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- a - the successful result type</span><span>
</span><span id="line-48"></span><span class="hs-keyword">newtype</span><span> </span><span id="TxET"><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-var">TxET</span></a></span></span><span> </span><span id="local-6989586621690051008"><span class="annot"><a href="#local-6989586621690051008"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621690051007"><span class="annot"><a href="#local-6989586621690051007"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690051006"><span class="annot"><a href="#local-6989586621690051006"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxET"><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-var">TxET</span></a></span></span><span> </span><span class="hs-special">{</span><span id="txHandler"><span class="annot"><span class="annottext">TxET e m a -&gt; ReaderT Connection (ExceptT e m) a
</span><a href="Database.MSSQL.Transaction.html#txHandler"><span class="hs-identifier hs-var hs-var">txHandler</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690051008"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690051007"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690051006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621690050836"><span id="local-6989586621690050838"><span class="annot"><span class="annottext">a -&gt; TxET e m b -&gt; TxET e m a
(a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
(forall a b. (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b)
-&gt; (forall a b. a -&gt; TxET e m b -&gt; TxET e m a)
-&gt; Functor (TxET e m)
forall a b. a -&gt; TxET e m b -&gt; TxET e m a
forall a b. (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
forall e (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; TxET e m b -&gt; TxET e m a
forall e (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; TxET e m b -&gt; TxET e m a
$c&lt;$ :: forall e (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; TxET e m b -&gt; TxET e m a
fmap :: (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
$cfmap :: forall e (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050824"><span id="local-6989586621690050826"><span id="local-6989586621690050828"><span id="local-6989586621690050830"><span id="local-6989586621690050832"><span class="annot"><span class="annottext">Functor (TxET e m)
a -&gt; TxET e m a
Functor (TxET e m)
-&gt; (forall a. a -&gt; TxET e m a)
-&gt; (forall a b. TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c)
-&gt; (forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m b)
-&gt; (forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m a)
-&gt; Applicative (TxET e m)
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
TxET e m a -&gt; TxET e m b -&gt; TxET e m a
TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
(a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c
forall a. a -&gt; TxET e m a
forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m a
forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m b
forall a b. TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c
forall e (m :: * -&gt; *). Monad m =&gt; Functor (TxET e m)
forall e (m :: * -&gt; *) a. Monad m =&gt; a -&gt; TxET e m a
forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m a
forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
forall e (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: TxET e m a -&gt; TxET e m b -&gt; TxET e m a
$c&lt;* :: forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m a
*&gt; :: TxET e m a -&gt; TxET e m b -&gt; TxET e m b
$c*&gt; :: forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
liftA2 :: (a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c
$cliftA2 :: forall e (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; TxET e m a -&gt; TxET e m b -&gt; TxET e m c
&lt;*&gt; :: TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
$c&lt;*&gt; :: forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m (a -&gt; b) -&gt; TxET e m a -&gt; TxET e m b
pure :: a -&gt; TxET e m a
$cpure :: forall e (m :: * -&gt; *) a. Monad m =&gt; a -&gt; TxET e m a
$cp1Applicative :: forall e (m :: * -&gt; *). Monad m =&gt; Functor (TxET e m)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050816"><span id="local-6989586621690050818"><span id="local-6989586621690050820"><span class="annot"><span class="annottext">Applicative (TxET e m)
a -&gt; TxET e m a
Applicative (TxET e m)
-&gt; (forall a b. TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b)
-&gt; (forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m b)
-&gt; (forall a. a -&gt; TxET e m a)
-&gt; Monad (TxET e m)
TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
forall a. a -&gt; TxET e m a
forall a b. TxET e m a -&gt; TxET e m b -&gt; TxET e m b
forall a b. TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b
forall e (m :: * -&gt; *). Monad m =&gt; Applicative (TxET e m)
forall e (m :: * -&gt; *) a. Monad m =&gt; a -&gt; TxET e m a
forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; TxET e m a
$creturn :: forall e (m :: * -&gt; *) a. Monad m =&gt; a -&gt; TxET e m a
&gt;&gt; :: TxET e m a -&gt; TxET e m b -&gt; TxET e m b
$c&gt;&gt; :: forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; TxET e m b -&gt; TxET e m b
&gt;&gt;= :: TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b
$c&gt;&gt;= :: forall e (m :: * -&gt; *) a b.
Monad m =&gt;
TxET e m a -&gt; (a -&gt; TxET e m b) -&gt; TxET e m b
$cp1Monad :: forall e (m :: * -&gt; *). Monad m =&gt; Applicative (TxET e m)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050810"><span id="local-6989586621690050812"><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690051008"><span class="hs-identifier hs-type">e</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050806"><span class="annot"><span class="annottext">Monad (TxET e m)
Monad (TxET e m)
-&gt; (forall a. IO a -&gt; TxET e m a) -&gt; MonadIO (TxET e m)
IO a -&gt; TxET e m a
forall a. IO a -&gt; TxET e m a
forall e (m :: * -&gt; *). MonadIO m =&gt; Monad (TxET e m)
forall e (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; TxET e m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; TxET e m a
$cliftIO :: forall e (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; TxET e m a
$cp1MonadIO :: forall e (m :: * -&gt; *). MonadIO m =&gt; Monad (TxET e m)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050798"><span id="local-6989586621690050800"><span id="local-6989586621690050802"><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690050794"><span class="annot"><span class="annottext">Monad (TxET e m)
Monad (TxET e m)
-&gt; (forall a. (a -&gt; TxET e m a) -&gt; TxET e m a)
-&gt; MonadFix (TxET e m)
(a -&gt; TxET e m a) -&gt; TxET e m a
forall a. (a -&gt; TxET e m a) -&gt; TxET e m a
forall e (m :: * -&gt; *). MonadFix m =&gt; Monad (TxET e m)
forall e (m :: * -&gt; *) a.
MonadFix m =&gt;
(a -&gt; TxET e m a) -&gt; TxET e m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. (a -&gt; m a) -&gt; m a) -&gt; MonadFix m
mfix :: (a -&gt; TxET e m a) -&gt; TxET e m a
$cmfix :: forall e (m :: * -&gt; *) a.
MonadFix m =&gt;
(a -&gt; TxET e m a) -&gt; TxET e m a
$cp1MonadFix :: forall e (m :: * -&gt; *). MonadFix m =&gt; Monad (TxET e m)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadFix</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621690050792"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050792"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621690050789"><span class="annot"><span class="annottext">lift :: m a -&gt; TxET e m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">lift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
forall e (m :: * -&gt; *) a.
ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-var">TxET</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT Connection (ExceptT e m) a -&gt; TxET e m a)
-&gt; (m a -&gt; ReaderT Connection (ExceptT e m) a) -&gt; m a -&gt; TxET e m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT e m a -&gt; ReaderT Connection (ExceptT e m) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT e m a -&gt; ReaderT Connection (ExceptT e m) a)
-&gt; (m a -&gt; ExceptT e m a)
-&gt; m a
-&gt; ReaderT Connection (ExceptT e m) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">m a -&gt; ExceptT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">lift</span></a></span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | The transaction command to run,</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- returning an MSSQLTxError or the result</span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="TxT"><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-var">TxT</span></a></span></span><span> </span><span id="local-6989586621690050786"><span class="annot"><a href="#local-6989586621690050786"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690050785"><span class="annot"><a href="#local-6989586621690050785"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050786"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050785"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621690050889"><span class="annot"><a href="Database.MSSQL.Transaction.html#beginTx"><span class="hs-identifier hs-type">beginTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050889"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050889"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-59"></span><span id="beginTx"><span class="annot"><span class="annottext">beginTx :: TxT m ()
</span><a href="Database.MSSQL.Transaction.html#beginTx"><span class="hs-identifier hs-var hs-var">beginTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Query -&gt; TxT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Query -&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier hs-var">unitQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;BEGIN TRANSACTION&quot;</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span id="local-6989586621690050783"><span class="annot"><a href="Database.MSSQL.Transaction.html#commitTx"><span class="hs-identifier hs-type">commitTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050783"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-63"></span><span id="commitTx"><span class="annot"><span class="annottext">commitTx :: TxT m ()
</span><a href="Database.MSSQL.Transaction.html#commitTx"><span class="hs-identifier hs-var hs-var">commitTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621690050781"><span class="annot"><span class="annottext">TransactionState
</span><a href="#local-6989586621690050781"><span class="hs-identifier hs-var">transactionState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxT m TransactionState
forall (m :: * -&gt; *). MonadIO m =&gt; TxT m TransactionState
</span><a href="Database.MSSQL.Transaction.html#getTransactionState"><span class="hs-identifier hs-var">getTransactionState</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TransactionState
</span><a href="#local-6989586621690050781"><span class="hs-identifier hs-var">transactionState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSActive"><span class="hs-identifier hs-var">TSActive</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query -&gt; TxT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Query -&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier hs-var">unitQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;COMMIT TRANSACTION&quot;</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSUncommittable"><span class="hs-identifier hs-var">TSUncommittable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; TxT m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; TxT m ()) -&gt; MSSQLTxError -&gt; TxT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; MSSQLTxError
</span><a href="Database.MSSQL.Transaction.html#MSSQLInternal"><span class="hs-identifier hs-var">MSSQLInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Transaction is uncommittable&quot;</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSNoActive"><span class="hs-identifier hs-var">TSNoActive</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; TxT m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; TxT m ()) -&gt; MSSQLTxError -&gt; TxT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; MSSQLTxError
</span><a href="Database.MSSQL.Transaction.html#MSSQLInternal"><span class="hs-identifier hs-var">MSSQLInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;No active transaction exist; cannot commit&quot;</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621690050776"><span class="annot"><a href="Database.MSSQL.Transaction.html#rollbackTx"><span class="hs-identifier hs-type">rollbackTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-71"></span><span id="rollbackTx"><span class="annot"><span class="annottext">rollbackTx :: TxT m ()
</span><a href="Database.MSSQL.Transaction.html#rollbackTx"><span class="hs-identifier hs-var hs-var">rollbackTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621690050774"><span class="annot"><span class="annottext">TransactionState
</span><a href="#local-6989586621690050774"><span class="hs-identifier hs-var">transactionState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxT m TransactionState
forall (m :: * -&gt; *). MonadIO m =&gt; TxT m TransactionState
</span><a href="Database.MSSQL.Transaction.html#getTransactionState"><span class="hs-identifier hs-var">getTransactionState</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690050773"><span class="annot"><span class="annottext">rollback :: TxT m ()
</span><a href="#local-6989586621690050773"><span class="hs-identifier hs-var hs-var">rollback</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query -&gt; TxT m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Query -&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier hs-var">unitQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;ROLLBACK TRANSACTION&quot;</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TransactionState
</span><a href="#local-6989586621690050774"><span class="hs-identifier hs-var">transactionState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSActive"><span class="hs-identifier hs-var">TSActive</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxT m ()
</span><a href="#local-6989586621690050773"><span class="hs-identifier hs-var">rollback</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSUncommittable"><span class="hs-identifier hs-var">TSUncommittable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">-- We can only do a full rollback of an uncommittable transaction</span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">TxT m ()
</span><a href="#local-6989586621690050773"><span class="hs-identifier hs-var">rollback</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSNoActive"><span class="hs-identifier hs-var">TSNoActive</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-comment">-- Few query exceptions result in an auto-rollback of the transaction.</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-comment">-- For eg. Creating a table with already existing table name (See https://github.com/hasura/graphql-engine-mono/issues/3046)</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- In such cases, we shouldn't rollback the transaction again.</span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><span class="annottext">() -&gt; TxT m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Useful for building transactions which returns no data</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- insertId :: TxT m ()</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- insertId = unitQuery &quot;INSERT INTO some_table VALUES (1, \&quot;hello\&quot;)&quot;</span><span>
</span><span id="line-89"></span><span id="local-6989586621690050999"><span class="annot"><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier hs-type">unitQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050999"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050999"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-90"></span><span id="unitQuery"><span class="annot"><span class="annottext">unitQuery :: Query -&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#unitQuery"><span class="hs-identifier hs-var hs-var">unitQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; MSSQLTxError) -&gt; Query -&gt; TxT m ()
forall (m :: * -&gt; *) e.
MonadIO m =&gt;
(MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m ()
</span><a href="Database.MSSQL.Transaction.html#unitQueryE"><span class="hs-identifier hs-var">unitQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError
forall a. a -&gt; a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Similar to @'unitQuery' but with an error modifier</span><span>
</span><span id="line-93"></span><span id="local-6989586621690050988"><span id="local-6989586621690050989"><span class="annot"><a href="Database.MSSQL.Transaction.html#unitQueryE"><span class="hs-identifier hs-type">unitQueryE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050989"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">-- | Error modifier</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050988"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">-- | Query to run</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050988"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050989"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-100"></span><span id="unitQueryE"><span class="annot"><span class="annottext">unitQueryE :: (MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m ()
</span><a href="Database.MSSQL.Transaction.html#unitQueryE"><span class="hs-identifier hs-var hs-var">unitQueryE</span></a></span></span><span> </span><span id="local-6989586621690050771"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050771"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String ()) -&gt; Query -&gt; TxET e m ()
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-var">rawQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050771"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String ()
</span><a href="#local-6989586621690050770"><span class="hs-identifier hs-var">emptyResult</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621690050770"><span class="hs-identifier hs-type">emptyResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621690050770"><span class="annot"><span class="annottext">emptyResult :: MSSQLResult -&gt; Either String ()
</span><a href="#local-6989586621690050770"><span class="hs-identifier hs-var hs-var">emptyResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either String ()
forall a b. b -&gt; Either a b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621690050770"><span class="hs-identifier hs-var">emptyResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="annot"><span class="annottext">[[Value]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expecting no data for ()&quot;</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Useful for building query transactions which returns only one row.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- returnOne :: TxT m Int</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- returnOne = singleRowQuery &quot;SELECT 1&quot;</span><span>
</span><span id="line-110"></span><span id="local-6989586621690050966"><span id="local-6989586621690050967"><span class="annot"><a href="Database.MSSQL.Transaction.html#singleRowQuery"><span class="hs-identifier hs-type">singleRowQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050967"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">FromRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050967"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050966"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-111"></span><span id="singleRowQuery"><span class="annot"><span class="annottext">singleRowQuery :: Query -&gt; TxT m a
</span><a href="Database.MSSQL.Transaction.html#singleRowQuery"><span class="hs-identifier hs-var hs-var">singleRowQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; MSSQLTxError) -&gt; Query -&gt; TxT m a
forall (m :: * -&gt; *) a e.
(MonadIO m, FromRow a) =&gt;
(MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#singleRowQueryE"><span class="hs-identifier hs-var">singleRowQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError
forall a. a -&gt; a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Similar to @'multiRowQuery' but with an error modifier</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Database.MSSQL.Transaction.html#singleRowQueryE"><span class="hs-identifier hs-type">singleRowQueryE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690050976"><span class="annot"><a href="#local-6989586621690050976"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690050975"><span class="annot"><a href="#local-6989586621690050975"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621690050973"><span class="annot"><a href="#local-6989586621690050973"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050976"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">FromRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050975"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">-- | Error modifier</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050973"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- | Query to run</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050973"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050976"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050975"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-122"></span><span id="singleRowQueryE"><span class="annot"><span class="annottext">singleRowQueryE :: (MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#singleRowQueryE"><span class="hs-identifier hs-var hs-var">singleRowQueryE</span></a></span></span><span> </span><span id="local-6989586621690050769"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050769"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-var">rawQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050769"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String a
</span><a href="#local-6989586621690050768"><span class="hs-identifier hs-var">singleRowResult</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621690050768"><span class="hs-identifier hs-type">singleRowResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050975"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621690050768"><span class="annot"><span class="annottext">singleRowResult :: MSSQLResult -&gt; Either String a
</span><a href="#local-6989586621690050768"><span class="hs-identifier hs-var hs-var">singleRowResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621690050767"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621690050767"><span class="hs-identifier hs-var">row</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Either String a
forall r. FromRow r =&gt; [Value] -&gt; Either String r
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-var">ODBC.fromRow</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621690050767"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621690050768"><span class="hs-identifier hs-var">singleRowResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="annot"><span class="annottext">[[Value]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expecting single row&quot;</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | The transaction state of the current connection</span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="TransactionState"><span class="annot"><a href="Database.MSSQL.Transaction.html#TransactionState"><span class="hs-identifier hs-var">TransactionState</span></a></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Has an active transaction.</span><span>
</span><span id="line-131"></span><span>    </span><span id="TSActive"><span class="annot"><a href="Database.MSSQL.Transaction.html#TSActive"><span class="hs-identifier hs-var">TSActive</span></a></span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Has no active transaction.</span><span>
</span><span id="line-133"></span><span>    </span><span id="TSNoActive"><span class="annot"><a href="Database.MSSQL.Transaction.html#TSNoActive"><span class="hs-identifier hs-var">TSNoActive</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | An error occurred that caused the transaction to be uncommittable. We cannot commit or</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- rollback to a savepoint; we can only do a full rollback of the transaction.</span><span>
</span><span id="line-136"></span><span>    </span><span id="TSUncommittable"><span class="annot"><a href="Database.MSSQL.Transaction.html#TSUncommittable"><span class="hs-identifier hs-var">TSUncommittable</span></a></span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Get the @'TransactionState' of current connection</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- For more details, refer to https://docs.microsoft.com/en-us/sql/t-sql/functions/xact-state-transact-sql?view=sql-server-ver15</span><span>
</span><span id="line-140"></span><span id="local-6989586621690050996"><span class="annot"><a href="Database.MSSQL.Transaction.html#getTransactionState"><span class="hs-identifier hs-type">getTransactionState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050996"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TransactionState"><span class="hs-identifier hs-type">TransactionState</span></a></span></span><span>
</span><span id="line-141"></span><span id="getTransactionState"><span class="annot"><span class="annottext">getTransactionState :: TxT m TransactionState
</span><a href="Database.MSSQL.Transaction.html#getTransactionState"><span class="hs-identifier hs-var hs-var">getTransactionState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690050765"><span class="annot"><span class="annottext">query :: Query
</span><a href="#local-6989586621690050765"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;SELECT XACT_STATE()&quot;</span></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621690050764"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621690050764"><span class="hs-identifier hs-var">xactState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query -&gt; TxT m Int
forall (m :: * -&gt; *) a. (MonadIO m, FromRow a) =&gt; Query -&gt; TxT m a
</span><a href="Database.MSSQL.Transaction.html#singleRowQuery"><span class="hs-identifier hs-var">singleRowQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050765"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621690050764"><span class="hs-identifier hs-var">xactState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TransactionState -&gt; TxT m TransactionState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSActive"><span class="hs-identifier hs-var">TSActive</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TransactionState -&gt; TxT m TransactionState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSNoActive"><span class="hs-identifier hs-var">TSNoActive</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TransactionState -&gt; TxT m TransactionState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">TransactionState
</span><a href="Database.MSSQL.Transaction.html#TSUncommittable"><span class="hs-identifier hs-var">TSUncommittable</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; TxT m TransactionState
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; TxT m TransactionState)
-&gt; MSSQLTxError -&gt; TxT m TransactionState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Query -&gt; ODBCException -&gt; MSSQLTxError
</span><a href="Database.MSSQL.Transaction.html#MSSQLQueryError"><span class="hs-identifier hs-var">MSSQLQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050765"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">(ODBCException -&gt; MSSQLTxError) -&gt; ODBCException -&gt; MSSQLTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ODBCException
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-var">ODBC.DataRetrievalError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected value for XACT_STATE&quot;</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Useful for building query transactions which returns multiple rows.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- selectIds :: TxT m [Int]</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- selectIds = multiRowQuery &quot;SELECT id FROM author&quot;</span><span>
</span><span id="line-154"></span><span id="local-6989586621690050761"><span id="local-6989586621690050762"><span class="annot"><a href="Database.MSSQL.Transaction.html#multiRowQuery"><span class="hs-identifier hs-type">multiRowQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050762"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">FromRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050762"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621690050761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-155"></span><span id="multiRowQuery"><span class="annot"><span class="annottext">multiRowQuery :: Query -&gt; TxT m [a]
</span><a href="Database.MSSQL.Transaction.html#multiRowQuery"><span class="hs-identifier hs-var hs-var">multiRowQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; MSSQLTxError) -&gt; Query -&gt; TxT m [a]
forall (m :: * -&gt; *) a e.
(MonadIO m, FromRow a) =&gt;
(MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m [a]
</span><a href="Database.MSSQL.Transaction.html#multiRowQueryE"><span class="hs-identifier hs-var">multiRowQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError
forall a. a -&gt; a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Similar to @'multiRowQuery' but with an error modifier</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Database.MSSQL.Transaction.html#multiRowQueryE"><span class="hs-identifier hs-type">multiRowQueryE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621690050962"><span class="annot"><a href="#local-6989586621690050962"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621690050961"><span class="annot"><a href="#local-6989586621690050961"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621690050960"><span class="annot"><a href="#local-6989586621690050960"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050962"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">FromRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050961"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- | Error modifier</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050960"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- | Query to run</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050960"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050962"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621690050961"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span id="multiRowQueryE"><span class="annot"><span class="annottext">multiRowQueryE :: (MSSQLTxError -&gt; e) -&gt; Query -&gt; TxET e m [a]
</span><a href="Database.MSSQL.Transaction.html#multiRowQueryE"><span class="hs-identifier hs-var hs-var">multiRowQueryE</span></a></span></span><span> </span><span id="local-6989586621690050760"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050760"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String [a]) -&gt; Query -&gt; TxET e m [a]
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-var">rawQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050760"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String [a]
</span><a href="#local-6989586621690050759"><span class="hs-identifier hs-var">multiRowResult</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621690050759"><span class="hs-identifier hs-type">multiRowResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621690050961"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621690050759"><span class="annot"><span class="annottext">multiRowResult :: MSSQLResult -&gt; Either String [a]
</span><a href="#local-6989586621690050759"><span class="hs-identifier hs-var hs-var">multiRowResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span id="local-6989586621690050758"><span class="annot"><span class="annottext">[[Value]]
</span><a href="#local-6989586621690050758"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Either String a) -&gt; [[Value]] -&gt; Either String [a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Either String a
forall r. FromRow r =&gt; [Value] -&gt; Either String r
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-var">ODBC.fromRow</span></a></span><span> </span><span class="annot"><span class="annottext">[[Value]]
</span><a href="#local-6989586621690050758"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Build a raw query transaction which on successful execution returns @'MSSQLResult'</span><span>
</span><span id="line-172"></span><span id="local-6989586621690050756"><span class="annot"><a href="Database.MSSQL.Transaction.html#rawQuery"><span class="hs-identifier hs-type">rawQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050756"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050756"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span></span><span>
</span><span id="line-173"></span><span id="rawQuery"><span class="annot"><span class="annottext">rawQuery :: Query -&gt; TxT m MSSQLResult
</span><a href="Database.MSSQL.Transaction.html#rawQuery"><span class="hs-identifier hs-var hs-var">rawQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; MSSQLTxError)
-&gt; (MSSQLResult -&gt; Either String MSSQLResult)
-&gt; Query
-&gt; TxT m MSSQLResult
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-var">rawQueryE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError
forall a. a -&gt; a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String MSSQLResult
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Similar to @'rawQuery' but with error modifier and @'MSSQLResult' modifier</span><span>
</span><span id="line-176"></span><span id="local-6989586621690050982"><span id="local-6989586621690050983"><span id="local-6989586621690050984"><span class="annot"><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-type">rawQueryE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050984"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- | Error modifier</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050983"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- | Result modifier with a failure</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050982"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- | Query to run</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050983"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050982"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-185"></span><span id="rawQueryE"><span class="annot"><span class="annottext">rawQueryE :: (MSSQLTxError -&gt; e)
-&gt; (MSSQLResult -&gt; Either String a) -&gt; Query -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#rawQueryE"><span class="hs-identifier hs-var hs-var">rawQueryE</span></a></span></span><span> </span><span id="local-6989586621690050755"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050755"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621690050754"><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String a
</span><a href="#local-6989586621690050754"><span class="hs-identifier hs-var">rf</span></a></span></span><span> </span><span id="local-6989586621690050753"><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050753"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
forall e (m :: * -&gt; *) a.
ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-var">TxET</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT Connection (ExceptT e m) a -&gt; TxET e m a)
-&gt; ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="annottext">(Connection -&gt; ExceptT e m a) -&gt; ReaderT Connection (ExceptT e m) a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">((Connection -&gt; ExceptT e m a)
 -&gt; ReaderT Connection (ExceptT e m) a)
-&gt; (Connection -&gt; ExceptT e m a)
-&gt; ReaderT Connection (ExceptT e m) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690050751"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050751"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">(forall a. IO a -&gt; m a) -&gt; ExceptT e IO a -&gt; ExceptT e m a
forall k (t :: (* -&gt; *) -&gt; k -&gt; *) (m :: * -&gt; *) (n :: * -&gt; *)
       (b :: k).
(MFunctor t, Monad m) =&gt;
(forall a. m a -&gt; n a) -&gt; t m b -&gt; t n b
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/mmorph-1.1.4-148be31b22abef1681b63320aaca23223828545ea87fb44e3a354db5218dc23a/share/doc/html/src"><span class="hs-identifier hs-var">hoist</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT e IO a -&gt; ExceptT e m a)
-&gt; ExceptT e IO a -&gt; ExceptT e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e) -&gt; ExceptT MSSQLTxError IO a -&gt; ExceptT e IO a
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050755"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MSSQLTxError IO a -&gt; ExceptT e IO a)
-&gt; ExceptT MSSQLTxError IO a -&gt; ExceptT e IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; ExceptT MSSQLTxError IO MSSQLResult
forall (m :: * -&gt; *).
MonadIO m =&gt;
Connection -&gt; Query -&gt; ExceptT MSSQLTxError m MSSQLResult
</span><a href="Database.MSSQL.Transaction.html#execQuery"><span class="hs-identifier hs-var">execQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050751"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050753"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">ExceptT MSSQLTxError IO MSSQLResult
-&gt; (MSSQLResult -&gt; ExceptT MSSQLTxError IO a)
-&gt; ExceptT MSSQLTxError IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either MSSQLTxError a -&gt; ExceptT MSSQLTxError IO a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either MSSQLTxError a -&gt; ExceptT MSSQLTxError IO a)
-&gt; (MSSQLResult -&gt; Either MSSQLTxError a)
-&gt; MSSQLResult
-&gt; ExceptT MSSQLTxError IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; MSSQLTxError)
-&gt; Either String a -&gt; Either MSSQLTxError a
forall e1 e2 a. (e1 -&gt; e2) -&gt; Either e1 a -&gt; Either e2 a
</span><a href="Hasura.Prelude.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query -&gt; ODBCException -&gt; MSSQLTxError
</span><a href="Database.MSSQL.Transaction.html#MSSQLQueryError"><span class="hs-identifier hs-var">MSSQLQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050753"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(ODBCException -&gt; MSSQLTxError)
-&gt; (String -&gt; ODBCException) -&gt; String -&gt; MSSQLTxError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ODBCException
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-var">ODBC.DataRetrievalError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; Either MSSQLTxError a)
-&gt; (MSSQLResult -&gt; Either String a)
-&gt; MSSQLResult
-&gt; Either MSSQLTxError a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLResult -&gt; Either String a
</span><a href="#local-6989586621690050754"><span class="hs-identifier hs-var">rf</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Build a generic transaction out of an IO action</span><span>
</span><span id="line-193"></span><span id="local-6989586621690050746"><span id="local-6989586621690050747"><span id="local-6989586621690050748"><span class="annot"><a href="Database.MSSQL.Transaction.html#buildGenericTxE"><span class="hs-identifier hs-type">buildGenericTxE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050748"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">-- | Exception modifier</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.ODBCException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050747"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- | IO action</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050746"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050747"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050748"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050746"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-200"></span><span id="buildGenericTxE"><span class="annot"><span class="annottext">buildGenericTxE :: (ODBCException -&gt; e) -&gt; (Connection -&gt; IO a) -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#buildGenericTxE"><span class="hs-identifier hs-var hs-var">buildGenericTxE</span></a></span></span><span> </span><span id="local-6989586621690050745"><span class="annot"><span class="annottext">ODBCException -&gt; e
</span><a href="#local-6989586621690050745"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621690050744"><span class="annot"><span class="annottext">Connection -&gt; IO a
</span><a href="#local-6989586621690050744"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
forall e (m :: * -&gt; *) a.
ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
</span><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-var">TxET</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT Connection (ExceptT e m) a -&gt; TxET e m a)
-&gt; ReaderT Connection (ExceptT e m) a -&gt; TxET e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">(Connection -&gt; ExceptT e m a) -&gt; ReaderT Connection (ExceptT e m) a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">((Connection -&gt; ExceptT e m a)
 -&gt; ReaderT Connection (ExceptT e m) a)
-&gt; (Connection -&gt; ExceptT e m a)
-&gt; ReaderT Connection (ExceptT e m) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690050743"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050743"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621690050742"><span class="annot"><span class="annottext">Either ODBCException a
</span><a href="#local-6989586621690050742"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either ODBCException a) -&gt; ExceptT e m (Either ODBCException a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either ODBCException a)
 -&gt; ExceptT e m (Either ODBCException a))
-&gt; IO (Either ODBCException a)
-&gt; ExceptT e m (Either ODBCException a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either ODBCException a)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO (Either ODBCException a))
-&gt; IO a -&gt; IO (Either ODBCException a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO a
</span><a href="#local-6989586621690050744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050743"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">(ODBCException -&gt; e) -&gt; ExceptT ODBCException m a -&gt; ExceptT e m a
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">ODBCException -&gt; e
</span><a href="#local-6989586621690050745"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT ODBCException m a -&gt; ExceptT e m a)
-&gt; ExceptT ODBCException m a -&gt; ExceptT e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either ODBCException a -&gt; ExceptT ODBCException m a
forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; ExceptT e m a
</span><a href="Hasura.Prelude.html#hoistEither"><span class="hs-identifier hs-var">hoistEither</span></a></span><span> </span><span class="annot"><span class="annottext">Either ODBCException a
</span><a href="#local-6989586621690050742"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621690050934"><span class="annot"><a href="Database.MSSQL.Transaction.html#execQuery"><span class="hs-identifier hs-type">execQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050934"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050934"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-type">MSSQLResult</span></a></span></span><span>
</span><span id="line-210"></span><span id="execQuery"><span class="annot"><span class="annottext">execQuery :: Connection -&gt; Query -&gt; ExceptT MSSQLTxError m MSSQLResult
</span><a href="Database.MSSQL.Transaction.html#execQuery"><span class="hs-identifier hs-var hs-var">execQuery</span></a></span></span><span> </span><span id="local-6989586621690050741"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050741"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621690050740"><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050740"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621690050739"><span class="annot"><span class="annottext">Either ODBCException [[Value]]
</span><a href="#local-6989586621690050739"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.ODBCException</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Value</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either ODBCException [[Value]])
-&gt; ExceptT MSSQLTxError m (Either ODBCException [[Value]])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either ODBCException [[Value]])
 -&gt; ExceptT MSSQLTxError m (Either ODBCException [[Value]]))
-&gt; IO (Either ODBCException [[Value]])
-&gt; ExceptT MSSQLTxError m (Either ODBCException [[Value]])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO [[Value]] -&gt; IO (Either ODBCException [[Value]])
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [[Value]] -&gt; IO (Either ODBCException [[Value]]))
-&gt; IO [[Value]] -&gt; IO (Either ODBCException [[Value]])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO [[Value]]
forall (m :: * -&gt; *) row.
(MonadIO m, FromRow row) =&gt;
Connection -&gt; Query -&gt; m [row]
</span><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-var">ODBC.query</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050741"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050740"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">(ODBCException -&gt; MSSQLTxError)
-&gt; ExceptT ODBCException m MSSQLResult
-&gt; ExceptT MSSQLTxError m MSSQLResult
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query -&gt; ODBCException -&gt; MSSQLTxError
</span><a href="Database.MSSQL.Transaction.html#MSSQLQueryError"><span class="hs-identifier hs-var">MSSQLQueryError</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621690050740"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExceptT ODBCException m MSSQLResult
 -&gt; ExceptT MSSQLTxError m MSSQLResult)
-&gt; ExceptT ODBCException m MSSQLResult
-&gt; ExceptT MSSQLTxError m MSSQLResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either ODBCException MSSQLResult
-&gt; ExceptT ODBCException m MSSQLResult
forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; ExceptT e m a
</span><a href="Hasura.Prelude.html#hoistEither"><span class="hs-identifier hs-var">hoistEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ODBCException MSSQLResult
 -&gt; ExceptT ODBCException m MSSQLResult)
-&gt; Either ODBCException MSSQLResult
-&gt; ExceptT ODBCException m MSSQLResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[Value]] -&gt; MSSQLResult
</span><a href="Database.MSSQL.Transaction.html#MSSQLResult"><span class="hs-identifier hs-var">MSSQLResult</span></a></span><span> </span><span class="annot"><span class="annottext">([[Value]] -&gt; MSSQLResult)
-&gt; Either ODBCException [[Value]]
-&gt; Either ODBCException MSSQLResult
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either ODBCException [[Value]]
</span><a href="#local-6989586621690050739"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Run a command on the given connection wrapped in a transaction.</span><span>
</span><span id="line-215"></span><span id="local-6989586621690050735"><span id="local-6989586621690050736"><span class="annot"><a href="Database.MSSQL.Transaction.html#runTx"><span class="hs-identifier hs-type">runTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxT"><span class="hs-identifier hs-type">TxT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050735"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050735"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-220"></span><span id="runTx"><span class="annot"><span class="annottext">runTx :: TxT m a -&gt; Connection -&gt; ExceptT MSSQLTxError m a
</span><a href="Database.MSSQL.Transaction.html#runTx"><span class="hs-identifier hs-var hs-var">runTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; MSSQLTxError)
-&gt; TxT m a -&gt; Connection -&gt; ExceptT MSSQLTxError m a
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e) -&gt; TxET e m a -&gt; Connection -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#runTxE"><span class="hs-identifier hs-var">runTxE</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; MSSQLTxError
forall a. a -&gt; a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Run a command on the given connection wrapped in a transaction.</span><span>
</span><span id="line-223"></span><span id="local-6989586621690050908"><span id="local-6989586621690050909"><span id="local-6989586621690050910"><span class="annot"><a href="Database.MSSQL.Transaction.html#runTxE"><span class="hs-identifier hs-type">runTxE</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050910"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050909"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050909"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050910"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050908"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050909"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050910"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050908"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-229"></span><span id="runTxE"><span class="annot"><span class="annottext">runTxE :: (MSSQLTxError -&gt; e) -&gt; TxET e m a -&gt; Connection -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#runTxE"><span class="hs-identifier hs-var hs-var">runTxE</span></a></span></span><span> </span><span id="local-6989586621690050734"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050734"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621690050733"><span class="annot"><span class="annottext">TxET e m a
</span><a href="#local-6989586621690050733"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e)
-&gt; (Connection -&gt; ExceptT e m a) -&gt; Connection -&gt; ExceptT e m a
forall (m :: * -&gt; *) e a.
MonadIO m =&gt;
(MSSQLTxError -&gt; e)
-&gt; (Connection -&gt; ExceptT e m a) -&gt; Connection -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#asTransaction"><span class="hs-identifier hs-var">asTransaction</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050734"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; TxET e m a -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a. Connection -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-operator hs-var">`execTx`</span></a></span><span> </span><span class="annot"><span class="annottext">TxET e m a
</span><a href="#local-6989586621690050733"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-pragma hs-type">execTx</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-233"></span><span id="local-6989586621690050899"><span id="local-6989586621690050900"><span id="local-6989586621690050901"><span class="annot"><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-identifier hs-type">execTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.MSSQL.Transaction.html#TxET"><span class="hs-identifier hs-type">TxET</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050901"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050901"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050899"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-234"></span><span id="execTx"><span class="annot"><span class="annottext">execTx :: Connection -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-identifier hs-var hs-var">execTx</span></a></span></span><span> </span><span id="local-6989586621690050730"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050730"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621690050729"><span class="annot"><span class="annottext">TxET e m a
</span><a href="#local-6989586621690050729"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT Connection (ExceptT e m) a -&gt; Connection -&gt; ExceptT e m a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxET e m a -&gt; ReaderT Connection (ExceptT e m) a
forall e (m :: * -&gt; *) a.
TxET e m a -&gt; ReaderT Connection (ExceptT e m) a
</span><a href="Database.MSSQL.Transaction.html#txHandler"><span class="hs-identifier hs-var hs-var">txHandler</span></a></span><span> </span><span class="annot"><span class="annottext">TxET e m a
</span><a href="#local-6989586621690050729"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050730"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span id="local-6989586621690050902"><span id="local-6989586621690050903"><span id="local-6989586621690050904"><span class="annot"><a href="Database.MSSQL.Transaction.html#asTransaction"><span class="hs-identifier hs-type">asTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050904"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Database.MSSQL.Transaction.html#MSSQLTxError"><span class="hs-identifier hs-type">MSSQLTxError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690050903"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050903"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050904"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050902"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.cabal/store/ghc-8.10.7/odbc-0.2.3-ac6924f5fc8a344c319de9b98b44a8c2b9c2f3d701cf9251194910decf9397e3/share/doc/html/src"><span class="hs-identifier hs-type">ODBC.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050903"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050904"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690050902"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-242"></span><span id="asTransaction"><span class="annot"><span class="annottext">asTransaction :: (MSSQLTxError -&gt; e)
-&gt; (Connection -&gt; ExceptT e m a) -&gt; Connection -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#asTransaction"><span class="hs-identifier hs-var hs-var">asTransaction</span></a></span></span><span> </span><span id="local-6989586621690050727"><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050727"><span class="hs-identifier hs-var">ef</span></a></span></span><span> </span><span id="local-6989586621690050726"><span class="annot"><span class="annottext">Connection -&gt; ExceptT e m a
</span><a href="#local-6989586621690050726"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621690050725"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050725"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- Begin the transaction. If there is an err, do not rollback</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e) -&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050727"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MSSQLTxError m () -&gt; ExceptT e m ())
-&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; TxET MSSQLTxError m () -&gt; ExceptT MSSQLTxError m ()
forall e (m :: * -&gt; *) a. Connection -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-identifier hs-var">execTx</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050725"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">TxET MSSQLTxError m ()
forall (m :: * -&gt; *). MonadIO m =&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#beginTx"><span class="hs-identifier hs-var">beginTx</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- Run the transaction and commit. If there is an err, rollback</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">(ExceptT e m a -&gt; (e -&gt; ExceptT e m a) -&gt; ExceptT e m a)
-&gt; (e -&gt; ExceptT e m a) -&gt; ExceptT e m a -&gt; ExceptT e m a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT e m a -&gt; (e -&gt; ExceptT e m a) -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">catchError</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; ExceptT e m a
</span><a href="#local-6989586621690050723"><span class="hs-identifier hs-var">rollback</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT e m a -&gt; ExceptT e m a) -&gt; ExceptT e m a -&gt; ExceptT e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621690050722"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690050722"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ExceptT e m a
</span><a href="#local-6989586621690050726"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050725"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e) -&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050727"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MSSQLTxError m () -&gt; ExceptT e m ())
-&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; TxET MSSQLTxError m () -&gt; ExceptT MSSQLTxError m ()
forall e (m :: * -&gt; *) a. Connection -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-identifier hs-var">execTx</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050725"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">TxET MSSQLTxError m ()
forall (m :: * -&gt; *). MonadIO m =&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#commitTx"><span class="hs-identifier hs-var">commitTx</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; ExceptT e m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621690050722"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621690050723"><span class="annot"><span class="annottext">rollback :: e -&gt; ExceptT e m a
</span><a href="#local-6989586621690050723"><span class="hs-identifier hs-var hs-var">rollback</span></a></span></span><span> </span><span id="local-6989586621690050721"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621690050721"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">(MSSQLTxError -&gt; e) -&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">MSSQLTxError -&gt; e
</span><a href="#local-6989586621690050727"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MSSQLTxError m () -&gt; ExceptT e m ())
-&gt; ExceptT MSSQLTxError m () -&gt; ExceptT e m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; TxET MSSQLTxError m () -&gt; ExceptT MSSQLTxError m ()
forall e (m :: * -&gt; *) a. Connection -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="Database.MSSQL.Transaction.html#execTx"><span class="hs-identifier hs-var">execTx</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621690050725"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">TxET MSSQLTxError m ()
forall (m :: * -&gt; *). MonadIO m =&gt; TxT m ()
</span><a href="Database.MSSQL.Transaction.html#rollbackTx"><span class="hs-identifier hs-var">rollbackTx</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">e -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///home/nicuveo/.ghcup/ghc/8.10.7/share/doc/ghc-8.10.7/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621690050721"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-254"></span></pre></body></html>