<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- This prevents hlint errors on the &quot;pattern&quot; lens.</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NoPatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      : Hasura.Server.OpenAPI</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Description : Builds an OpenAPI specification for the REST endpoints from a SchemaCache via the `declareOpenApiSpec` function.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- The implementation currently iterates over the endpoints building up `EndpointData` for each then exposes this as an OpenAPI Schema.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Most functions are in the `Declare` monad so that they can add new component definitions on the fly that can be referenced.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--   This is especially useful for the params and request body documentation.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- The response body recurses over the SelectionSet Fields associated with an endpoint and looks up types by name in</span><span>
</span><span id="line-15"></span><span class="hs-comment">--   a `SchemaIntrospection` result generated from the `SchemaCache`.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Response bodies are mostly delcared inline, since the associated query will likely be unique and determine the fields</span><span>
</span><span id="line-18"></span><span class="hs-comment">--   contained in the response.</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Server.OpenAPI</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#serveJSON"><span class="hs-identifier">serveJSON</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OMap</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.HashMap.Strict.Multi.html"><span class="hs-identifier">Data.HashMap.Strict.Multi</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MMap</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.OpenApi</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.OpenApi.Declare</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.NonEmpty.html"><span class="hs-identifier">Data.Text.NonEmpty</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Trie.html"><span class="hs-identifier">Data.Trie</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trie</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html"><span class="hs-identifier">Hasura.GraphQL.Analyse</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html"><span class="hs-identifier">Hasura.GraphQL.Transport.HTTP.Protocol</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html"><span class="hs-identifier">Hasura.RQL.Types.Endpoint</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html"><span class="hs-identifier">Hasura.RQL.Types.QueryCollection</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier">FieldInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Media.MediaType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(//)</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">data</span><span> </span><span id="EndpointData"><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-var">EndpointData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EndpointData"><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-var">EndpointData</span></a></span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_edUrl"><span class="annot"><span class="annottext">EndpointData -&gt; String
</span><a href="Hasura.Server.OpenAPI.html#_edUrl"><span class="hs-identifier hs-var hs-var">_edUrl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span id="_edMethod"><span class="annot"><span class="annottext">EndpointData -&gt; HashSet EndpointMethod
</span><a href="Hasura.Server.OpenAPI.html#_edMethod"><span class="hs-identifier hs-var hs-var">_edMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span id="_edVarList"><span class="annot"><span class="annottext">EndpointData -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#_edVarList"><span class="hs-identifier hs-var hs-var">_edVarList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Param</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span id="_edProperties"><span class="annot"><span class="annottext">EndpointData -&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#_edProperties"><span class="hs-identifier hs-var hs-var">_edProperties</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InsOrdHashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span id="_edResponse"><span class="annot"><span class="annottext">EndpointData -&gt; HashMap EndpointMethod Response
</span><a href="Hasura.Server.OpenAPI.html#_edResponse"><span class="hs-identifier hs-var hs-var">_edResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span id="_edDescription"><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edDescription"><span class="hs-identifier hs-var hs-var">_edDescription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- contains API comments and graphql query</span><span>
</span><span id="line-50"></span><span>    </span><span id="_edName"><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edName"><span class="hs-identifier hs-var hs-var">_edName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span id="_edErrs"><span class="annot"><span class="annottext">EndpointData -&gt; [Text]
</span><a href="Hasura.Server.OpenAPI.html#_edErrs"><span class="hs-identifier hs-var hs-var">_edErrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170808"><span id="local-6989586621689170810"><span id="local-6989586621689170812"><span class="annot"><span class="annottext">Int -&gt; EndpointData -&gt; ShowS
[EndpointData] -&gt; ShowS
EndpointData -&gt; String
(Int -&gt; EndpointData -&gt; ShowS)
-&gt; (EndpointData -&gt; String)
-&gt; ([EndpointData] -&gt; ShowS)
-&gt; Show EndpointData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EndpointData] -&gt; ShowS
$cshowList :: [EndpointData] -&gt; ShowS
show :: EndpointData -&gt; String
$cshow :: EndpointData -&gt; String
showsPrec :: Int -&gt; EndpointData -&gt; ShowS
$cshowsPrec :: Int -&gt; EndpointData -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | @DeclareErr@ is just a @ExceptT@ monad with the added capabilities of @Declare@ monad</span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="DeclareErr"><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareErr"><span class="hs-identifier hs-var">DeclareErr</span></a></span></span><span> </span><span id="local-6989586621689170806"><span class="annot"><a href="#local-6989586621689170806"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="annot"><a href="#local-6989586621689170806"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- * Response Body Related Functions.</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">{-

Example stepthrough initiated by call to getSelectionSchema:

  * Endpoint insert_foo
  * getExecutableDefinitions -&gt; List (Normally 1 entry)
  * ExecutableDefinitionOperation -&gt; OperationDefinitionTyped -&gt; TypedOperationDefinition (_todType = OperationTypeMutation)
  * _todSelectionSet -&gt;
    [SelectionField
      (Field{ _fName = Name{unName = &quot;insert_foo&quot;},
            _fSelectionSet
              = [SelectionField
                  (Field{ _fName = Name{unName = &quot;returning&quot;},
                        _fSelectionSet
                          = [..., SelectionField
                              (Field{ _fName = Name{unName = &quot;id&quot;},
                                    _fSelectionSet = []}),
  * Lookup introspection schema, Under mutation_root (inferred from operationtype = OperationTypeMutation)
    SchemaIntrospection
    (fromList
        [..., (Name{unName = &quot;mutation_root&quot;},
          TypeDefinitionObject
            (ObjectTypeDefinition{_otdDescription =
                                    Just (Description{unDescription = &quot;mutation root&quot;}),
                                  _otdName = Name{unName = &quot;mutation_root&quot;},
                                  _otdImplementsInterfaces = [], _otdDirectives = [],
                                  _otdFieldsDefinition =
                                    [..., FieldDefinition{_fldDescription = Just (Description{unDescription = &quot;insert data into the table: \&quot;foo\&quot;&quot;}),
                                                    _fldName = Name{unName = &quot;insert_foo&quot;},
                                                    _fldType = TypeNamed (Nullability{unNullability = True}) (Name{unName = &quot;foo_mutation_response&quot;}),
  * Find that type for insert_foo field in mutation_root is named type &quot;foo_mutation_response&quot;
  * Look up &quot;foo_mutation_response&quot; in introspection schema:
        (Name{unName = &quot;foo_mutation_response&quot;},
          TypeDefinitionObject
            (ObjectTypeDefinition{_otdDescription = Just (Description{unDescription = &quot;response of any mutation on the table \&quot;foo\&quot;&quot;}),
                                  _otdName = Name{unName = &quot;foo_mutation_response&quot;},
                                  _otdFieldsDefinition =
                                    [..., FieldDefinition{_fldDescription =
                                                      Just
                                                        (Description{unDescription =
                                                                        &quot;data from the rows affected by the mutation&quot;}),
                                                    _fldName = Name{unName = &quot;returning&quot;},
                                                    _fldArgumentsDefinition = [],
                                                    _fldType =
                                                      TypeList (Nullability{unNullability = False})
                                                        (TypeNamed
                                                            (Nullability{unNullability = False})
                                                            (Name{unName = &quot;foo&quot;})),
                                                    _fldDirectives = []}]})),
  * Find first referenced sub-field &quot;returning&quot;
  * It has type (TypeNamed (Name{unName = &quot;foo&quot;})),
  * Look up &quot;foo&quot; in Introspection Schema: ...,
        (Name{unName = &quot;foo&quot;},
          TypeDefinitionObject
            (ObjectTypeDefinition{_otdDescription = Just (Description{unDescription = &quot;columns and relationships of \&quot;foo\&quot;&quot;}),
                                  _otdName = Name{unName = &quot;foo&quot;}, _otdImplementsInterfaces = [],
                                  _otdFieldsDefinition =
                                    [ ..., FieldDefinition{_fldDescription = Nothing,
                                                    _fldName = Name{unName = &quot;id&quot;},
                                                    _fldType = TypeNamed (Nullability{unNullability = False}) (Name{unName = &quot;uuid&quot;}),
  * Lookup first sub-sub field by SelectionSet field name &quot;id&quot;
  * See that it has type: TypeNamed (Name{unName = &quot;uuid&quot;})
  * See that there are no sub-sub-sub fields
  * declare type uuid by looking up its definition
        (Name{unName = &quot;uuid&quot;},
        TypeDefinitionScalar
          (ScalarTypeDefinition{_stdDescription = Nothing,
                                _stdName = Name{unName = &quot;uuid&quot;}, _stdDirectives = []})),
  * reference type name from components in output

  ... Proceed with other sub-fields and fields

-}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- FIXME: There should only be one definition associated. Find a way to signal an error here otherwise.</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mdDefinitions"><span class="hs-identifier hs-type">mdDefinitions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.ExecutableDefinition</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span id="mdDefinitions"><span class="annot"><span class="annottext">mdDefinitions :: EndpointMetadata GQLQueryWithText -&gt; [ExecutableDefinition Name]
</span><a href="Hasura.Server.OpenAPI.html#mdDefinitions"><span class="hs-identifier hs-var hs-var">mdDefinitions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecutableDocument Name -&gt; [ExecutableDefinition Name]
forall var. ExecutableDocument var -&gt; [ExecutableDefinition var]
</span><span class="hs-identifier hs-var hs-var">G.getExecutableDefinitions</span></span><span> </span><span class="annot"><span class="annottext">(ExecutableDocument Name -&gt; [ExecutableDefinition Name])
-&gt; (EndpointMetadata GQLQueryWithText -&gt; ExecutableDocument Name)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; [ExecutableDefinition Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GQLQuery -&gt; ExecutableDocument Name
</span><a href="Hasura.RQL.Types.QueryCollection.html#unGQLQuery"><span class="hs-identifier hs-var hs-var">unGQLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(GQLQuery -&gt; ExecutableDocument Name)
-&gt; (EndpointMetadata GQLQueryWithText -&gt; GQLQuery)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; ExecutableDocument Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GQLQueryWithText -&gt; GQLQuery
</span><a href="Hasura.RQL.Types.QueryCollection.html#getGQLQuery"><span class="hs-identifier hs-var">getGQLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(GQLQueryWithText -&gt; GQLQuery)
-&gt; (EndpointMetadata GQLQueryWithText -&gt; GQLQueryWithText)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; GQLQuery
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointDef GQLQueryWithText -&gt; GQLQueryWithText
forall query. EndpointDef query -&gt; query
</span><a href="Hasura.RQL.Types.Endpoint.html#_edQuery"><span class="hs-identifier hs-var hs-var">_edQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointDef GQLQueryWithText -&gt; GQLQueryWithText)
-&gt; (EndpointMetadata GQLQueryWithText
    -&gt; EndpointDef GQLQueryWithText)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; GQLQueryWithText
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; EndpointDef GQLQueryWithText
forall query. EndpointMetadata query -&gt; EndpointDef query
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceDefinition"><span class="hs-identifier hs-var hs-var">_ceDefinition</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mkResponse"><span class="hs-identifier hs-type">mkResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="mkResponse"><span class="annot"><span class="annottext">mkResponse :: Structure
-&gt; EndpointMethod
-&gt; String
-&gt; Declare (Definitions Schema) (Maybe Response)
</span><a href="Hasura.Server.OpenAPI.html#mkResponse"><span class="hs-identifier hs-var hs-var">mkResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span id="local-6989586621689170795"><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621689170795"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621689170794"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170794"><span class="hs-identifier hs-var">epMethod</span></a></span></span><span> </span><span id="local-6989586621689170793"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621689170793"><span class="hs-identifier hs-var">epUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621689170792"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170792"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)] -&gt; Declare (Definitions Schema) Schema
</span><a href="Hasura.Server.OpenAPI.html#getSelectionSchema"><span class="hs-identifier hs-var">getSelectionSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Name FieldInfo -&gt; [(Name, FieldInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621689170795"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">Maybe Response -&gt; Declare (Definitions Schema) (Maybe Response)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Response -&gt; Declare (Definitions Schema) (Maybe Response))
-&gt; Maybe Response -&gt; Declare (Definitions Schema) (Maybe Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Response -&gt; Maybe Response
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; Maybe Response) -&gt; Response -&gt; Maybe Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><span class="annottext">Response
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">Response -&gt; (Response -&gt; Response) -&gt; Response
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap MediaType MediaTypeObject
 -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
-&gt; Response -&gt; Identity Response
forall s a. HasContent s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">content</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap MediaType MediaTypeObject
  -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
 -&gt; Response -&gt; Identity Response)
-&gt; InsOrdHashMap MediaType MediaTypeObject -&gt; Response -&gt; Response
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">MediaType
-&gt; MediaTypeObject -&gt; InsOrdHashMap MediaType MediaTypeObject
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; MediaType
</span><span class="hs-operator hs-var">//</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;json&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MediaTypeObject
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">MediaTypeObject
-&gt; (MediaTypeObject -&gt; MediaTypeObject) -&gt; MediaTypeObject
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; MediaTypeObject -&gt; Identity MediaTypeObject
forall s a. HasSchema s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">schema</span></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; MediaTypeObject -&gt; Identity MediaTypeObject)
-&gt; Referenced Schema -&gt; MediaTypeObject -&gt; MediaTypeObject
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170792"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">Response -&gt; (Response -&gt; Response) -&gt; Response
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Identity Text) -&gt; Response -&gt; Identity Response
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Identity Text) -&gt; Response -&gt; Identity Response)
-&gt; Text -&gt; Response -&gt; Response
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Responses for &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Hasura.Prelude.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170794"><span class="hs-identifier hs-var">epMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621689170793"><span class="hs-identifier hs-var">epUrl</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getSelectionSchema"><span class="hs-identifier hs-type">getSelectionSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span>
</span><span id="line-154"></span><span id="getSelectionSchema"><span class="annot"><span class="annottext">getSelectionSchema :: [(Name, FieldInfo)] -&gt; Declare (Definitions Schema) Schema
</span><a href="Hasura.Server.OpenAPI.html#getSelectionSchema"><span class="hs-identifier hs-var hs-var">getSelectionSchema</span></a></span></span><span> </span><span id="local-6989586621689170779"><span class="annot"><span class="annottext">[(Name, FieldInfo)]
</span><a href="#local-6989586621689170779"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621689170778"><span class="annot"><span class="annottext">[(Text, Schema)]
</span><a href="#local-6989586621689170778"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)]
-&gt; ((Name, FieldInfo)
    -&gt; DeclareT (Definitions Schema) Identity (Text, Schema))
-&gt; DeclareT (Definitions Schema) Identity [(Text, Schema)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)]
</span><a href="#local-6989586621689170779"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621689170776"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170776"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170775"><span class="annot"><span class="annottext">FieldInfo
</span><a href="#local-6989586621689170775"><span class="hs-identifier hs-var">fieldInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621689170774"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170774"><span class="hs-identifier hs-var">fieldSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FieldInfo -&gt; Declare (Definitions Schema) Schema
</span><a href="Hasura.Server.OpenAPI.html#getDefinitionSchema"><span class="hs-identifier hs-var">getDefinitionSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170776"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfo
</span><a href="#local-6989586621689170775"><span class="hs-identifier hs-var">fieldInfo</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">(Text, Schema)
-&gt; DeclareT (Definitions Schema) Identity (Text, Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170776"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170774"><span class="hs-identifier hs-var">fieldSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap Text (Referenced Schema)
 -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
-&gt; Schema -&gt; Identity Schema
forall s a. HasProperties s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">properties</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap Text (Referenced Schema)
  -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
 -&gt; Schema -&gt; Identity Schema)
-&gt; InsOrdHashMap Text (Referenced Schema) -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Referenced Schema)
-&gt; Definitions Schema -&gt; InsOrdHashMap Text (Referenced Schema)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Schema)] -&gt; Definitions Schema
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Schema)]
</span><a href="#local-6989586621689170778"><span class="hs-identifier hs-var">props</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getDefinitionSchema"><span class="hs-identifier hs-type">getDefinitionSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span>
</span><span id="line-164"></span><span id="getDefinitionSchema"><span class="annot"><span class="annottext">getDefinitionSchema :: Name -&gt; FieldInfo -&gt; Declare (Definitions Schema) Schema
</span><a href="Hasura.Server.OpenAPI.html#getDefinitionSchema"><span class="hs-identifier hs-var hs-var">getDefinitionSchema</span></a></span></span><span> </span><span id="local-6989586621689170769"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170769"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170765"><span id="local-6989586621689170766"><span id="local-6989586621689170767"><span class="annot"><span class="annottext">Maybe Selection
GType
TypeDefinition [Name] InputValueDefinition
_fiSelection :: FieldInfo -&gt; Maybe Selection
_fiTypeDefinition :: FieldInfo -&gt; TypeDefinition [Name] InputValueDefinition
_fiType :: FieldInfo -&gt; GType
_fiSelection :: Maybe Selection
_fiTypeDefinition :: TypeDefinition [Name] InputValueDefinition
_fiType :: GType
</span><a href="Hasura.GraphQL.Analyse.html#_fiSelection"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170767"><span class="hs-identifier hs-var">_fiType</span></a></span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (GType -&gt; Declare (Definitions Schema) Schema)
-&gt; Declare (Definitions Schema) Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Declare (Definitions Schema) Schema)
-&gt; GType -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170761"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621689170760"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
</span><a href="#local-6989586621689170766"><span class="hs-identifier hs-var">_fiTypeDefinition</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInterface</span></span><span> </span><span class="annot"><span class="annottext">InterfaceTypeDefinition [Name] InputValueDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span>
</span><span id="line-169"></span><span>          </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unsupported type interface &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; for field &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170769"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionUnion</span></span><span> </span><span class="annot"><span class="annottext">UnionTypeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unsupported type union: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; for field &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170769"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionEnum</span></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unsupported type enum: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; for field &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170769"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInputObject</span></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span>
</span><span id="line-181"></span><span>          </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Internal error! Input type &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; in output selection set for field &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170769"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionObject</span></span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition InputValueDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Selection
</span><a href="#local-6989586621689170765"><span class="hs-identifier hs-var">_fiSelection</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Maybe Selection
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Missing selection for object type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span id="local-6989586621689170754"><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621689170754"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>          </span><span id="local-6989586621689170753"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170753"><span class="hs-identifier hs-var">objectSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)] -&gt; Declare (Definitions Schema) Schema
</span><a href="Hasura.Server.OpenAPI.html#getSelectionSchema"><span class="hs-identifier hs-var">getSelectionSchema</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, FieldInfo)] -&gt; Declare (Definitions Schema) Schema)
-&gt; [(Name, FieldInfo)] -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo -&gt; [(Name, FieldInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621689170754"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-187"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170753"><span class="hs-identifier hs-var">objectSchema</span></a></span><span>
</span><span id="line-189"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiObject</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionScalar</span></span><span> </span><span id="local-6989586621689170749"><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><a href="#local-6989586621689170749"><span class="hs-identifier hs-var">std</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170748"><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170748"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170747"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170747"><span class="hs-identifier hs-var">typePattern</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; (Maybe OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-var">referenceType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-194"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasTitle s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">title</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170760"><span class="hs-identifier hs-var">typeName</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._stdDescription</span></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><a href="#local-6989586621689170749"><span class="hs-identifier hs-var">std</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170748"><span class="hs-identifier hs-var">refType</span></a></span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">pattern</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170747"><span class="hs-identifier hs-var">typePattern</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621689170761"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621689170761"><span class="annot"><span class="annottext">go :: (Name -&gt; Declare (Definitions Schema) Schema)
-&gt; GType -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170761"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621689170739"><span class="annot"><span class="annottext">Name -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170739"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-comment">-- TODO: why do we ignore the nullability for the leaf?</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">G.TypeNamed</span></span><span> </span><span id="local-6989586621689170737"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170737"><span class="hs-identifier hs-var">_nullability</span></a></span></span><span> </span><span id="local-6989586621689170736"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170736"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170739"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170736"><span class="hs-identifier hs-var">typeName</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">G.TypeList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.Nullability</span></span><span> </span><span id="local-6989586621689170733"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170733"><span class="hs-identifier hs-var">isNullable</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621689170732"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170732"><span class="hs-identifier hs-var">innerType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>        </span><span id="local-6989586621689170731"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170731"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Declare (Definitions Schema) Schema)
-&gt; GType -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170761"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Declare (Definitions Schema) Schema
</span><a href="#local-6989586621689170739"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170732"><span class="hs-identifier hs-var">innerType</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">Schema -&gt; Declare (Definitions Schema) Schema
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Declare (Definitions Schema) Schema)
-&gt; Schema -&gt; Declare (Definitions Schema) Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-206"></span><span>          </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">nullable</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170733"><span class="hs-identifier hs-var">isNullable</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiArray</span></span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
-&gt; Schema -&gt; Identity Schema
forall s a. HasItems s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">items</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiItems -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema -&gt; OpenApiItems
</span><span class="hs-identifier hs-var">OpenApiItemsObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621689170731"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: Why do we assume objects here?</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- * URL / Query Params and Request Body Functions</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- There could be an additional partitioning scheme besides referentiality to support more types in Params</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getParams"><span class="hs-identifier hs-type">getParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointUrl"><span class="hs-identifier hs-type">EndpointUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Param</span></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span id="getParams"><span class="annot"><span class="annottext">getParams :: Structure -&gt; EndpointUrl -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#getParams"><span class="hs-identifier hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span id="local-6989586621689170725"><span class="annot"><span class="annottext">Selection
</span><a href="#local-6989586621689170725"><span class="hs-identifier hs-var">_fields</span></a></span></span><span> </span><span id="local-6989586621689170724"><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621689170724"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621689170723"><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621689170723"><span class="hs-identifier hs-var">eURL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621689170722"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170722"><span class="hs-identifier hs-var">varName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170721"><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170721"><span class="hs-identifier hs-var">varInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo -&gt; [(Name, VariableInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621689170724"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">-- Complex types are not allowed as params</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Either GType (OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">(GType -&gt; Either GType (OpenApiType, Maybe Text))
-&gt; GType -&gt; Either GType (OpenApiType, Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VariableInfo -&gt; GType
</span><a href="Hasura.GraphQL.Analyse.html#_viType"><span class="hs-identifier hs-var hs-var">_viType</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170721"><span class="hs-identifier hs-var">varInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170718"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170718"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170717"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170717"><span class="hs-identifier hs-var">typePattern</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170716"><span class="annot"><span class="annottext">isRequired :: Bool
</span><a href="#local-6989586621689170716"><span class="hs-identifier hs-var hs-var">isRequired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GType -&gt; Bool
</span><span class="hs-identifier hs-var">G.isNullable</span></span><span> </span><span class="annot"><span class="annottext">(GType -&gt; Bool) -&gt; GType -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VariableInfo -&gt; GType
</span><a href="Hasura.GraphQL.Analyse.html#_viType"><span class="hs-identifier hs-var hs-var">_viType</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170721"><span class="hs-identifier hs-var">varInfo</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><span class="annottext">Referenced Param -&gt; [Referenced Param]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Param -&gt; [Referenced Param])
-&gt; Referenced Param -&gt; [Referenced Param]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Param -&gt; Referenced Param
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">(Param -&gt; Referenced Param) -&gt; Param -&gt; Referenced Param
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>          </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Text
-&gt; Maybe Bool
-&gt; ParamLocation
-&gt; Maybe Bool
-&gt; Maybe Value
-&gt; Maybe OpenApiType
-&gt; Maybe Text
-&gt; Param
</span><a href="Hasura.Server.OpenAPI.html#mkParam"><span class="hs-identifier hs-var">mkParam</span></a></span><span>
</span><span id="line-225"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170722"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-226"></span><span>            </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170716"><span class="hs-identifier hs-var">isRequired</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170722"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot; is required (enter it either in parameters or request body)_&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>            </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170722"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170711"><span class="hs-identifier hs-var">pathVars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><span class="hs-identifier hs-var">ParamPath</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><span class="hs-identifier hs-var">ParamQuery</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-230"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value) -&gt; Maybe (Value Void) -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VariableInfo -&gt; Maybe (Value Void)
</span><a href="Hasura.GraphQL.Analyse.html#_viDefaultValue"><span class="hs-identifier hs-var hs-var">_viDefaultValue</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170721"><span class="hs-identifier hs-var">varInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170718"><span class="hs-identifier hs-var">refType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170717"><span class="hs-identifier hs-var">typePattern</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621689170711"><span class="annot"><span class="annottext">pathVars :: [Text]
</span><a href="#local-6989586621689170711"><span class="hs-identifier hs-var hs-var">pathVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.tail</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; [Text]) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Text]] -&gt; [Text]) -&gt; [[Text]] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text]) -&gt; (Text -&gt; [Text]) -&gt; EndpointUrl -&gt; [[Text]]
forall a. (Text -&gt; a) -&gt; (Text -&gt; a) -&gt; EndpointUrl -&gt; [a]
</span><a href="Hasura.RQL.Types.Endpoint.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text -&gt; [Text]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621689170723"><span class="hs-identifier hs-var">eURL</span></a></span><span> </span><span class="hs-comment">-- NOTE: URL Variable name ':' prefix is removed for `elem` lookup.</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getType"><span class="hs-identifier hs-type">getType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenApiType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span id="getType"><span class="annot"><span class="annottext">getType :: GType -&gt; Either GType (OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#getType"><span class="hs-identifier hs-var hs-var">getType</span></a></span></span><span> </span><span id="local-6989586621689170701"><span class="annot"><span class="annottext">gt :: GType
</span><a href="#local-6989586621689170701"><span class="hs-identifier hs-var">gt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeNamed</span></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621689170700"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170700"><span class="hs-identifier hs-var">na</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; (Maybe OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-var">referenceType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170699"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Either GType (OpenApiType, Maybe Text)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170701"><span class="hs-identifier hs-var">gt</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621689170698"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170698"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170697"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170697"><span class="hs-identifier hs-var">patt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text) -&gt; Either GType (OpenApiType, Maybe Text)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170698"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170697"><span class="hs-identifier hs-var">patt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621689170699"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621689170699"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170700"><span class="hs-identifier hs-var">na</span></a></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span id="local-6989586621689170696"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170696"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Either GType (OpenApiType, Maybe Text)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170696"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- Non scalar types are deferred to reference types for processing using introspection</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mkProperties"><span class="hs-identifier hs-type">mkProperties</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InsOrdHashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span id="mkProperties"><span class="annot"><span class="annottext">mkProperties :: SchemaIntrospection
-&gt; Structure
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
</span><a href="Hasura.Server.OpenAPI.html#mkProperties"><span class="hs-identifier hs-var hs-var">mkProperties</span></a></span></span><span> </span><span id="local-6989586621689170694"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170694"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170692"><span id="local-6989586621689170693"><span class="annot"><span class="annottext">HashMap Name VariableInfo
Selection
_stVariables :: Structure -&gt; HashMap Name VariableInfo
_stSelection :: Structure -&gt; Selection
_stVariables :: HashMap Name VariableInfo
_stSelection :: Selection
</span><a href="Hasura.GraphQL.Analyse.html#_stVariables"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">[(Text, Referenced Schema)]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">([(Text, Referenced Schema)]
 -&gt; InsOrdHashMap Text (Referenced Schema))
-&gt; DeclareT
     (Definitions Schema) Identity [(Text, Referenced Schema)]
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, VariableInfo)]
-&gt; ((Name, VariableInfo)
    -&gt; DeclareT
         (Definitions Schema) Identity (Text, Referenced Schema))
-&gt; DeclareT
     (Definitions Schema) Identity [(Text, Referenced Schema)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Name VariableInfo -&gt; [(Name, VariableInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621689170692"><span class="hs-identifier hs-var">_stVariables</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621689170689"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170689"><span class="hs-identifier hs-var">varName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170688"><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170688"><span class="hs-identifier hs-var">varInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621689170687"><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170687"><span class="hs-identifier hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; VariableInfo -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#mkProperty"><span class="hs-identifier hs-var">mkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170694"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621689170688"><span class="hs-identifier hs-var">varInfo</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">(Text, Referenced Schema)
-&gt; DeclareT (Definitions Schema) Identity (Text, Referenced Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170689"><span class="hs-identifier hs-var">varName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170687"><span class="hs-identifier hs-var">property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mkProperty"><span class="hs-identifier hs-type">mkProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#VariableInfo"><span class="hs-identifier hs-type">VariableInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span id="mkProperty"><span class="annot"><span class="annottext">mkProperty :: SchemaIntrospection
-&gt; VariableInfo -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#mkProperty"><span class="hs-identifier hs-var hs-var">mkProperty</span></a></span></span><span> </span><span id="local-6989586621689170685"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170685"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#VariableInfo"><span class="hs-identifier hs-type">VariableInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170682"><span id="local-6989586621689170683"><span class="annot"><span class="annottext">Maybe (Value Void)
GType
_viDefaultValue :: Maybe (Value Void)
_viType :: GType
_viDefaultValue :: VariableInfo -&gt; Maybe (Value Void)
_viType :: VariableInfo -&gt; GType
</span><a href="#local-6989586621689170682"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Either GType (OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#getType"><span class="hs-identifier hs-var">getType</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170683"><span class="hs-identifier hs-var">_viType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621689170681"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170681"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; GType -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#handleRefType"><span class="hs-identifier hs-var">handleRefType</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170685"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170681"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170679"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170679"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170678"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170678"><span class="hs-identifier hs-var">typePattern</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema
 -&gt; Declare (Definitions Schema) (Referenced Schema))
-&gt; Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Referenced Schema) -&gt; Schema -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-264"></span><span>          </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">nullable</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">GType -&gt; Bool
</span><span class="hs-identifier hs-var">G.isNullable</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170683"><span class="hs-identifier hs-var">_viType</span></a></span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170679"><span class="hs-identifier hs-var">refType</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Identity (Maybe Value))
-&gt; Schema -&gt; Identity Schema
forall s a. HasDefault s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">default_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Value -&gt; Identity (Maybe Value))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Value -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value) -&gt; Maybe (Value Void) -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void)
</span><a href="#local-6989586621689170682"><span class="hs-identifier hs-var">_viDefaultValue</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">pattern</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170678"><span class="hs-identifier hs-var">typePattern</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#handleRefType"><span class="hs-identifier hs-type">handleRefType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span id="handleRefType"><span class="annot"><span class="annottext">handleRefType :: SchemaIntrospection
-&gt; GType -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#handleRefType"><span class="hs-identifier hs-var hs-var">handleRefType</span></a></span></span><span> </span><span id="local-6989586621689170676"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170676"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.TypeNamed</span></span><span> </span><span id="local-6989586621689170675"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170675"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621689170674"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170674"><span class="hs-identifier hs-var">varName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; Nullability -&gt; Name -&gt; Declare (Definitions Schema) ()
</span><a href="Hasura.Server.OpenAPI.html#declareReference"><span class="hs-identifier hs-var">declareReference</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170676"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170675"><span class="hs-identifier hs-var">nullability</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170674"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema
 -&gt; Declare (Definitions Schema) (Referenced Schema))
-&gt; Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Referenced Schema
forall a. Reference -&gt; Referenced a
</span><span class="hs-identifier hs-var">Ref</span></span><span> </span><span class="annot"><span class="annottext">(Reference -&gt; Referenced Schema) -&gt; Reference -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Reference
</span><span class="hs-identifier hs-var">Reference</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Reference) -&gt; Text -&gt; Reference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170674"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.TypeList</span></span><span> </span><span id="local-6989586621689170670"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170670"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621689170669"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170669"><span class="hs-identifier hs-var">subType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621689170668"><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170668"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; GType -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#handleRefType"><span class="hs-identifier hs-var">handleRefType</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170676"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170669"><span class="hs-identifier hs-var">subType</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema
 -&gt; Declare (Definitions Schema) (Referenced Schema))
-&gt; Referenced Schema
-&gt; Declare (Definitions Schema) (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Referenced Schema) -&gt; Schema -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-283"></span><span>          </span><span class="hs-comment">-- TODO: is that correct? we do something different for objects.</span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">nullable</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">G.unNullability</span></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170670"><span class="hs-identifier hs-var">nullability</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GType -&gt; Bool
</span><span class="hs-identifier hs-var">G.isNullable</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170669"><span class="hs-identifier hs-var">subType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiArray</span></span><span>
</span><span id="line-286"></span><span>          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
-&gt; Schema -&gt; Identity Schema
forall s a. HasItems s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">items</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiItems -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema -&gt; OpenApiItems
</span><span class="hs-identifier hs-var">OpenApiItemsObject</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170668"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- TODO: No reference types should be nullable and only references to reference types</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#declareReference"><span class="hs-identifier hs-type">declareReference</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.Nullability</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Declare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="declareReference"><span class="annot"><span class="annottext">declareReference :: SchemaIntrospection
-&gt; Nullability -&gt; Name -&gt; Declare (Definitions Schema) ()
</span><a href="Hasura.Server.OpenAPI.html#declareReference"><span class="hs-identifier hs-var hs-var">declareReference</span></a></span></span><span> </span><span id="local-6989586621689170665"><span class="annot"><span class="annottext">schemaTypes :: SchemaIntrospection
</span><a href="#local-6989586621689170665"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span id="local-6989586621689170663"><span class="annot"><span class="annottext">HashMap Name (TypeDefinition [Name] InputValueDefinition)
</span><a href="#local-6989586621689170663"><span class="hs-identifier hs-var">typeDefinitions</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621689170662"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170662"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621689170661"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170661"><span class="hs-identifier hs-var">refName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621689170660"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170660"><span class="hs-identifier hs-var">isAvailable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; DeclareT (Definitions Schema) Identity Bool
</span><a href="Hasura.Server.OpenAPI.html#referenceAvailable"><span class="hs-identifier hs-var">referenceAvailable</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DeclareT (Definitions Schema) Identity Bool)
-&gt; Text -&gt; DeclareT (Definitions Schema) Identity Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170661"><span class="hs-identifier hs-var">refName</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; Declare (Definitions Schema) ()
-&gt; Declare (Definitions Schema) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170660"><span class="hs-identifier hs-var">isAvailable</span></a></span><span> </span><span class="annot"><span class="annottext">(Declare (Definitions Schema) ()
 -&gt; Declare (Definitions Schema) ())
-&gt; Declare (Definitions Schema) ()
-&gt; Declare (Definitions Schema) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TypeDefinition [Name] InputValueDefinition)
-&gt; (TypeDefinition [Name] InputValueDefinition
    -&gt; Declare (Definitions Schema) ())
-&gt; Declare (Definitions Schema) ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; HashMap Name (TypeDefinition [Name] InputValueDefinition)
-&gt; Maybe (TypeDefinition [Name] InputValueDefinition)
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170661"><span class="hs-identifier hs-var">refName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name (TypeDefinition [Name] InputValueDefinition)
</span><a href="#local-6989586621689170663"><span class="hs-identifier hs-var">typeDefinitions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621689170655"><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
</span><a href="#local-6989586621689170655"><span class="hs-identifier hs-var">typeDefinition</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170654"><span class="annot"><span class="annottext">properties' :: InsOrdHashMap Text (Referenced Schema)
</span><a href="#local-6989586621689170654"><span class="hs-identifier hs-var hs-var">properties'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
-&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#getPropertyReferences"><span class="hs-identifier hs-var">getPropertyReferences</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [InputValueDefinition]
 -&gt; InsOrdHashMap Text (Referenced Schema))
-&gt; Maybe [InputValueDefinition]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
-&gt; Maybe [InputValueDefinition]
forall possibleTypes.
TypeDefinition possibleTypes InputValueDefinition
-&gt; Maybe [InputValueDefinition]
</span><a href="Hasura.Server.OpenAPI.html#typeProperties"><span class="hs-identifier hs-var">typeProperties</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
</span><a href="#local-6989586621689170655"><span class="hs-identifier hs-var">typeDefinition</span></a></span><span>
</span><span id="line-300"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621689170651"><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170651"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170650"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170650"><span class="hs-identifier hs-var">typePattern</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; (Maybe OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-var">referenceType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
</span><a href="#local-6989586621689170654"><span class="hs-identifier hs-var">properties'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170661"><span class="hs-identifier hs-var">refName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><span class="annottext">Definitions Schema -&gt; Declare (Definitions Schema) ()
forall d (m :: * -&gt; *). MonadDeclare d m =&gt; d -&gt; m ()
</span><span class="hs-identifier hs-var">declare</span></span><span> </span><span class="annot"><span class="annottext">(Definitions Schema -&gt; Declare (Definitions Schema) ())
-&gt; Definitions Schema -&gt; Declare (Definitions Schema) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Schema -&gt; Definitions Schema
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170661"><span class="hs-identifier hs-var">refName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Definitions Schema) -&gt; Schema -&gt; Definitions Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-303"></span><span>          </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">nullable</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">G.unNullability</span></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170662"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition -&gt; Maybe Text
forall possibleTypes inputType.
TypeDefinition possibleTypes inputType -&gt; Maybe Text
</span><a href="Hasura.Server.OpenAPI.html#typeDescription"><span class="hs-identifier hs-var">typeDescription</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
</span><a href="#local-6989586621689170655"><span class="hs-identifier hs-var">typeDefinition</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap Text (Referenced Schema)
 -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
-&gt; Schema -&gt; Identity Schema
forall s a. HasProperties s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">properties</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap Text (Referenced Schema)
  -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
 -&gt; Schema -&gt; Identity Schema)
-&gt; InsOrdHashMap Text (Referenced Schema) -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
</span><a href="#local-6989586621689170654"><span class="hs-identifier hs-var">properties'</span></a></span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170651"><span class="hs-identifier hs-var">refType</span></a></span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">pattern</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170650"><span class="hs-identifier hs-var">typePattern</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">Declare
  (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
-&gt; Declare (Definitions Schema) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Declare
   (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
 -&gt; Declare (Definitions Schema) ())
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
-&gt; Declare (Definitions Schema) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; Maybe [InputValueDefinition]
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
</span><a href="Hasura.Server.OpenAPI.html#processProperties"><span class="hs-identifier hs-var">processProperties</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170665"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [InputValueDefinition]
 -&gt; Declare
      (Definitions Schema) (InsOrdHashMap Text (Referenced Schema)))
-&gt; Maybe [InputValueDefinition]
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
-&gt; Maybe [InputValueDefinition]
forall possibleTypes.
TypeDefinition possibleTypes InputValueDefinition
-&gt; Maybe [InputValueDefinition]
</span><a href="Hasura.Server.OpenAPI.html#typeProperties"><span class="hs-identifier hs-var">typeProperties</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDefinition [Name] InputValueDefinition
</span><a href="#local-6989586621689170655"><span class="hs-identifier hs-var">typeDefinition</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#referenceAvailable"><span class="hs-identifier hs-type">referenceAvailable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DeclareT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-312"></span><span id="referenceAvailable"><span class="annot"><span class="annottext">referenceAvailable :: Text -&gt; DeclareT (Definitions Schema) Identity Bool
</span><a href="Hasura.Server.OpenAPI.html#referenceAvailable"><span class="hs-identifier hs-var hs-var">referenceAvailable</span></a></span></span><span> </span><span id="local-6989586621689170644"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170644"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Definitions Schema -&gt; Bool
forall k a. (Eq k, Hashable k) =&gt; k -&gt; InsOrdHashMap k a -&gt; Bool
</span><span class="hs-identifier hs-var">OMap.member</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Definitions Schema -&gt; Bool)
-&gt; DeclareT (Definitions Schema) Identity (Definitions Schema)
-&gt; DeclareT (Definitions Schema) Identity Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DeclareT (Definitions Schema) Identity (Definitions Schema)
forall d (m :: * -&gt; *). MonadDeclare d m =&gt; m d
</span><span class="hs-identifier hs-var">look</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getPropertyReferences"><span class="hs-identifier hs-type">getPropertyReferences</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InsOrdHashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="getPropertyReferences"><span class="annot"><span class="annottext">getPropertyReferences :: Maybe [InputValueDefinition]
-&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#getPropertyReferences"><span class="hs-identifier hs-var hs-var">getPropertyReferences</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621689170641"><span class="annot"><span class="annottext">[InputValueDefinition]
</span><a href="#local-6989586621689170641"><span class="hs-identifier hs-var">definitions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="annottext">[(Text, Referenced Schema)]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Referenced Schema)]
 -&gt; InsOrdHashMap Text (Referenced Schema))
-&gt; [(Text, Referenced Schema)]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><span class="annottext">[InputValueDefinition]
</span><a href="#local-6989586621689170641"><span class="hs-identifier hs-var">definitions</span></a></span><span> </span><span class="annot"><span class="annottext">[InputValueDefinition]
-&gt; (InputValueDefinition -&gt; (Text, Referenced Schema))
-&gt; [(Text, Referenced Schema)]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170634"><span id="local-6989586621689170635"><span id="local-6989586621689170636"><span id="local-6989586621689170637"><span id="local-6989586621689170638"><span class="annot"><span class="annottext">[Directive Void]
Maybe Description
Maybe (Value Void)
GType
Name
_ivdType :: InputValueDefinition -&gt; GType
_ivdName :: InputValueDefinition -&gt; Name
_ivdDirectives :: InputValueDefinition -&gt; [Directive Void]
_ivdDescription :: InputValueDefinition -&gt; Maybe Description
_ivdDefaultValue :: InputValueDefinition -&gt; Maybe (Value Void)
_ivdDirectives :: [Directive Void]
_ivdDefaultValue :: Maybe (Value Void)
_ivdType :: GType
_ivdName :: Name
_ivdDescription :: Maybe Description
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text) -&gt; Name -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170637"><span class="hs-identifier hs-var">_ivdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Referenced Schema
</span><a href="Hasura.Server.OpenAPI.html#handleRefType%27"><span class="hs-identifier hs-var">handleRefType'</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170636"><span class="hs-identifier hs-var">_ivdType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#handleRefType%27"><span class="hs-identifier hs-type">handleRefType'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.GType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span>
</span><span id="line-323"></span><span id="handleRefType%27"><span class="annot"><span class="annottext">handleRefType' :: GType -&gt; Referenced Schema
</span><a href="Hasura.Server.OpenAPI.html#handleRefType%27"><span class="hs-identifier hs-var hs-var">handleRefType'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.TypeNamed</span></span><span> </span><span id="local-6989586621689170627"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170627"><span class="hs-identifier hs-var">_nullability</span></a></span></span><span> </span><span id="local-6989586621689170626"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170626"><span class="hs-identifier hs-var">nameWrapper</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170625"><span class="annot"><span class="annottext">n :: Text
</span><a href="#local-6989586621689170625"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170626"><span class="hs-identifier hs-var">nameWrapper</span></a></span><span>
</span><span id="line-326"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Referenced Schema
forall a. Reference -&gt; Referenced a
</span><span class="hs-identifier hs-var">Ref</span></span><span> </span><span class="annot"><span class="annottext">(Reference -&gt; Referenced Schema) -&gt; Reference -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Reference
</span><span class="hs-identifier hs-var">Reference</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170625"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.TypeList</span></span><span> </span><span id="local-6989586621689170624"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170624"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621689170623"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170623"><span class="hs-identifier hs-var">subType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170622"><span class="annot"><span class="annottext">st :: Referenced Schema
</span><a href="#local-6989586621689170622"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Referenced Schema
</span><a href="Hasura.Server.OpenAPI.html#handleRefType%27"><span class="hs-identifier hs-var">handleRefType'</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170623"><span class="hs-identifier hs-var">subType</span></a></span><span>
</span><span id="line-329"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">(Schema -&gt; Referenced Schema) -&gt; Schema -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-330"></span><span>          </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">nullable</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">G.unNullability</span></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621689170624"><span class="hs-identifier hs-var">nullability</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GType -&gt; Bool
</span><span class="hs-identifier hs-var">G.isNullable</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170623"><span class="hs-identifier hs-var">subType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiArray</span></span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
-&gt; Schema -&gt; Identity Schema
forall s a. HasItems s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">items</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiItems -&gt; Identity (Maybe OpenApiItems))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiItems -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema -&gt; OpenApiItems
</span><span class="hs-identifier hs-var">OpenApiItemsObject</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170622"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span id="local-6989586621689170980"><span id="local-6989586621689170981"><span class="annot"><a href="Hasura.Server.OpenAPI.html#typeDescription"><span class="hs-identifier hs-type">typeDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinition</span></span><span> </span><span class="annot"><a href="#local-6989586621689170981"><span class="hs-identifier hs-type">possibleTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689170980"><span class="hs-identifier hs-type">inputType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span></span><span>
</span><span id="line-336"></span><span id="typeDescription"><span class="annot"><span class="annottext">typeDescription :: TypeDefinition possibleTypes inputType -&gt; Maybe Text
</span><a href="Hasura.Server.OpenAPI.html#typeDescription"><span class="hs-identifier hs-var hs-var">typeDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionScalar</span></span><span> </span><span id="local-6989586621689170621"><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><a href="#local-6989586621689170621"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._stdDescription</span></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><a href="#local-6989586621689170621"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionObject</span></span><span> </span><span id="local-6989586621689170620"><span class="annot"><span class="annottext">ObjectTypeDefinition inputType
</span><a href="#local-6989586621689170620"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition inputType -&gt; Maybe Description
forall inputType.
ObjectTypeDefinition inputType -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._otdDescription</span></span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition inputType
</span><a href="#local-6989586621689170620"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInterface</span></span><span> </span><span id="local-6989586621689170618"><span class="annot"><span class="annottext">InterfaceTypeDefinition possibleTypes inputType
</span><a href="#local-6989586621689170618"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">InterfaceTypeDefinition possibleTypes inputType
-&gt; Maybe Description
forall possibleTypes inputType.
InterfaceTypeDefinition possibleTypes inputType
-&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._itdDescription</span></span><span> </span><span class="annot"><span class="annottext">InterfaceTypeDefinition possibleTypes inputType
</span><a href="#local-6989586621689170618"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionUnion</span></span><span> </span><span id="local-6989586621689170616"><span class="annot"><span class="annottext">UnionTypeDefinition
</span><a href="#local-6989586621689170616"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UnionTypeDefinition -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._utdDescription</span></span><span> </span><span class="annot"><span class="annottext">UnionTypeDefinition
</span><a href="#local-6989586621689170616"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionEnum</span></span><span> </span><span id="local-6989586621689170614"><span class="annot"><span class="annottext">EnumTypeDefinition
</span><a href="#local-6989586621689170614"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._etdDescription</span></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><a href="#local-6989586621689170614"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInputObject</span></span><span> </span><span id="local-6989586621689170612"><span class="annot"><span class="annottext">InputObjectTypeDefinition inputType
</span><a href="#local-6989586621689170612"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unDescription</span></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition inputType -&gt; Maybe Description
forall inputType.
InputObjectTypeDefinition inputType -&gt; Maybe Description
</span><span class="hs-identifier hs-var hs-var">G._iotdDescription</span></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition inputType
</span><a href="#local-6989586621689170612"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621689170986"><span class="annot"><a href="Hasura.Server.OpenAPI.html#typeProperties"><span class="hs-identifier hs-type">typeProperties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinition</span></span><span> </span><span class="annot"><a href="#local-6989586621689170986"><span class="hs-identifier hs-type">possibleTypes</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-345"></span><span id="typeProperties"><span class="annot"><span class="annottext">typeProperties :: TypeDefinition possibleTypes InputValueDefinition
-&gt; Maybe [InputValueDefinition]
</span><a href="Hasura.Server.OpenAPI.html#typeProperties"><span class="hs-identifier hs-var hs-var">typeProperties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionScalar</span></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInterface</span></span><span> </span><span class="annot"><span class="annottext">InterfaceTypeDefinition possibleTypes InputValueDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionUnion</span></span><span> </span><span class="annot"><span class="annottext">UnionTypeDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionEnum</span></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionInputObject</span></span><span> </span><span id="local-6989586621689170610"><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition
</span><a href="#local-6989586621689170610"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[InputValueDefinition] -&gt; Maybe [InputValueDefinition]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([InputValueDefinition] -&gt; Maybe [InputValueDefinition])
-&gt; [InputValueDefinition] -&gt; Maybe [InputValueDefinition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition
-&gt; [InputValueDefinition]
forall inputType.
InputObjectTypeDefinition inputType -&gt; [inputType]
</span><span class="hs-identifier hs-var hs-var">G._iotdValueDefinitions</span></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition
</span><a href="#local-6989586621689170610"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.TypeDefinitionObject</span></span><span> </span><span class="annot"><span class="annottext">ObjectTypeDefinition InputValueDefinition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- TODO: Can we reuse something from rest module to handle this?</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- TODO: referenceType could be improved, instead of using Bool (to indicate if it is object or scalar),</span><span>
</span><span id="line-355"></span><span class="hs-comment">--        we can do something better</span><span>
</span><span id="line-356"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-type">referenceType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApiType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span id="referenceType"><span class="annot"><span class="annottext">referenceType :: Bool -&gt; Text -&gt; (Maybe OpenApiType, Maybe Text)
</span><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-var hs-var">referenceType</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType, Maybe Text)
-&gt; Text -&gt; (Maybe OpenApiType, Maybe Text)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiObject</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#referenceType"><span class="hs-identifier hs-var">referenceType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;int&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiInteger</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;float&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;double&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;uuid&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89aAbB][a-f0-9]{3}-[a-f0-9]{12}&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bool&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiBoolean</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;boolean&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiBoolean</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;id&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe OpenApiType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#processProperties"><span class="hs-identifier hs-type">processProperties</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DeclareT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InsOrdHashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Referenced</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span id="processProperties"><span class="annot"><span class="annottext">processProperties :: SchemaIntrospection
-&gt; Maybe [InputValueDefinition]
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
</span><a href="Hasura.Server.OpenAPI.html#processProperties"><span class="hs-identifier hs-var hs-var">processProperties</span></a></span></span><span> </span><span id="local-6989586621689170604"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170604"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="annottext">Maybe [InputValueDefinition]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621689170603"><span class="annot"><span class="annottext">[InputValueDefinition]
</span><a href="#local-6989586621689170603"><span class="hs-identifier hs-var">definitions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="annottext">[(Text, Referenced Schema)]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Referenced Schema)]
 -&gt; InsOrdHashMap Text (Referenced Schema))
-&gt; DeclareT
     (Definitions Schema) Identity [(Text, Referenced Schema)]
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[InputValueDefinition]
-&gt; (InputValueDefinition
    -&gt; DeclareT
         (Definitions Schema) Identity (Text, Referenced Schema))
-&gt; DeclareT
     (Definitions Schema) Identity [(Text, Referenced Schema)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[InputValueDefinition]
</span><a href="#local-6989586621689170603"><span class="hs-identifier hs-var">definitions</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="hs-identifier hs-type">G.InputValueDefinition</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170598"><span id="local-6989586621689170599"><span id="local-6989586621689170600"><span id="local-6989586621689170601"><span id="local-6989586621689170602"><span class="annot"><span class="annottext">[Directive Void]
Maybe Description
Maybe (Value Void)
GType
Name
_ivdDirectives :: [Directive Void]
_ivdDefaultValue :: Maybe (Value Void)
_ivdType :: GType
_ivdName :: Name
_ivdDescription :: Maybe Description
_ivdType :: InputValueDefinition -&gt; GType
_ivdName :: InputValueDefinition -&gt; Name
_ivdDirectives :: InputValueDefinition -&gt; [Directive Void]
_ivdDescription :: InputValueDefinition -&gt; Maybe Description
_ivdDefaultValue :: InputValueDefinition -&gt; Maybe (Value Void)
</span><a href="#local-6989586621689170598"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>      </span><span id="local-6989586621689170597"><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170597"><span class="hs-identifier hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; GType -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#handleRefType"><span class="hs-identifier hs-var">handleRefType</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170604"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621689170600"><span class="hs-identifier hs-var">_ivdType</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">(Text, Referenced Schema)
-&gt; DeclareT (Definitions Schema) Identity (Text, Referenced Schema)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text) -&gt; Name -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621689170601"><span class="hs-identifier hs-var">_ivdName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621689170597"><span class="hs-identifier hs-var">property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getGQLQueryFromTrie"><span class="hs-identifier hs-type">getGQLQueryFromTrie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-381"></span><span id="getGQLQueryFromTrie"><span class="annot"><span class="annottext">getGQLQueryFromTrie :: EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getGQLQueryFromTrie"><span class="hs-identifier hs-var hs-var">getGQLQueryFromTrie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GQLQueryWithText -&gt; Text
</span><a href="Hasura.RQL.Types.QueryCollection.html#getGQLQueryText"><span class="hs-identifier hs-var">getGQLQueryText</span></a></span><span> </span><span class="annot"><span class="annottext">(GQLQueryWithText -&gt; Text)
-&gt; (EndpointMetadata GQLQueryWithText -&gt; GQLQueryWithText)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointDef GQLQueryWithText -&gt; GQLQueryWithText
forall query. EndpointDef query -&gt; query
</span><a href="Hasura.RQL.Types.Endpoint.html#_edQuery"><span class="hs-identifier hs-var hs-var">_edQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointDef GQLQueryWithText -&gt; GQLQueryWithText)
-&gt; (EndpointMetadata GQLQueryWithText
    -&gt; EndpointDef GQLQueryWithText)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; GQLQueryWithText
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; EndpointDef GQLQueryWithText
forall query. EndpointMetadata query -&gt; EndpointDef query
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceDefinition"><span class="hs-identifier hs-var hs-var">_ceDefinition</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mkParam"><span class="hs-identifier hs-type">mkParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParamLocation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">J.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApiType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pattern</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Param</span></span><span>
</span><span id="line-384"></span><span id="mkParam"><span class="annot"><span class="annottext">mkParam :: Text
-&gt; Maybe Text
-&gt; Maybe Bool
-&gt; ParamLocation
-&gt; Maybe Bool
-&gt; Maybe Value
-&gt; Maybe OpenApiType
-&gt; Maybe Text
-&gt; Param
</span><a href="Hasura.Server.OpenAPI.html#mkParam"><span class="hs-identifier hs-var hs-var">mkParam</span></a></span></span><span> </span><span id="local-6989586621689170594"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170594"><span class="hs-identifier hs-var">nameP</span></a></span></span><span> </span><span id="local-6989586621689170593"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170593"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621689170592"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621689170592"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621689170591"><span class="annot"><span class="annottext">ParamLocation
</span><a href="#local-6989586621689170591"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621689170590"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621689170590"><span class="hs-identifier hs-var">allowEmpty</span></a></span></span><span> </span><span id="local-6989586621689170589"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621689170589"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621689170588"><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170588"><span class="hs-identifier hs-var">varType</span></a></span></span><span> </span><span id="local-6989586621689170587"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170587"><span class="hs-identifier hs-var">patt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">Param
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param
forall s a. HasName s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">name</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param)
-&gt; Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170594"><span class="hs-identifier hs-var">nameP</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param)
-&gt; Maybe Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170593"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Param -&gt; Identity Param
forall s a. HasRequired s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">required</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Param -&gt; Identity Param)
-&gt; Maybe Bool -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621689170592"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ParamLocation -&gt; Identity ParamLocation)
-&gt; Param -&gt; Identity Param
forall s a. HasIn s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">in_</span></span><span> </span><span class="annot"><span class="annottext">((ParamLocation -&gt; Identity ParamLocation)
 -&gt; Param -&gt; Identity Param)
-&gt; ParamLocation -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="#local-6989586621689170591"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Param -&gt; Identity Param
forall s a. HasAllowEmptyValue s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">allowEmptyValue</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Param -&gt; Identity Param)
-&gt; Maybe Bool -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621689170590"><span class="hs-identifier hs-var">allowEmpty</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; Param -&gt; Identity Param
forall s a. HasSchema s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">schema</span></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; Param -&gt; Identity Param)
-&gt; Referenced Schema -&gt; Param -&gt; Param
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-394"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Identity (Maybe Value))
-&gt; Schema -&gt; Identity Schema
forall s a. HasDefault s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">default_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Value -&gt; Identity (Maybe Value))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Value -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621689170589"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-395"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170588"><span class="hs-identifier hs-var">varType</span></a></span><span>
</span><span id="line-396"></span><span>            </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">pattern</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621689170587"><span class="hs-identifier hs-var">patt</span></a></span><span>
</span><span id="line-397"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-type">gqlToJsonValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">J.Value</span></span><span>
</span><span id="line-400"></span><span id="gqlToJsonValue"><span class="annot"><span class="annottext">gqlToJsonValue :: Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var hs-var">gqlToJsonValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="annottext">Value Void
</span><span class="hs-identifier hs-var">G.VNull</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">J.Null</span></span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VInt</span></span><span> </span><span id="local-6989586621689170579"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621689170579"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621689170579"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VFloat</span></span><span> </span><span id="local-6989586621689170576"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621689170576"><span class="hs-identifier hs-var">sci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621689170576"><span class="hs-identifier hs-var">sci</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VString</span></span><span> </span><span id="local-6989586621689170574"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170574"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170574"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VBoolean</span></span><span> </span><span id="local-6989586621689170572"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170572"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170572"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VEnum</span></span><span> </span><span id="local-6989586621689170570"><span class="annot"><span class="annottext">EnumValue
</span><a href="#local-6989586621689170570"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EnumValue -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">EnumValue
</span><a href="#local-6989586621689170570"><span class="hs-identifier hs-var">ev</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VList</span></span><span> </span><span id="local-6989586621689170568"><span class="annot"><span class="annottext">[Value Void]
</span><a href="#local-6989586621689170568"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; [Value] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value) -&gt; [Value Void] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Value Void]
</span><a href="#local-6989586621689170568"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.VObject</span></span><span> </span><span id="local-6989586621689170566"><span class="annot"><span class="annottext">HashMap Name (Value Void)
</span><a href="#local-6989586621689170566"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashMap Name Value -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">J.toJSON</span></span><span> </span><span class="annot"><span class="annottext">(HashMap Name Value -&gt; Value) -&gt; HashMap Name Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value)
-&gt; HashMap Name (Value Void) -&gt; HashMap Name Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value Void)
</span><a href="#local-6989586621689170566"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- * Top level schema construction</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getComment"><span class="hs-identifier hs-type">getComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-413"></span><span id="getComment"><span class="annot"><span class="annottext">getComment :: EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getComment"><span class="hs-identifier hs-var hs-var">getComment</span></a></span></span><span> </span><span id="local-6989586621689170564"><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170564"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170563"><span class="hs-identifier hs-var">comment</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621689170562"><span class="annot"><span class="annottext">gql :: Text
</span><a href="#local-6989586621689170562"><span class="hs-identifier hs-var hs-var">gql</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getGQLQueryFromTrie"><span class="hs-identifier hs-var">getGQLQueryFromTrie</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170564"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621689170563"><span class="annot"><span class="annottext">comment :: Text
</span><a href="#local-6989586621689170563"><span class="hs-identifier hs-var hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; Maybe Text
forall query. EndpointMetadata query -&gt; Maybe Text
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceComment"><span class="hs-identifier hs-var hs-var">_ceComment</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170564"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621689170560"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170560"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170560"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n***\nThe GraphQl query for this endpoint is:\n``` graphql\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170562"><span class="hs-identifier hs-var">gql</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n```&quot;</span></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">Maybe Text
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;***\nThe GraphQl query for this endpoint is:\n``` graphql\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170562"><span class="hs-identifier hs-var">gql</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n```&quot;</span></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getURL"><span class="hs-identifier hs-type">getURL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-421"></span><span id="getURL"><span class="annot"><span class="annottext">getURL :: EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getURL"><span class="hs-identifier hs-var hs-var">getURL</span></a></span></span><span> </span><span id="local-6989586621689170558"><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170558"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/api/rest/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170556"><span class="hs-identifier hs-var">pathComponents</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621689170556"><span class="annot"><span class="annottext">pathComponents :: [Text]
</span><a href="#local-6989586621689170556"><span class="hs-identifier hs-var hs-var">pathComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; EndpointUrl -&gt; [Text]
forall a. (Text -&gt; a) -&gt; (Text -&gt; a) -&gt; EndpointUrl -&gt; [a]
</span><a href="Hasura.RQL.Types.Endpoint.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621689170555"><span class="hs-identifier hs-var">formatVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(EndpointUrl -&gt; [Text])
-&gt; (EndpointMetadata GQLQueryWithText -&gt; EndpointUrl)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; [Text]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; EndpointUrl
forall query. EndpointMetadata query -&gt; EndpointUrl
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceUrl"><span class="hs-identifier hs-var hs-var">_ceUrl</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointMetadata GQLQueryWithText -&gt; [Text])
-&gt; EndpointMetadata GQLQueryWithText -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170558"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621689170555"><span class="annot"><span class="annottext">formatVariable :: Text -&gt; Text
</span><a href="#local-6989586621689170555"><span class="hs-identifier hs-var hs-var">formatVariable</span></a></span></span><span> </span><span id="local-6989586621689170552"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170552"><span class="hs-identifier hs-var">variable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621689170551"><span class="hs-identifier hs-var">dropColonPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170552"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621689170551"><span class="annot"><span class="annottext">dropColonPrefix :: Text -&gt; Text
</span><a href="#local-6989586621689170551"><span class="hs-identifier hs-var hs-var">dropColonPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#extractEndpointInfo"><span class="hs-identifier hs-type">extractEndpointInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareErr"><span class="hs-identifier hs-type">DeclareErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span>
</span><span id="line-429"></span><span id="extractEndpointInfo"><span class="annot"><span class="annottext">extractEndpointInfo :: SchemaIntrospection
-&gt; EndpointMethod
-&gt; EndpointMetadata GQLQueryWithText
-&gt; DeclareErr (Definitions Schema) EndpointData
</span><a href="Hasura.Server.OpenAPI.html#extractEndpointInfo"><span class="hs-identifier hs-var hs-var">extractEndpointInfo</span></a></span></span><span> </span><span id="local-6989586621689170548"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170548"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span id="local-6989586621689170547"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170547"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621689170546"><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621689170545"><span class="annot"><span class="annottext">SingleOperation
</span><a href="#local-6989586621689170545"><span class="hs-identifier hs-var">singleOperation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GQLReqParsed
-&gt; ExceptT QErr (Declare (Definitions Schema)) SingleOperation
forall (m :: * -&gt; *).
MonadError QErr m =&gt;
GQLReqParsed -&gt; m SingleOperation
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#getSingleOperation"><span class="hs-identifier hs-var">getSingleOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe OperationName
-&gt; GQLExecDoc -&gt; Maybe (HashMap Name Value) -&gt; GQLReqParsed
forall a.
Maybe OperationName -&gt; a -&gt; Maybe (HashMap Name Value) -&gt; GQLReq a
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReq"><span class="hs-identifier hs-var">GQLReq</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OperationName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExecutableDefinition Name] -&gt; GQLExecDoc
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLExecDoc"><span class="hs-identifier hs-var">GQLExecDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; [ExecutableDefinition Name]
</span><a href="Hasura.Server.OpenAPI.html#mdDefinitions"><span class="hs-identifier hs-var">mdDefinitions</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap Name Value)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170541"><span class="annot"><span class="annottext">Structure
</span><a href="#local-6989586621689170541"><span class="hs-identifier hs-var">analysis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170540"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170540"><span class="hs-identifier hs-var">allErrors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection -&gt; SingleOperation -&gt; (Structure, [Text])
</span><a href="Hasura.GraphQL.Analyse.html#analyzeGraphQLQuery"><span class="hs-identifier hs-var">analyzeGraphQLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170548"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">SingleOperation
</span><a href="#local-6989586621689170545"><span class="hs-identifier hs-var">singleOperation</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621689170538"><span class="annot"><span class="annottext">_edUrl :: String
</span><a href="#local-6989586621689170538"><span class="hs-identifier hs-var hs-var">_edUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String)
-&gt; (EndpointMetadata GQLQueryWithText -&gt; Text)
-&gt; EndpointMetadata GQLQueryWithText
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getURL"><span class="hs-identifier hs-var">getURL</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointMetadata GQLQueryWithText -&gt; String)
-&gt; EndpointMetadata GQLQueryWithText -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span id="local-6989586621689170536"><span class="annot"><span class="annottext">_edVarList :: [Referenced Param]
</span><a href="#local-6989586621689170536"><span class="hs-identifier hs-var hs-var">_edVarList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; EndpointUrl -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="#local-6989586621689170541"><span class="hs-identifier hs-var">analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; EndpointUrl
forall query. EndpointMetadata query -&gt; EndpointUrl
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceUrl"><span class="hs-identifier hs-var hs-var">_ceUrl</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>      </span><span id="local-6989586621689170535"><span class="annot"><span class="annottext">_edDescription :: Text
</span><a href="#local-6989586621689170535"><span class="hs-identifier hs-var hs-var">_edDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#getComment"><span class="hs-identifier hs-var">getComment</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span id="local-6989586621689170534"><span class="annot"><span class="annottext">_edName :: Text
</span><a href="#local-6989586621689170534"><span class="hs-identifier hs-var hs-var">_edName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmptyText -&gt; Text
</span><a href="Data.Text.NonEmpty.html#unNonEmptyText"><span class="hs-identifier hs-var hs-var">unNonEmptyText</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmptyText -&gt; Text) -&gt; NonEmptyText -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointName -&gt; NonEmptyText
</span><a href="Hasura.RQL.Types.Endpoint.html#unEndpointName"><span class="hs-identifier hs-var hs-var">unEndpointName</span></a></span><span> </span><span class="annot"><span class="annottext">(EndpointName -&gt; NonEmptyText) -&gt; EndpointName -&gt; NonEmptyText
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText -&gt; EndpointName
forall query. EndpointMetadata query -&gt; EndpointName
</span><a href="Hasura.RQL.Types.Endpoint.html#_ceName"><span class="hs-identifier hs-var hs-var">_ceName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMetadata GQLQueryWithText
</span><a href="#local-6989586621689170546"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621689170530"><span class="annot"><span class="annottext">_edMethod :: HashSet EndpointMethod
</span><a href="#local-6989586621689170530"><span class="hs-identifier hs-var hs-var">_edMethod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; HashSet EndpointMethod
forall a. Hashable a =&gt; a -&gt; HashSet a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170547"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-comment">-- NOTE: Methods are grouped with into matching endpoints - Name used for grouping.</span><span>
</span><span id="line-437"></span><span>      </span><span id="local-6989586621689170528"><span class="annot"><span class="annottext">_edErrs :: [Text]
</span><a href="#local-6989586621689170528"><span class="hs-identifier hs-var hs-var">_edErrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170540"><span class="hs-identifier hs-var">allErrors</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621689170527"><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema)
</span><a href="#local-6989586621689170527"><span class="hs-identifier hs-var">_edProperties</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Declare
  (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
-&gt; ExceptT
     QErr
     (Declare (Definitions Schema))
     (InsOrdHashMap Text (Referenced Schema))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Declare
   (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
 -&gt; ExceptT
      QErr
      (Declare (Definitions Schema))
      (InsOrdHashMap Text (Referenced Schema)))
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
-&gt; ExceptT
     QErr
     (Declare (Definitions Schema))
     (InsOrdHashMap Text (Referenced Schema))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; Structure
-&gt; Declare
     (Definitions Schema) (InsOrdHashMap Text (Referenced Schema))
</span><a href="Hasura.Server.OpenAPI.html#mkProperties"><span class="hs-identifier hs-var">mkProperties</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170548"><span class="hs-identifier hs-var">schemaTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="#local-6989586621689170541"><span class="hs-identifier hs-var">analysis</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621689170525"><span class="annot"><span class="annottext">HashMap EndpointMethod Response
</span><a href="#local-6989586621689170525"><span class="hs-identifier hs-var">_edResponse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DeclareT
  (Definitions Schema) Identity (HashMap EndpointMethod Response)
-&gt; ExceptT
     QErr
     (Declare (Definitions Schema))
     (HashMap EndpointMethod Response)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(DeclareT
   (Definitions Schema) Identity (HashMap EndpointMethod Response)
 -&gt; ExceptT
      QErr
      (Declare (Definitions Schema))
      (HashMap EndpointMethod Response))
-&gt; DeclareT
     (Definitions Schema) Identity (HashMap EndpointMethod Response)
-&gt; ExceptT
     QErr
     (Declare (Definitions Schema))
     (HashMap EndpointMethod Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; HashMap EndpointMethod Response)
-&gt; Maybe Response -&gt; HashMap EndpointMethod Response
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointMethod -&gt; Response -&gt; HashMap EndpointMethod Response
forall k v. Hashable k =&gt; k -&gt; v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170547"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Response -&gt; HashMap EndpointMethod Response)
-&gt; Declare (Definitions Schema) (Maybe Response)
-&gt; DeclareT
     (Definitions Schema) Identity (HashMap EndpointMethod Response)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Structure
-&gt; EndpointMethod
-&gt; String
-&gt; Declare (Definitions Schema) (Maybe Response)
</span><a href="Hasura.Server.OpenAPI.html#mkResponse"><span class="hs-identifier hs-var">mkResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="#local-6989586621689170541"><span class="hs-identifier hs-var">analysis</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170547"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621689170538"><span class="hs-identifier hs-var">_edUrl</span></a></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">EndpointData -&gt; DeclareErr (Definitions Schema) EndpointData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EndpointData -&gt; DeclareErr (Definitions Schema) EndpointData)
-&gt; EndpointData -&gt; DeclareErr (Definitions Schema) EndpointData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointData :: String
-&gt; HashSet EndpointMethod
-&gt; [Referenced Param]
-&gt; InsOrdHashMap Text (Referenced Schema)
-&gt; HashMap EndpointMethod Response
-&gt; Text
-&gt; Text
-&gt; [Text]
-&gt; EndpointData
</span><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">String
[Text]
[Referenced Param]
Text
HashMap EndpointMethod Response
HashSet EndpointMethod
InsOrdHashMap Text (Referenced Schema)
_edResponse :: HashMap EndpointMethod Response
_edProperties :: InsOrdHashMap Text (Referenced Schema)
_edErrs :: [Text]
_edMethod :: HashSet EndpointMethod
_edName :: Text
_edDescription :: Text
_edVarList :: [Referenced Param]
_edUrl :: String
_edErrs :: [Text]
_edName :: Text
_edDescription :: Text
_edResponse :: HashMap EndpointMethod Response
_edProperties :: InsOrdHashMap Text (Referenced Schema)
_edVarList :: [Referenced Param]
_edMethod :: HashSet EndpointMethod
_edUrl :: String
</span><a href="#local-6989586621689170525"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getEndpointsData"><span class="hs-identifier hs-type">getEndpointsData</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#SchemaCache"><span class="hs-identifier hs-type">SchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareErr"><span class="hs-identifier hs-type">DeclareErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span id="getEndpointsData"><span class="annot"><span class="annottext">getEndpointsData :: SchemaIntrospection
-&gt; SchemaCache -&gt; DeclareErr (Definitions Schema) [EndpointData]
</span><a href="Hasura.Server.OpenAPI.html#getEndpointsData"><span class="hs-identifier hs-var hs-var">getEndpointsData</span></a></span></span><span> </span><span id="local-6989586621689170521"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170521"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621689170520"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170520"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170519"><span class="annot"><span class="annottext">endpointTrie :: EndpointTrie GQLQueryWithText
</span><a href="#local-6989586621689170519"><span class="hs-identifier hs-var hs-var">endpointTrie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; EndpointTrie GQLQueryWithText
</span><a href="Hasura.RQL.Types.SchemaCache.html#scEndpoints"><span class="hs-identifier hs-var hs-var">scEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170520"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span id="local-6989586621689170517"><span class="annot"><span class="annottext">methodMaps :: [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
</span><a href="#local-6989586621689170517"><span class="hs-identifier hs-var hs-var">methodMaps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointTrie GQLQueryWithText
-&gt; [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
forall k v. Trie k v -&gt; [v]
</span><a href="Data.Trie.html#elems"><span class="hs-identifier hs-var">Trie.elems</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointTrie GQLQueryWithText
</span><a href="#local-6989586621689170519"><span class="hs-identifier hs-var">endpointTrie</span></a></span><span>
</span><span id="line-450"></span><span>      </span><span id="local-6989586621689170515"><span class="annot"><span class="annottext">endpointsWithMethods :: [(EndpointMethod, EndpointMetadata GQLQueryWithText)]
</span><a href="#local-6989586621689170515"><span class="hs-identifier hs-var hs-var">endpointsWithMethods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((EndpointMethod, [EndpointMetadata GQLQueryWithText])
 -&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)])
-&gt; [(EndpointMethod, [EndpointMetadata GQLQueryWithText])]
-&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621689170513"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170513"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170512"><span class="annot"><span class="annottext">[EndpointMetadata GQLQueryWithText]
</span><a href="#local-6989586621689170512"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(EndpointMetadata GQLQueryWithText
 -&gt; (EndpointMethod, EndpointMetadata GQLQueryWithText))
-&gt; [EndpointMetadata GQLQueryWithText]
-&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170513"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[EndpointMetadata GQLQueryWithText]
</span><a href="#local-6989586621689170512"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(EndpointMethod, [EndpointMetadata GQLQueryWithText])]
 -&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)])
-&gt; [(EndpointMethod, [EndpointMetadata GQLQueryWithText])]
-&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)
 -&gt; [(EndpointMethod, [EndpointMetadata GQLQueryWithText])])
-&gt; [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
-&gt; [(EndpointMethod, [EndpointMetadata GQLQueryWithText])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)
-&gt; [(EndpointMethod, [EndpointMetadata GQLQueryWithText])]
forall k v. MultiMap k v -&gt; [(k, [v])]
</span><a href="Data.HashMap.Strict.Multi.html#toList"><span class="hs-identifier hs-var">MMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">[MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
</span><a href="#local-6989586621689170517"><span class="hs-identifier hs-var">methodMaps</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621689170510"><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170510"><span class="hs-identifier hs-var">endpointsWithInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((EndpointMethod, EndpointMetadata GQLQueryWithText)
 -&gt; DeclareErr (Definitions Schema) EndpointData)
-&gt; [(EndpointMethod, EndpointMetadata GQLQueryWithText)]
-&gt; DeclareErr (Definitions Schema) [EndpointData]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EndpointMethod
 -&gt; EndpointMetadata GQLQueryWithText
 -&gt; DeclareErr (Definitions Schema) EndpointData)
-&gt; (EndpointMethod, EndpointMetadata GQLQueryWithText)
-&gt; DeclareErr (Definitions Schema) EndpointData
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; EndpointMethod
-&gt; EndpointMetadata GQLQueryWithText
-&gt; DeclareErr (Definitions Schema) EndpointData
</span><a href="Hasura.Server.OpenAPI.html#extractEndpointInfo"><span class="hs-identifier hs-var">extractEndpointInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170521"><span class="hs-identifier hs-var">sd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(EndpointMethod, EndpointMetadata GQLQueryWithText)]
</span><a href="#local-6989586621689170515"><span class="hs-identifier hs-var">endpointsWithMethods</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170507"><span class="annot"><span class="annottext">endpointsGrouped :: [NonEmpty EndpointData]
</span><a href="#local-6989586621689170507"><span class="hs-identifier hs-var hs-var">endpointsGrouped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(EndpointData -&gt; EndpointData -&gt; Bool)
-&gt; [EndpointData] -&gt; [NonEmpty EndpointData]
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; Bool) -&gt; f a -&gt; [NonEmpty a]
</span><span class="hs-identifier hs-var">NE.groupBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621689170505"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170505"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621689170504"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170504"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edName"><span class="hs-identifier hs-var hs-var">_edName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170505"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edName"><span class="hs-identifier hs-var hs-var">_edName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170504"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170510"><span class="hs-identifier hs-var">endpointsWithInfo</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">[EndpointData] -&gt; DeclareErr (Definitions Schema) [EndpointData]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([EndpointData] -&gt; DeclareErr (Definitions Schema) [EndpointData])
-&gt; [EndpointData] -&gt; DeclareErr (Definitions Schema) [EndpointData]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty EndpointData -&gt; EndpointData)
-&gt; [NonEmpty EndpointData] -&gt; [EndpointData]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty EndpointData -&gt; EndpointData
</span><a href="Hasura.Server.OpenAPI.html#squashEndpointGroup"><span class="hs-identifier hs-var">squashEndpointGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[NonEmpty EndpointData]
</span><a href="#local-6989586621689170507"><span class="hs-identifier hs-var">endpointsGrouped</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#squashEndpointGroup"><span class="hs-identifier hs-type">squashEndpointGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span>
</span><span id="line-459"></span><span id="squashEndpointGroup"><span class="annot"><span class="annottext">squashEndpointGroup :: NonEmpty EndpointData -&gt; EndpointData
</span><a href="Hasura.Server.OpenAPI.html#squashEndpointGroup"><span class="hs-identifier hs-var hs-var">squashEndpointGroup</span></a></span></span><span> </span><span id="local-6989586621689170502"><span class="annot"><span class="annottext">NonEmpty EndpointData
</span><a href="#local-6989586621689170502"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty EndpointData -&gt; EndpointData
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty EndpointData
</span><a href="#local-6989586621689170502"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_edMethod :: HashSet EndpointMethod
</span><a href="Hasura.Server.OpenAPI.html#_edMethod"><span class="hs-identifier hs-var">_edMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(EndpointData -&gt; HashSet EndpointMethod)
-&gt; NonEmpty EndpointData -&gt; HashSet EndpointMethod
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; HashSet EndpointMethod
</span><a href="Hasura.Server.OpenAPI.html#_edMethod"><span class="hs-identifier hs-var hs-var">_edMethod</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty EndpointData
</span><a href="#local-6989586621689170502"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><span class="annottext">_edResponse :: HashMap EndpointMethod Response
</span><a href="Hasura.Server.OpenAPI.html#_edResponse"><span class="hs-identifier hs-var">_edResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(EndpointData -&gt; HashMap EndpointMethod Response)
-&gt; NonEmpty EndpointData -&gt; HashMap EndpointMethod Response
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; HashMap EndpointMethod Response
</span><a href="Hasura.Server.OpenAPI.html#_edResponse"><span class="hs-identifier hs-var hs-var">_edResponse</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty EndpointData
</span><a href="#local-6989586621689170502"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span id="local-6989586621689170500"><span class="annot"><a href="Hasura.Server.OpenAPI.html#serveJSON"><span class="hs-identifier hs-type">serveJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621689170500"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#SchemaCache"><span class="hs-identifier hs-type">SchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621689170500"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApi</span></span></span><span>
</span><span id="line-466"></span><span id="serveJSON"><span class="annot"><span class="annottext">serveJSON :: SchemaCache -&gt; m OpenApi
</span><a href="Hasura.Server.OpenAPI.html#serveJSON"><span class="hs-identifier hs-var hs-var">serveJSON</span></a></span></span><span> </span><span id="local-6989586621689170499"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170499"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621689170498"><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621689170498"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621689170497"><span class="annot"><span class="annottext">Either QErr OpenApi
</span><a href="#local-6989586621689170497"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Declare (Definitions Schema) (Either QErr OpenApi)
 -&gt; Definitions Schema -&gt; (Definitions Schema, Either QErr OpenApi))
-&gt; Definitions Schema
-&gt; Declare (Definitions Schema) (Either QErr OpenApi)
-&gt; (Definitions Schema, Either QErr OpenApi)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Declare (Definitions Schema) (Either QErr OpenApi)
-&gt; Definitions Schema -&gt; (Definitions Schema, Either QErr OpenApi)
forall d a. Declare d a -&gt; d -&gt; (d, a)
</span><span class="hs-identifier hs-var">runDeclare</span></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Declare (Definitions Schema) (Either QErr OpenApi)
 -&gt; (Definitions Schema, Either QErr OpenApi))
-&gt; (ExceptT QErr (Declare (Definitions Schema)) OpenApi
    -&gt; Declare (Definitions Schema) (Either QErr OpenApi))
-&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
-&gt; (Definitions Schema, Either QErr OpenApi)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExceptT QErr (Declare (Definitions Schema)) OpenApi
-&gt; Declare (Definitions Schema) (Either QErr OpenApi)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT QErr (Declare (Definitions Schema)) OpenApi
 -&gt; (Definitions Schema, Either QErr OpenApi))
-&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
-&gt; (Definitions Schema, Either QErr OpenApi)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
</span><a href="Hasura.Server.OpenAPI.html#declareOpenApiSpec"><span class="hs-identifier hs-var">declareOpenApiSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170499"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-468"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either QErr OpenApi
</span><a href="#local-6989586621689170497"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621689170492"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621689170492"><span class="hs-identifier hs-var">qe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QErr -&gt; m OpenApi
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621689170492"><span class="hs-identifier hs-var">qe</span></a></span><span>
</span><span id="line-470"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621689170490"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621689170490"><span class="hs-identifier hs-var">openAPISpec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; m OpenApi
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(OpenApi -&gt; m OpenApi) -&gt; OpenApi -&gt; m OpenApi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621689170490"><span class="hs-identifier hs-var">openAPISpec</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; Identity Components) -&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasComponents s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">components</span></span><span> </span><span class="annot"><span class="annottext">((Components -&gt; Identity Components)
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Definitions Schema -&gt; Identity (Definitions Schema))
    -&gt; Components -&gt; Identity Components)
-&gt; (Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; Components -&gt; Identity Components
forall s a. HasSchemas s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">schemas</span></span><span> </span><span class="annot"><span class="annottext">((Definitions Schema -&gt; Identity (Definitions Schema))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; Definitions Schema -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621689170498"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- | If all variables are scalar or optional then the entire request body can be marked as optional</span><span>
</span><span id="line-473"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#isRequestBodyRequired"><span class="hs-identifier hs-type">isRequestBodyRequired</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-474"></span><span id="isRequestBodyRequired"><span class="annot"><span class="annottext">isRequestBodyRequired :: EndpointData -&gt; Bool
</span><a href="Hasura.Server.OpenAPI.html#isRequestBodyRequired"><span class="hs-identifier hs-var hs-var">isRequestBodyRequired</span></a></span></span><span> </span><span id="local-6989586621689170486"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170486"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema -&gt; Bool)
-&gt; InsOrdHashMap Text (Referenced Schema) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema -&gt; Bool
</span><a href="#local-6989586621689170484"><span class="hs-identifier hs-var">isNotRequired</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#_edProperties"><span class="hs-identifier hs-var hs-var">_edProperties</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170486"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-comment">-- The use of isNotRequired here won't work with list types since they are inline, but contain references</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621689170484"><span class="annot"><span class="annottext">isNotRequired :: Referenced Schema -&gt; Bool
</span><a href="#local-6989586621689170484"><span class="hs-identifier hs-var hs-var">isNotRequired</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Inline</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170448"><span id="local-6989586621689170449"><span id="local-6989586621689170450"><span id="local-6989586621689170451"><span id="local-6989586621689170452"><span id="local-6989586621689170453"><span id="local-6989586621689170454"><span id="local-6989586621689170455"><span id="local-6989586621689170456"><span id="local-6989586621689170457"><span id="local-6989586621689170458"><span id="local-6989586621689170459"><span id="local-6989586621689170460"><span id="local-6989586621689170461"><span id="local-6989586621689170462"><span id="local-6989586621689170463"><span id="local-6989586621689170464"><span id="local-6989586621689170465"><span id="local-6989586621689170466"><span id="local-6989586621689170467"><span id="local-6989586621689170468"><span id="local-6989586621689170469"><span id="local-6989586621689170470"><span id="local-6989586621689170471"><span id="local-6989586621689170472"><span id="local-6989586621689170473"><span id="local-6989586621689170474"><span id="local-6989586621689170475"><span id="local-6989586621689170476"><span id="local-6989586621689170477"><span id="local-6989586621689170478"><span id="local-6989586621689170479"><span id="local-6989586621689170480"><span id="local-6989586621689170481"><span id="local-6989586621689170482"><span class="annot"><span class="annottext">[Text]
Maybe Bool
Maybe Integer
Maybe [Value]
Maybe [Referenced Schema]
Maybe Text
Maybe Value
Maybe Scientific
Maybe (Referenced Schema)
Maybe OpenApiType
Maybe ExternalDocs
Maybe OpenApiItems
Maybe AdditionalProperties
Maybe Xml
Maybe Discriminator
InsOrdHashMap Text (Referenced Schema)
_schemaXml :: Schema -&gt; Maybe Xml
_schemaWriteOnly :: Schema -&gt; Maybe Bool
_schemaUniqueItems :: Schema -&gt; Maybe Bool
_schemaType :: Schema -&gt; Maybe OpenApiType
_schemaTitle :: Schema -&gt; Maybe Text
_schemaRequired :: Schema -&gt; [Text]
_schemaReadOnly :: Schema -&gt; Maybe Bool
_schemaProperties :: Schema -&gt; InsOrdHashMap Text (Referenced Schema)
_schemaPattern :: Schema -&gt; Maybe Text
_schemaOneOf :: Schema -&gt; Maybe [Referenced Schema]
_schemaNullable :: Schema -&gt; Maybe Bool
_schemaNot :: Schema -&gt; Maybe (Referenced Schema)
_schemaMultipleOf :: Schema -&gt; Maybe Scientific
_schemaMinimum :: Schema -&gt; Maybe Scientific
_schemaMinProperties :: Schema -&gt; Maybe Integer
_schemaMinLength :: Schema -&gt; Maybe Integer
_schemaMinItems :: Schema -&gt; Maybe Integer
_schemaMaximum :: Schema -&gt; Maybe Scientific
_schemaMaxProperties :: Schema -&gt; Maybe Integer
_schemaMaxLength :: Schema -&gt; Maybe Integer
_schemaMaxItems :: Schema -&gt; Maybe Integer
_schemaItems :: Schema -&gt; Maybe OpenApiItems
_schemaFormat :: Schema -&gt; Maybe Text
_schemaExternalDocs :: Schema -&gt; Maybe ExternalDocs
_schemaExclusiveMinimum :: Schema -&gt; Maybe Bool
_schemaExclusiveMaximum :: Schema -&gt; Maybe Bool
_schemaExample :: Schema -&gt; Maybe Value
_schemaEnum :: Schema -&gt; Maybe [Value]
_schemaDiscriminator :: Schema -&gt; Maybe Discriminator
_schemaDescription :: Schema -&gt; Maybe Text
_schemaDeprecated :: Schema -&gt; Maybe Bool
_schemaDefault :: Schema -&gt; Maybe Value
_schemaAnyOf :: Schema -&gt; Maybe [Referenced Schema]
_schemaAllOf :: Schema -&gt; Maybe [Referenced Schema]
_schemaAdditionalProperties :: Schema -&gt; Maybe AdditionalProperties
_schemaMultipleOf :: Maybe Scientific
_schemaEnum :: Maybe [Value]
_schemaUniqueItems :: Maybe Bool
_schemaMinItems :: Maybe Integer
_schemaMaxItems :: Maybe Integer
_schemaPattern :: Maybe Text
_schemaMinLength :: Maybe Integer
_schemaMaxLength :: Maybe Integer
_schemaExclusiveMinimum :: Maybe Bool
_schemaMinimum :: Maybe Scientific
_schemaExclusiveMaximum :: Maybe Bool
_schemaMaximum :: Maybe Scientific
_schemaItems :: Maybe OpenApiItems
_schemaFormat :: Maybe Text
_schemaType :: Maybe OpenApiType
_schemaDefault :: Maybe Value
_schemaMinProperties :: Maybe Integer
_schemaMaxProperties :: Maybe Integer
_schemaDeprecated :: Maybe Bool
_schemaExample :: Maybe Value
_schemaExternalDocs :: Maybe ExternalDocs
_schemaXml :: Maybe Xml
_schemaWriteOnly :: Maybe Bool
_schemaReadOnly :: Maybe Bool
_schemaDiscriminator :: Maybe Discriminator
_schemaAdditionalProperties :: Maybe AdditionalProperties
_schemaProperties :: InsOrdHashMap Text (Referenced Schema)
_schemaAnyOf :: Maybe [Referenced Schema]
_schemaNot :: Maybe (Referenced Schema)
_schemaOneOf :: Maybe [Referenced Schema]
_schemaAllOf :: Maybe [Referenced Schema]
_schemaNullable :: Maybe Bool
_schemaRequired :: [Text]
_schemaDescription :: Maybe Text
_schemaTitle :: Maybe Text
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType -&gt; Bool
</span><a href="#local-6989586621689170412"><span class="hs-identifier hs-var">isScalarType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><a href="#local-6989586621689170462"><span class="hs-identifier hs-var">_schemaType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621689170479"><span class="hs-identifier hs-var">_schemaNullable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621689170484"><span class="hs-identifier hs-var">isNotRequired</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- Not all `Ref` are non nullable, imagine two endpoints using the same Ref one being nullable and other not</span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621689170412"><span class="hs-identifier hs-type">isScalarType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApiType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621689170412"><span class="annot"><span class="annottext">isScalarType :: Maybe OpenApiType -&gt; Bool
</span><a href="#local-6989586621689170412"><span class="hs-identifier hs-var hs-var">isScalarType</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe OpenApiType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><a href="#local-6989586621689170412"><span class="hs-identifier hs-var">isScalarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621689170410"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170410"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621689170410"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiInteger</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiBoolean</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiNull</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiObject</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- * Entry point</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#declareOpenApiSpec"><span class="hs-identifier hs-type">declareOpenApiSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#SchemaCache"><span class="hs-identifier hs-type">SchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareErr"><span class="hs-identifier hs-type">DeclareErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Definitions</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Schema</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApi</span></span><span>
</span><span id="line-493"></span><span id="declareOpenApiSpec"><span class="annot"><span class="annottext">declareOpenApiSpec :: SchemaCache -&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
</span><a href="Hasura.Server.OpenAPI.html#declareOpenApiSpec"><span class="hs-identifier hs-var hs-var">declareOpenApiSpec</span></a></span></span><span> </span><span id="local-6989586621689170408"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170408"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170407"><span class="annot"><span class="annottext">_schemaIntrospection :: SchemaIntrospection
</span><a href="#local-6989586621689170407"><span class="hs-identifier hs-var hs-var">_schemaIntrospection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; SchemaIntrospection
</span><a href="Hasura.RQL.Types.SchemaCache.html#scAdminIntrospection"><span class="hs-identifier hs-var hs-var">scAdminIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170408"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><a href="#local-6989586621689170405"><span class="hs-identifier hs-type">mkRequestBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequestBody</span></span><span>
</span><span id="line-496"></span><span>      </span><span id="local-6989586621689170405"><span class="annot"><span class="annottext">mkRequestBody :: EndpointData -&gt; RequestBody
</span><a href="#local-6989586621689170405"><span class="hs-identifier hs-var hs-var">mkRequestBody</span></a></span></span><span> </span><span id="local-6989586621689170404"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170404"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>        </span><span class="annot"><span class="annottext">RequestBody
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-498"></span><span>          </span><span class="annot"><span class="annottext">RequestBody -&gt; (RequestBody -&gt; RequestBody) -&gt; RequestBody
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; RequestBody -&gt; Identity RequestBody
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; RequestBody -&gt; Identity RequestBody)
-&gt; Text -&gt; RequestBody -&gt; RequestBody
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Query parameters can also be provided in the request body as a JSON object&quot;</span></span><span>
</span><span id="line-499"></span><span>          </span><span class="annot"><span class="annottext">RequestBody -&gt; (RequestBody -&gt; RequestBody) -&gt; RequestBody
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool))
-&gt; RequestBody -&gt; Identity RequestBody
forall s a. HasRequired s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">required</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; RequestBody -&gt; Identity RequestBody)
-&gt; Bool -&gt; RequestBody -&gt; RequestBody
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Bool
</span><a href="Hasura.Server.OpenAPI.html#isRequestBodyRequired"><span class="hs-identifier hs-var">isRequestBodyRequired</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170404"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-500"></span><span>          </span><span class="annot"><span class="annottext">RequestBody -&gt; (RequestBody -&gt; RequestBody) -&gt; RequestBody
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap MediaType MediaTypeObject
 -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
-&gt; RequestBody -&gt; Identity RequestBody
forall s a. HasContent s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">content</span></span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">((InsOrdHashMap MediaType MediaTypeObject
  -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
 -&gt; RequestBody -&gt; Identity RequestBody)
-&gt; InsOrdHashMap MediaType MediaTypeObject
-&gt; RequestBody
-&gt; RequestBody
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">MediaType
-&gt; MediaTypeObject -&gt; InsOrdHashMap MediaType MediaTypeObject
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.singleton</span></span><span>
</span><span id="line-502"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; MediaType
</span><span class="hs-operator hs-var">//</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">MediaTypeObject
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-504"></span><span>                  </span><span class="annot"><span class="annottext">MediaTypeObject
-&gt; (MediaTypeObject -&gt; MediaTypeObject) -&gt; MediaTypeObject
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; MediaTypeObject -&gt; Identity MediaTypeObject
forall s a. HasSchema s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">schema</span></span><span>
</span><span id="line-505"></span><span>                    </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; MediaTypeObject -&gt; Identity MediaTypeObject)
-&gt; Referenced Schema -&gt; MediaTypeObject -&gt; MediaTypeObject
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span>
</span><span id="line-506"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-507"></span><span>                          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiObject</span></span><span>
</span><span id="line-508"></span><span>                          </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap Text (Referenced Schema)
 -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
-&gt; Schema -&gt; Identity Schema
forall s a. HasProperties s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">properties</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap Text (Referenced Schema)
  -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
 -&gt; Schema -&gt; Identity Schema)
-&gt; InsOrdHashMap Text (Referenced Schema) -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#_edProperties"><span class="hs-identifier hs-var hs-var">_edProperties</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170404"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-509"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span>      </span><span class="annot"><a href="#local-6989586621689170403"><span class="hs-identifier hs-type">mkOperation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operation</span></span><span>
</span><span id="line-513"></span><span>      </span><span id="local-6989586621689170403"><span class="annot"><span class="annottext">mkOperation :: EndpointMethod -&gt; EndpointData -&gt; Operation
</span><a href="#local-6989586621689170403"><span class="hs-identifier hs-var hs-var">mkOperation</span></a></span></span><span> </span><span id="local-6989586621689170402"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170402"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621689170401"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-514"></span><span>        </span><span class="annot"><span class="annottext">Operation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-515"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; Operation -&gt; Identity Operation
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Text -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edDescription"><span class="hs-identifier hs-var hs-var">_edDescription</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-516"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; Operation -&gt; Identity Operation
forall s a. HasSummary s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">summary</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Text -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edName"><span class="hs-identifier hs-var hs-var">_edName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-517"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([Referenced Param] -&gt; Identity [Referenced Param])
-&gt; Operation -&gt; Identity Operation
forall s a. HasParameters s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">parameters</span></span><span> </span><span class="annot"><span class="annottext">(([Referenced Param] -&gt; Identity [Referenced Param])
 -&gt; Operation -&gt; Identity Operation)
-&gt; [Referenced Param] -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param -&gt; Referenced Param
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="annot"><span class="annottext">Param
</span><a href="#local-6989586621689170398"><span class="hs-identifier hs-var">xHasuraAdminSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Referenced Param -&gt; [Referenced Param] -&gt; [Referenced Param]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#_edVarList"><span class="hs-identifier hs-var hs-var">_edVarList</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced RequestBody)
 -&gt; Identity (Maybe (Referenced RequestBody)))
-&gt; Operation -&gt; Identity Operation
forall s a. HasRequestBody s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">requestBody</span></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced RequestBody)
  -&gt; Identity (Maybe (Referenced RequestBody)))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Maybe (Referenced RequestBody) -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Referenced RequestBody -&gt; Maybe (Referenced RequestBody)
forall a. Bool -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621689170396"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Text (Referenced Schema) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; InsOrdHashMap Text (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#_edProperties"><span class="hs-identifier hs-var hs-var">_edProperties</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RequestBody -&gt; Referenced RequestBody
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; RequestBody
</span><a href="#local-6989586621689170405"><span class="hs-identifier hs-var">mkRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Responses -&gt; Identity Responses)
-&gt; Operation -&gt; Identity Operation
forall s a. HasResponses s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">responses</span></span><span> </span><span class="annot"><span class="annottext">((Responses -&gt; Identity Responses)
 -&gt; Operation -&gt; Identity Operation)
-&gt; Responses -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response)
-&gt; InsOrdHashMap Int (Referenced Response) -&gt; Responses
</span><span class="hs-identifier hs-var">Responses</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Int (Referenced Response)
-&gt; (Response -&gt; InsOrdHashMap Int (Referenced Response))
-&gt; Maybe Response
-&gt; InsOrdHashMap Int (Referenced Response)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Int (Referenced Response)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Referenced Response -&gt; InsOrdHashMap Int (Referenced Response)
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Response -&gt; InsOrdHashMap Int (Referenced Response))
-&gt; (Response -&gt; Referenced Response)
-&gt; Response
-&gt; InsOrdHashMap Int (Referenced Response)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Referenced Response
forall a. a -&gt; Referenced a
</span><span class="hs-identifier hs-var">Inline</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Response -&gt; InsOrdHashMap Int (Referenced Response))
-&gt; Maybe Response -&gt; InsOrdHashMap Int (Referenced Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; HashMap EndpointMethod Response -&gt; Maybe Response
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170402"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap EndpointMethod Response -&gt; Maybe Response)
-&gt; HashMap EndpointMethod Response -&gt; Maybe Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; HashMap EndpointMethod Response
</span><a href="Hasura.Server.OpenAPI.html#_edResponse"><span class="hs-identifier hs-var hs-var">_edResponse</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170401"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-521"></span><span>          </span><span id="local-6989586621689170396"><span class="annot"><span class="annottext">toMaybe :: Bool -&gt; a -&gt; Maybe a
</span><a href="#local-6989586621689170396"><span class="hs-identifier hs-var hs-var">toMaybe</span></a></span></span><span> </span><span id="local-6989586621689170392"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170392"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621689170391"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621689170391"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621689170392"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621689170391"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><a href="#local-6989586621689170390"><span class="hs-identifier hs-type">getOPName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Operation</span></span><span>
</span><span id="line-524"></span><span>      </span><span id="local-6989586621689170390"><span class="annot"><span class="annottext">getOPName :: EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var hs-var">getOPName</span></a></span></span><span> </span><span id="local-6989586621689170389"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170389"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span id="local-6989586621689170388"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170388"><span class="hs-identifier hs-var">methodType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170388"><span class="hs-identifier hs-var">methodType</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; HashSet EndpointMethod -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; HashSet EndpointMethod
</span><a href="Hasura.Server.OpenAPI.html#_edMethod"><span class="hs-identifier hs-var hs-var">_edMethod</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170389"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-526"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Operation -&gt; Maybe Operation
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; Maybe Operation) -&gt; Operation -&gt; Maybe Operation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; EndpointData -&gt; Operation
</span><a href="#local-6989586621689170403"><span class="hs-identifier hs-var">mkOperation</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621689170388"><span class="hs-identifier hs-var">methodType</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170389"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-527"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Operation
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><a href="#local-6989586621689170398"><span class="hs-identifier hs-type">xHasuraAdminSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Param</span></span><span>
</span><span id="line-530"></span><span>      </span><span id="local-6989586621689170398"><span class="annot"><span class="annottext">xHasuraAdminSecret :: Param
</span><a href="#local-6989586621689170398"><span class="hs-identifier hs-var hs-var">xHasuraAdminSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Text
-&gt; Maybe Bool
-&gt; ParamLocation
-&gt; Maybe Bool
-&gt; Maybe Value
-&gt; Maybe OpenApiType
-&gt; Maybe Text
-&gt; Param
</span><a href="Hasura.Server.OpenAPI.html#mkParam"><span class="hs-identifier hs-var">mkParam</span></a></span><span>
</span><span id="line-532"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x-hasura-admin-secret&quot;</span></span><span>
</span><span id="line-533"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Your x-hasura-admin-secret will be used for authentication of the API request.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>          </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-535"></span><span>          </span><span class="annot"><span class="annottext">ParamLocation
</span><span class="hs-identifier hs-var">ParamHeader</span></span><span>
</span><span id="line-536"></span><span>          </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-537"></span><span>          </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-538"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType -&gt; Maybe OpenApiType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><span class="hs-identifier hs-var">OpenApiString</span></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>          </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="#local-6989586621689170385"><span class="hs-identifier hs-type">generatePathItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PathItem</span></span><span>
</span><span id="line-542"></span><span>      </span><span id="local-6989586621689170385"><span class="annot"><span class="annottext">generatePathItem :: EndpointData -&gt; PathItem
</span><a href="#local-6989586621689170385"><span class="hs-identifier hs-var hs-var">generatePathItem</span></a></span></span><span> </span><span id="local-6989586621689170384"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-543"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621689170383"><span class="annot"><span class="annottext">pathData :: PathItem
</span><a href="#local-6989586621689170383"><span class="hs-identifier hs-var hs-var">pathData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>              </span><span class="annot"><span class="annottext">PathItem
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-545"></span><span>                </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasGet s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Maybe Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var">getOPName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span>
</span><span id="line-546"></span><span>                </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPost s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">post</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Maybe Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var">getOPName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>
</span><span id="line-547"></span><span>                </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPut s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Maybe Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var">getOPName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span>
</span><span id="line-548"></span><span>                </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasDelete s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">delete</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Maybe Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var">getOPName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span>
</span><span id="line-549"></span><span>                </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPatch s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">patch</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Maybe Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; EndpointMethod -&gt; Maybe Operation
</span><a href="#local-6989586621689170390"><span class="hs-identifier hs-var">getOPName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span>
</span><span id="line-550"></span><span>            </span><span id="local-6989586621689170372"><span class="annot"><span class="annottext">completePathData :: PathItem
</span><a href="#local-6989586621689170372"><span class="hs-identifier hs-var hs-var">completePathData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621689170383"><span class="hs-identifier hs-var">pathData</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; PathItem -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PathItem
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-552"></span><span>                </span><span class="hs-keyword">then</span><span>
</span><span id="line-553"></span><span>                  </span><span class="annot"><span class="annottext">PathItem
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-554"></span><span>                    </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPost s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">post</span></span><span>
</span><span id="line-555"></span><span>                      </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">EndpointMethod -&gt; EndpointData -&gt; Operation
</span><a href="#local-6989586621689170403"><span class="hs-identifier hs-var">mkOperation</span></a></span><span>
</span><span id="line-556"></span><span>                        </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span>
</span><span id="line-557"></span><span>                        </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-558"></span><span>                          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_edDescription :: Text
</span><a href="Hasura.Server.OpenAPI.html#_edDescription"><span class="hs-identifier hs-var">_edDescription</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>                              </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&#9888;&#65039; Method(&quot;</span></span><span>
</span><span id="line-560"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashSet EndpointMethod -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Hasura.Prelude.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; HashSet EndpointMethod
</span><a href="Hasura.Server.OpenAPI.html#_edMethod"><span class="hs-identifier hs-var hs-var">_edMethod</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;) not supported, defaulting to POST\n\n&quot;</span></span><span>
</span><span id="line-562"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">EndpointData -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#_edDescription"><span class="hs-identifier hs-var hs-var">_edDescription</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170384"><span class="hs-identifier hs-var">ed</span></a></span><span>
</span><span id="line-563"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-564"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621689170383"><span class="hs-identifier hs-var">pathData</span></a></span><span>
</span><span id="line-565"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621689170372"><span class="hs-identifier hs-var">completePathData</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621689170371"><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170371"><span class="hs-identifier hs-var">endpointLst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
-&gt; SchemaCache -&gt; DeclareErr (Definitions Schema) [EndpointData]
</span><a href="Hasura.Server.OpenAPI.html#getEndpointsData"><span class="hs-identifier hs-var">getEndpointsData</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621689170407"><span class="hs-identifier hs-var">_schemaIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621689170408"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621689170370"><span class="hs-identifier hs-type">mkOpenAPISchema</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">InsOrdHashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PathItem</span></span><span>
</span><span id="line-570"></span><span>      </span><span id="local-6989586621689170370"><span class="annot"><span class="annottext">mkOpenAPISchema :: [EndpointData] -&gt; InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170370"><span class="hs-identifier hs-var hs-var">mkOpenAPISchema</span></a></span></span><span> </span><span id="local-6989586621689170368"><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170368"><span class="hs-identifier hs-var">edLst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap String PathItem
 -&gt; EndpointData -&gt; InsOrdHashMap String PathItem)
-&gt; InsOrdHashMap String PathItem
-&gt; [EndpointData]
-&gt; InsOrdHashMap String PathItem
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621689170366"><span class="annot"><span class="annottext">InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170366"><span class="hs-identifier hs-var">hm</span></a></span></span><span> </span><span id="local-6989586621689170365"><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170365"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PathItem -&gt; PathItem -&gt; PathItem)
-&gt; String
-&gt; PathItem
-&gt; InsOrdHashMap String PathItem
-&gt; InsOrdHashMap String PathItem
forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.insertWith</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; PathItem -&gt; PathItem
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; String
</span><a href="Hasura.Server.OpenAPI.html#_edUrl"><span class="hs-identifier hs-var hs-var">_edUrl</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170365"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointData -&gt; PathItem
</span><a href="#local-6989586621689170385"><span class="hs-identifier hs-var">generatePathItem</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointData
</span><a href="#local-6989586621689170365"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170366"><span class="hs-identifier hs-var">hm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap String PathItem
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170368"><span class="hs-identifier hs-var">edLst</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>      </span><span id="local-6989586621689170363"><span class="annot"><span class="annottext">openAPIPaths :: InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170363"><span class="hs-identifier hs-var hs-var">openAPIPaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[EndpointData] -&gt; InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170370"><span class="hs-identifier hs-var">mkOpenAPISchema</span></a></span><span> </span><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170371"><span class="hs-identifier hs-var">endpointLst</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>      </span><span id="local-6989586621689170362"><span class="annot"><span class="annottext">allWarnings :: Text
</span><a href="#local-6989586621689170362"><span class="hs-identifier hs-var hs-var">allWarnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; EndpointData -&gt; Text) -&gt; Text -&gt; [EndpointData] -&gt; Text
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; EndpointData -&gt; Text
</span><a href="#local-6989586621689170361"><span class="hs-identifier hs-var">addEndpointWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[EndpointData]
</span><a href="#local-6989586621689170371"><span class="hs-identifier hs-var">endpointLst</span></a></span><span>
</span><span id="line-575"></span><span>      </span><span class="annot"><a href="#local-6989586621689170361"><span class="hs-identifier hs-type">addEndpointWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-576"></span><span>      </span><span id="local-6989586621689170361"><span class="annot"><span class="annottext">addEndpointWarnings :: Text -&gt; EndpointData -&gt; Text
</span><a href="#local-6989586621689170361"><span class="hs-identifier hs-var hs-var">addEndpointWarnings</span></a></span></span><span> </span><span id="local-6989586621689170360"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170360"><span class="hs-identifier hs-var">oldWarn</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#EndpointData"><span class="hs-identifier hs-type">EndpointData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621689170352"><span id="local-6989586621689170353"><span id="local-6989586621689170354"><span id="local-6989586621689170355"><span id="local-6989586621689170356"><span id="local-6989586621689170357"><span id="local-6989586621689170358"><span id="local-6989586621689170359"><span class="annot"><span class="annottext">String
[Text]
[Referenced Param]
Text
HashMap EndpointMethod Response
HashSet EndpointMethod
InsOrdHashMap Text (Referenced Schema)
_edErrs :: [Text]
_edName :: Text
_edDescription :: Text
_edResponse :: HashMap EndpointMethod Response
_edProperties :: InsOrdHashMap Text (Referenced Schema)
_edVarList :: [Referenced Param]
_edMethod :: HashSet EndpointMethod
_edUrl :: String
_edErrs :: EndpointData -&gt; [Text]
_edName :: EndpointData -&gt; Text
_edDescription :: EndpointData -&gt; Text
_edResponse :: EndpointData -&gt; HashMap EndpointMethod Response
_edProperties :: EndpointData -&gt; InsOrdHashMap Text (Referenced Schema)
_edVarList :: EndpointData -&gt; [Referenced Param]
_edMethod :: EndpointData -&gt; HashSet EndpointMethod
_edUrl :: EndpointData -&gt; String
</span><a href="#local-6989586621689170352"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-577"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170352"><span class="hs-identifier hs-var">_edErrs</span></a></span><span>
</span><span id="line-578"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170360"><span class="hs-identifier hs-var">oldWarn</span></a></span><span>
</span><span id="line-579"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-580"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170360"><span class="hs-identifier hs-var">oldWarn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n\nEndpoint \&quot;&quot;</span></span><span>
</span><span id="line-581"></span><span>              </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170353"><span class="hs-identifier hs-var">_edName</span></a></span><span>
</span><span id="line-582"></span><span>              </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;:&quot;</span></span><span>
</span><span id="line-583"></span><span>              </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text) -&gt; Text -&gt; [Text] -&gt; Text
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621689170351"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170351"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621689170350"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170350"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170351"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n- &#9888;&#65039; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170350"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621689170352"><span class="hs-identifier hs-var">_edErrs</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(OpenApi -&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi)
-&gt; OpenApi -&gt; ExceptT QErr (Declare (Definitions Schema)) OpenApi
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><span class="annottext">OpenApi
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap String PathItem
 -&gt; Identity (InsOrdHashMap String PathItem))
-&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasPaths s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">paths</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap String PathItem
  -&gt; Identity (InsOrdHashMap String PathItem))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; InsOrdHashMap String PathItem -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap String PathItem
</span><a href="#local-6989586621689170363"><span class="hs-identifier hs-var">openAPIPaths</span></a></span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Identity Info) -&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasInfo s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">info</span></span><span> </span><span class="annot"><span class="annottext">((Info -&gt; Identity Info) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Text -&gt; Identity Text) -&gt; Info -&gt; Identity Info)
-&gt; (Text -&gt; Identity Text)
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Identity Text) -&gt; Info -&gt; Identity Info
forall s a. HasTitle s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">title</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Identity Text) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; Text -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Rest Endpoints&quot;</span></span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Identity Info) -&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasInfo s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">info</span></span><span> </span><span class="annot"><span class="annottext">((Info -&gt; Identity Info) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Maybe Text -&gt; Identity (Maybe Text)) -&gt; Info -&gt; Identity Info)
-&gt; (Maybe Text -&gt; Identity (Maybe Text))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Info -&gt; Identity Info
forall s a. HasDescription s a =&gt; Lens' s a
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; Text -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;This OpenAPI specification is automatically generated by Hasura.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621689170362"><span class="hs-identifier hs-var">allWarnings</span></a></span><span>
</span><span id="line-590"></span></pre></body></html>